<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport"/>
<meta content="yes" name="apple-mobile-web-app-capable"/>
<meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"/>
<meta content="#6366f1" name="theme-color"/>
<!-- PWA meta tags -->
<meta name="mobile-web-app-capable" content="yes">
<meta name="application-name" content="System HR">
<meta name="format-detection" content="telephone=no">
<!-- Cache control -->
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">
<title>System zarzÄ…dzania pracownikami - HR & OdzieÅ¼ ochronna (Real-time Sync)</title>

<!-- Firebase SDK v8 (compat) -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>

<style>
/* Import czcionek */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');

/* Reset i zmienne CSS */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

:root {
    --primary: #6366f1;
    --secondary: #ec4899;
    --success: #10b981;
    --danger: #ef4444;
    --warning: #f59e0b;
    --glass-bg: rgba(255, 255, 255, 0.05);
    --glass-border: rgba(255, 255, 255, 0.1);
    --text-primary: rgba(255, 255, 255, 0.95);
    --text-secondary: rgba(255, 255, 255, 0.7);
}

/* Podstawowe style */
body {
    font-family: 'Inter', sans-serif;
    background: linear-gradient(135deg, #1e1e2e 0%, #2d2d44 100%);
    color: var(--text-primary);
    min-height: 100vh;
    overflow-x: hidden;
}

/* Animacja tÅ‚a */
.bg-animation {
    position: fixed;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    z-index: -1;
    overflow: hidden;
}

.bg-animation span {
    position: absolute;
    display: block;
    width: 100px;
    height: 100px;
    background: linear-gradient(45deg, rgba(99, 102, 241, 0.1), rgba(236, 72, 153, 0.1));
    animation: animate 25s linear infinite;
    bottom: -150px;
    border-radius: 50%;
}

@keyframes animate {
    0% {
        transform: translateY(0) rotate(0deg);
        opacity: 1;
    }
    100% {
        transform: translateY(-1000px) rotate(720deg);
        opacity: 0;
    }
}

/* Language Selector */
.language-selector {
    position: fixed;
    top: 1rem;
    left: 1rem;
    background: var(--glass-bg);
    backdrop-filter: blur(10px);
    border: 1px solid var(--glass-border);
    border-radius: 12px;
    padding: 0.5rem;
    display: flex;
    gap: 0.5rem;
    z-index: 1001;
}

.lang-btn {
    background: transparent;
    border: 1px solid var(--glass-border);
    color: var(--text-secondary);
    padding: 0.5rem 0.75rem;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0.85rem;
    font-weight: 500;
}

.lang-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    color: white;
}

.lang-btn.active {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
}

/* Sync status indicator */
.sync-status {
    position: fixed;
    top: 1rem;
    right: 1rem;
    background: var(--glass-bg);
    backdrop-filter: blur(10px);
    border: 1px solid var(--glass-border);
    border-radius: 50px;
    padding: 0.5rem 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    z-index: 1000;
    transition: all 0.3s ease;
    cursor: pointer;
}

.sync-status:hover {
    transform: scale(1.05);
    box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
}

.sync-status:active {
    transform: scale(0.95);
}

.sync-status::after {
    content: attr(data-tooltip);
    position: absolute;
    top: 100%;
    right: 0;
    margin-top: 0.5rem;
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 8px;
    font-size: 0.85rem;
    white-space: nowrap;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
}

.sync-status:hover::after {
    opacity: 1;
}

.sync-status.syncing {
    background: rgba(251, 191, 36, 0.1);
    border-color: rgba(251, 191, 36, 0.3);
}

.sync-status.synced {
    background: rgba(16, 185, 129, 0.1);
    border-color: rgba(16, 185, 129, 0.3);
}

.sync-status.error {
    background: rgba(239, 68, 68, 0.1);
    border-color: rgba(239, 68, 68, 0.3);
}

.sync-status.offline {
    background: rgba(156, 163, 175, 0.1);
    border-color: rgba(156, 163, 175, 0.3);
}

.sync-icon {
    width: 16px;
    height: 16px;
}

.sync-icon.rotating {
    animation: rotate 1s linear infinite;
}

@keyframes rotate {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

/* Navbar */
.navbar {
    background: var(--glass-bg);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid var(--glass-border);
    padding: 1rem 0;
    position: sticky;
    top: 0;
    z-index: 100;
}

.nav-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 2rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.logo {
    font-size: 1.5rem;
    font-weight: 800;
    background: linear-gradient(45deg, var(--primary), var(--secondary));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.tabs {
    display: flex;
    gap: 1rem;
}

.tab {
    padding: 0.75rem 1.5rem;
    background: transparent;
    border: none;
    color: var(--text-secondary);
    cursor: pointer;
    border-radius: 12px;
    transition: all 0.3s ease;
    font-size: 0.95rem;
    font-weight: 500;
}

.tab:hover {
    background: rgba(255, 255, 255, 0.05);
    color: white;
}

.tab.active {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    box-shadow: 0 8px 32px rgba(99, 102, 241, 0.3);
}

/* Container */
.container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 2rem;
}

.tab-content {
    display: none;
}

.tab-content.active {
    display: block;
    animation: fadeIn 0.3s ease-out;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Login Panel */
.login-panel {
    max-width: 400px;
    margin: 4rem auto;
    background: var(--glass-bg);
    backdrop-filter: blur(10px);
    border: 1px solid var(--glass-border);
    border-radius: 20px;
    padding: 2rem;
}

.login-form {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.auth-buttons {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.btn-google {
    background: #4285f4;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
}

.btn-google:hover {
    background: #357ae8;
}

/* Statystyki */
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.stat-card {
    background: var(--glass-bg);
    backdrop-filter: blur(10px);
    border: 1px solid var(--glass-border);
    border-radius: 20px;
    padding: 1.5rem;
    transition: all 0.3s ease;
}

.stat-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
}

.stat-number {
    font-size: 2.5rem;
    font-weight: 800;
    background: linear-gradient(45deg, var(--primary), var(--secondary));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.stat-label {
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin-top: 0.5rem;
}

/* Panel akcji */
.actions-panel {
    margin-bottom: 2rem;
}

.actions-grid {
    display: grid;
    grid-template-columns: 2fr repeat(4, 1fr);
    gap: 1rem;
    align-items: center;
}

/* Wyszukiwarka */
.search-box {
    position: relative;
}

.search-input {
    width: 100%;
    padding: 0.75rem 1rem 0.75rem 3rem;
    background: var(--glass-bg);
    backdrop-filter: blur(10px);
    border: 1px solid var(--glass-border);
    border-radius: 12px;
    color: white;
    font-size: 0.95rem;
    transition: all 0.3s ease;
    -webkit-appearance: none;
    appearance: none;
}

.search-input:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
}

.search-input::-webkit-search-cancel-button {
    -webkit-appearance: none;
    appearance: none;
}

.search-icon {
    position: absolute;
    left: 1rem;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-secondary);
    pointer-events: none;
}

.clear-search {
    position: absolute;
    right: 1rem;
    top: 50%;
    transform: translateY(-50%);
    background: none;
    border: none;
    color: var(--text-secondary);
    cursor: pointer;
    padding: 0.25rem;
    display: none;
    transition: all 0.2s ease;
}

.clear-search:hover {
    color: white;
}

.search-input:not(:placeholder-shown) ~ .clear-search {
    display: block;
}

/* Przyciski */
.btn {
    padding: 0.75rem 1.5rem;
    border: none;
    border-radius: 12px;
    font-size: 0.95rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    white-space: nowrap;
}

.btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
}

.btn-primary {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
}

.btn-success {
    background: linear-gradient(135deg, var(--success), #059669);
    color: white;
}

/* Tabela */
.table-container {
    background: var(--glass-bg);
    backdrop-filter: blur(10px);
    border: 1px solid var(--glass-border);
    border-radius: 20px;
    overflow: hidden;
}

.table-wrapper {
    overflow-x: auto;
}

table {
    width: 100%;
    border-collapse: collapse;
}

th {
    background: rgba(255, 255, 255, 0.03);
    padding: 1rem;
    text-align: left;
    font-weight: 600;
    color: var(--text-secondary);
    border-bottom: 1px solid var(--glass-border);
    cursor: pointer;
    transition: all 0.2s ease;
}

th:hover {
    background: rgba(255, 255, 255, 0.05);
    color: white;
}

th.sorted-asc::after,
th.sorted-desc::after {
    content: '';
    display: inline-block;
    margin-left: 0.5rem;
    width: 0;
    height: 0;
    border-style: solid;
}

th.sorted-asc::after {
    border-width: 0 4px 6px 4px;
    border-color: transparent transparent var(--primary) transparent;
}

th.sorted-desc::after {
    border-width: 6px 4px 0 4px;
    border-color: var(--primary) transparent transparent transparent;
}

td {
    padding: 1rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
}

td.editable {
    cursor: pointer;
    position: relative;
    transition: all 0.2s ease;
}

td.editable:hover {
    background: rgba(255, 255, 255, 0.05);
}

td.editable:hover::after {
    content: 'âœï¸';
    position: absolute;
    right: 0.5rem;
    top: 50%;
    transform: translateY(-50%);
    opacity: 0.5;
    font-size: 0.8rem;
}

.edit-input {
    width: 100%;
    padding: 0.5rem;
    background: rgba(0, 0, 0, 0.3);
    border: 2px solid var(--primary);
    border-radius: 8px;
    color: white;
    font-size: 0.9rem;
}

tbody tr {
    transition: all 0.2s ease;
}

tbody tr:hover {
    background: rgba(255, 255, 255, 0.02);
}

.action-btns {
    display: flex;
    gap: 0.5rem;
}

.btn-icon {
    padding: 0.5rem;
    background: transparent;
    border: 1px solid var(--glass-border);
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    display: inline-flex;
    align-items: center;
    justify-content: center;
}

.btn-icon:hover {
    transform: scale(1.1);
}

.btn-icon.edit {
    color: var(--primary);
}

.btn-icon.edit:hover {
    background: rgba(99, 102, 241, 0.2);
    border-color: var(--primary);
}

.btn-icon.delete {
    color: var(--danger);
}

.btn-icon.delete:hover {
    background: rgba(239, 68, 68, 0.2);
    border-color: var(--danger);
}

.btn-icon.restore {
    color: var(--success);
}

.btn-icon.restore:hover {
    background: rgba(16, 185, 129, 0.2);
    border-color: var(--success);
}

/* Okna modalne */
.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(5px);
}

.modal-content {
    background: linear-gradient(135deg, #2d2d44, #1e1e2e);
    border: 1px solid var(--glass-border);
    margin: 2% auto;
    padding: 0;
    width: 90%;
    max-width: 600px;
    max-height: 90vh;
    border-radius: 20px;
    animation: slideIn 0.3s ease-out;
    position: relative;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

/* Modal edycji - specjalne style dla pozycjonowania na gÃ³rze */
#edit-modal .modal-content {
    margin: 1% auto;
    margin-top: 5vh;
}

@keyframes slideIn {
    from {
        transform: translateX(-50%) translateY(-30px) scale(0.95);
        opacity: 0;
    }
    to {
        transform: translateX(-50%) translateY(0) scale(1);
        opacity: 1;
    }
}

.modal-header {
    padding: 1.5rem;
    border-bottom: 1px solid var(--glass-border);
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-shrink: 0;
    background: rgba(0, 0, 0, 0.2);
}

.modal-title {
    font-size: 1.25rem;
    font-weight: 600;
}

.close-btn {
    background: none;
    border: none;
    font-size: 1.5rem;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 0.2s ease;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 10px;
}

.close-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    color: white;
}

/* Formularz */
form {
    padding: 1.5rem;
    max-height: calc(90vh - 100px);
    overflow-y: auto;
}

/* ZawartoÅ›Ä‡ modala dziaÅ‚u */
#dept-modal-content {
    padding: 1.5rem;
    max-height: calc(90vh - 100px);
    overflow-y: auto;
}

/* Scrollbar styling */
#dept-modal-content::-webkit-scrollbar,
form::-webkit-scrollbar {
    width: 8px;
}

#dept-modal-content::-webkit-scrollbar-track,
form::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 10px;
}

#dept-modal-content::-webkit-scrollbar-thumb,
form::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.2);
    border-radius: 10px;
}

#dept-modal-content::-webkit-scrollbar-thumb:hover,
form::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.3);
}

.form-group {
    margin-bottom: 1.5rem;
}

.form-label {
    display: block;
    margin-bottom: 0.5rem;
    color: var(--text-secondary);
    font-size: 0.9rem;
    font-weight: 500;
}

.form-input {
    width: 100%;
    padding: 0.75rem 1rem;
    background: var(--glass-bg);
    backdrop-filter: blur(10px);
    border: 1px solid var(--glass-border);
    border-radius: 12px;
    color: white;
    font-size: 0.95rem;
    transition: all 0.3s ease;
}

.form-input:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
}

select.form-input {
    cursor: pointer;
}

select.form-input option {
    background: #2d2d44;
    color: white;
}

textarea.form-input {
    resize: vertical;
    min-height: 100px;
}

.form-actions {
    display: flex;
    gap: 1rem;
    margin-top: 2rem;
    justify-content: flex-end;
}

/* Toast */
.toast {
    position: fixed;
    bottom: 2rem;
    right: 2rem;
    background: linear-gradient(135deg, rgba(99, 102, 241, 0.9), rgba(236, 72, 153, 0.9));
    color: white;
    padding: 1rem 1.5rem;
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    animation: slideInRight 0.3s ease-out;
    z-index: 2000;
}

@keyframes slideInRight {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

/* Modal dziaÅ‚u - lista pracownikÃ³w */
#dept-modal-content .position-section {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 15px;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
}

#dept-modal-content .position-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

#dept-modal-content .position-name {
    font-size: 1.2rem;
    font-weight: 600;
    color: var(--primary);
}

#dept-modal-content .position-count {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    padding: 0.25rem 0.75rem;
    border-radius: 50px;
    font-size: 0.9rem;
    font-weight: 600;
}

#dept-modal-content .employee-list {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

#dept-modal-content .employee-item {
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.1);
    padding: 1rem;
    border-radius: 10px;
    transition: all 0.2s ease;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

#dept-modal-content .employee-item:hover {
    background: rgba(99, 102, 241, 0.1);
    transform: translateX(5px);
    border-color: var(--primary);
}

#dept-modal-content .employee-name {
    font-weight: 500;
    color: white;
}

#dept-modal-content .employee-date {
    font-size: 0.85rem;
    color: rgba(255, 255, 255, 0.6);
}

.empty-state {
    text-align: center;
    padding: 4rem 2rem;
    color: var(--text-secondary);
}

.empty-state svg {
    width: 80px;
    height: 80px;
    margin-bottom: 1rem;
    opacity: 0.5;
}

.drop-zone {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(99, 102, 241, 0.95);
    backdrop-filter: blur(10px);
    display: none;
    z-index: 500;
}

.drop-zone.active {
    display: flex;
    align-items: center;
    justify-content: center;
}

.drop-zone-content {
    text-align: center;
    color: white;
}

.drop-zone-content svg {
    width: 100px;
    height: 100px;
    margin-bottom: 1rem;
    animation: bounce 1s ease-in-out infinite;
}

@keyframes bounce {
    0%, 100% {
        transform: translateY(0);
    }
    50% {
        transform: translateY(-20px);
    }
}

.drop-zone-content h2 {
    font-size: 2rem;
    margin-bottom: 0.5rem;
}

/* Auto-save indicator */
.auto-save-indicator {
    position: fixed;
    top: -60px;
    right: 2rem;
    background: rgba(16, 185, 129, 0.9);
    color: white;
    padding: 0.75rem 1.5rem;
    border-radius: 0 0 12px 12px;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    transition: top 0.3s ease;
    z-index: 1000;
}

.auto-save-indicator.show {
    top: 0;
}

/* Department stats */
.department-stats {
    margin-bottom: 2rem;
}

.dept-cards-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 1.5rem;
}

.dept-card {
    background: var(--glass-bg);
    backdrop-filter: blur(10px);
    border: 1px solid var(--glass-border);
    border-radius: 20px;
    padding: 1.5rem;
    cursor: pointer;
    transition: all 0.3s ease;
}

.dept-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
    border-color: var(--primary);
}

.dept-name {
    font-size: 1.1rem;
    font-weight: 600;
    margin-bottom: 1rem;
    color: white;
}

.dept-info {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
}

.dept-count {
    font-size: 2rem;
    font-weight: 800;
    background: linear-gradient(45deg, var(--primary), var(--secondary));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.dept-positions {
    color: var(--text-secondary);
    font-size: 0.9rem;
}

.dept-positions-list {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
}

.position-badge {
    background: rgba(255, 255, 255, 0.1);
    padding: 0.25rem 0.75rem;
    border-radius: 50px;
    font-size: 0.8rem;
    color: var(--text-secondary);
}

/* Filtry */
.filters-section {
    background: var(--glass-bg);
    backdrop-filter: blur(10px);
    border: 1px solid var(--glass-border);
    border-radius: 15px;
    padding: 1.5rem;
    margin-bottom: 1rem;
}

.filter-group {
    display: flex;
    flex-direction: column;
}

.filter-select {
    background: rgba(255, 255, 255, 0.05) !important;
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
    color: white !important;
    transition: all 0.3s ease !important;
}

.filter-select:hover {
    background: rgba(255, 255, 255, 0.08) !important;
    border-color: rgba(255, 255, 255, 0.2) !important;
}

.filter-select:focus {
    background: rgba(255, 255, 255, 0.1) !important;
    border-color: var(--primary) !important;
    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2) !important;
}
.date-sort-buttons {
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.sort-btn {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid var(--glass-border);
    color: var(--text-secondary);
    padding: 0.5rem 1rem;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.9rem;
}

.sort-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    color: white;
    border-color: var(--primary);
}

.sort-btn.active {
    background: rgba(99, 102, 241, 0.2);
    color: var(--primary);
    border-color: var(--primary);
}

/* Save instruction */
.save-instruction {
    background: var(--glass-bg);
    backdrop-filter: blur(10px);
    border: 1px solid var(--glass-border);
    border-radius: 20px;
    padding: 2rem;
    margin-bottom: 2rem;
}

.save-instruction h3 {
    color: white;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.save-instruction p {
    color: var(--text-secondary);
    margin-bottom: 0.75rem;
    line-height: 1.6;
}

.save-instruction code {
    background: rgba(255, 255, 255, 0.1);
    padding: 0.25rem 0.5rem;
    border-radius: 6px;
    font-family: monospace;
}

/* Mobile specific styles */
.mobile-view {
    display: none;
}

.mobile-fab {
    position: fixed;
    bottom: 2rem;
    right: 2rem;
    width: 56px;
    height: 56px;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    border: none;
    border-radius: 50%;
    box-shadow: 0 10px 30px rgba(99, 102, 241, 0.4);
    cursor: pointer;
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 100;
}

.mobile-fab:active {
    transform: scale(0.95);
}

.pull-to-refresh {
    position: fixed;
    top: -60px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(255, 255, 255, 0.1);
    padding: 1rem;
    border-radius: 50%;
    transition: all 0.3s ease;
    z-index: 99;
}

.pull-to-refresh.show {
    top: 20px;
}

.offline-indicator {
    position: fixed;
    bottom: -60px;
    left: 0;
    right: 0;
    background: rgba(239, 68, 68, 0.9);
    color: white;
    padding: 0.75rem;
    text-align: center;
    transition: bottom 0.3s ease;
    z-index: 1000;
}

.offline-indicator.show {
    bottom: 0;
}

.swipe-hint {
    position: fixed;
    bottom: 100px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 0.75rem 1.5rem;
    border-radius: 50px;
    font-size: 0.85rem;
    display: none;
    z-index: 1000;
}

/* Employee card for mobile */
.employee-card {
    background: var(--glass-bg);
    backdrop-filter: blur(10px);
    border: 1px solid var(--glass-border);
    border-radius: 20px;
    padding: 1.5rem;
    margin-bottom: 1rem;
}

.employee-card-header {
    display: flex;
    justify-content: space-between;
    align-items: start;
    margin-bottom: 1rem;
}

.employee-name {
    font-size: 1.1rem;
    font-weight: 600;
    color: white;
}

.employee-position {
    color: var(--primary);
    font-size: 0.9rem;
    margin-top: 0.25rem;
}

.card-actions {
    display: flex;
    gap: 0.5rem;
}

.employee-details {
    display: grid;
    gap: 0.75rem;
}

.detail-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5rem 0;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
}

.detail-label {
    color: var(--text-secondary);
    font-size: 0.85rem;
}

/* Animacje */
@keyframes slideInLeft {
    from {
        transform: translateX(-100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

/* Settings styles - POPRAWIONE */
.settings-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    gap: 2rem;
    margin-top: 2rem;
}

.settings-section {
    background: var(--glass-bg);
    backdrop-filter: blur(10px);
    border: 1px solid var(--glass-border);
    border-radius: 20px;
    padding: 1.5rem;
}

.settings-title {
    color: white;
    font-size: 1.2rem;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.settings-list {
    max-height: 300px;
    overflow-y: auto;
    margin-bottom: 1rem;
}

.settings-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 10px;
    margin-bottom: 0.5rem;
    transition: all 0.2s ease;
}

.settings-item:hover {
    background: rgba(255, 255, 255, 0.1);
}

.settings-item input {
    background: transparent;
    border: none;
    color: white;
    font-size: 0.95rem;
    flex: 1;
    padding: 0.25rem;
    border-radius: 5px;
    transition: all 0.2s ease;
}

.settings-item input:focus {
    background: rgba(255, 255, 255, 0.1);
    outline: 1px solid var(--primary);
}

.settings-item-actions {
    display: flex;
    gap: 0.5rem;
    opacity: 0;
    transition: opacity 0.2s ease;
}

.settings-item:hover .settings-item-actions {
    opacity: 1;
}

.settings-add-form {
    display: flex;
    gap: 1rem;
    margin-top: 1rem;
}

.settings-add-form input {
    flex: 1;
}

/* OdzieÅ¼ na szkolenie - nowe style */
.training-clothes-display {
    background: var(--glass-bg);
    backdrop-filter: blur(10px);
    border: 1px solid var(--glass-border);
    border-radius: 20px;
    padding: 2rem;
    margin-top: 2rem;
}

.employee-info-section {
    display: grid;
    grid-template-columns: 2fr 1fr 1.5fr 1.5fr;
    gap: 2rem;
    margin-bottom: 2rem;
    padding-bottom: 2rem;
    border-bottom: 1px solid var(--glass-border);
}

.info-item {
    text-align: center;
}

.info-label {
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin-bottom: 0.5rem;
}

.info-value {
    color: white;
    font-size: 1.2rem;
    font-weight: 600;
}

.clothes-list-section {
    margin-top: 2rem;
}

.clothes-list-title {
    color: white;
    font-size: 1.4rem;
    font-weight: 600;
    margin-bottom: 1.5rem;
}

.training-clothes-list {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.clothes-item {
    background: rgba(255, 255, 255, 0.05);
    padding: 1rem;
    border-radius: 12px;
    font-size: 1.1rem;
    color: white;
    border-left: 4px solid var(--primary);
    transition: all 0.2s ease;
}

.clothes-item:hover {
    background: rgba(255, 255, 255, 0.1);
    transform: translateX(5px);
}

/* Position to clothes mapping in settings */
.position-clothes-mapping {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.mapping-item {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid var(--glass-border);
    border-radius: 15px;
    padding: 1rem;
}

.mapping-position {
    color: white;
    font-weight: 600;
    margin-bottom: 0.75rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.clothes-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
}

.clothes-tag {
    background: rgba(99, 102, 241, 0.2);
    color: var(--primary);
    padding: 0.25rem 0.75rem;
    border-radius: 50px;
    font-size: 0.85rem;
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
}

.remove-tag {
    cursor: pointer;
    font-size: 0.75rem;
    color: var(--danger);
    margin-left: 0.25rem;
}

.add-clothes-form {
    display: flex;
    gap: 0.5rem;
    margin-top: 0.75rem;
}

/* Loading spinner */
.loading-spinner {
    display: inline-block;
    width: 40px;
    height: 40px;
    border: 3px solid rgba(255, 255, 255, 0.3);
    border-radius: 50%;
    border-top-color: white;
    animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

/* Media queries */
@media (max-width: 1200px) {
    .actions-grid {
        grid-template-columns: 2fr repeat(3, 1fr);
        gap: 0.75rem;
    }
    
    .actions-grid > * {
        grid-column: auto;
    }
    
    .search-box {
        grid-column: 1 / -1;
    }
}

@media (max-width: 1024px) {
    .employee-info-section {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .actions-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 0.75rem;
    }
    
    .search-box {
        grid-column: 1 / -1;
    }
}

@media (max-width: 768px) {
    .language-selector {
        top: 5.5rem;
        left: 1rem;
        padding: 0.3rem;
        gap: 0.3rem;
    }
    
    .lang-btn {
        padding: 0.4rem 0.6rem;
        font-size: 0.75rem;
    }
    
    .sync-status {
        top: 5.5rem;
        right: 1rem;
        padding: 0.4rem 0.8rem;
        font-size: 0.85rem;
    }
    
    .nav-container {
        padding: 0 1rem;
    }
    
    .tabs {
        flex-wrap: wrap;
        gap: 0.5rem;
    }
    
    .tab {
        padding: 0.5rem 1rem;
        font-size: 0.85rem;
    }
    
    .container {
        padding: 1rem;
    }
    
    .stats-grid {
        grid-template-columns: 1fr;
    }
    
    .actions-grid {
        grid-template-columns: 1fr;
    }
    
    .settings-container {
        grid-template-columns: 1fr;
    }
    
    .settings-section {
        min-width: unset;
    }
    
    .table-container {
        display: none;
    }
    
    .mobile-view {
        display: block;
    }
    
    .mobile-fab {
        display: flex;
    }
    
    .modal-content {
        width: 95%;
        margin: 2% auto;
        max-height: 95vh;
    }
    
    #dept-modal-content,
    form {
        max-height: calc(95vh - 80px);
    }
    
    .employee-info-section {
        grid-template-columns: 1fr;
        gap: 1rem;
    }
}

/* Style dla wydruku - DOSTOSOWANE DO A4 */
@media print {
  /* Reset wszystkich elementÃ³w */
  * {
    visibility: hidden !important;
    position: absolute !important;
  }
  
  /* Reset dla html i body */
  html, body {
    visibility: visible !important;
    position: static !important;
    margin: 0 !important;
    padding: 0 !important;
    width: 100% !important;
    height: 100vh !important;
    background: white !important;
    color: black !important;
  }
  
  /* Kontener gÅ‚Ã³wny */
  body .container {
    visibility: visible !important;
    position: static !important;
    margin: 0 !important;
    padding: 0 !important;
    max-width: none !important;
    width: 100% !important;
    height: 100% !important;
  }
  
  /* Dla trybu wydawania odzieÅ¼y */
  body.printing-mode #clothing,
  body.printing-mode #clothing * {
    visibility: visible !important;
    position: static !important;
  }
  
  body.printing-mode #employee-clothing-card {
    display: block !important;
    visibility: visible !important;
    position: static !important;
    margin: 0 !important;
    padding: 0 !important;
    width: 100% !important;
    height: 100vh !important;
  }
  
  body.printing-mode #employee-clothing-card .table-container,
  body.printing-mode #employee-clothing-card .table-container * {
    visibility: visible !important;
    position: static !important;
    background: white !important;
    color: black !important;
    box-shadow: none !important;
    backdrop-filter: none !important;
  }
  
  body.printing-mode #employee-clothing-card .table-container {
    background: #f0f0f5 !important;
    border: 2px solid #333 !important;
    border-radius: 10px !important;
    padding: 30px 40px !important;
    height: calc(100vh - 2cm) !important;
    margin: 1cm !important;
    display: flex !important;
    flex-direction: column !important;
  }
  
  /* NagÅ‚Ã³wek karty */
  body.printing-mode #employee-clothing-card h3 {
    color: black !important;
    font-size: 20pt !important;
    text-align: center !important;
    margin: 0 0 30px 0 !important;
    font-weight: bold !important;
  }
  
  /* Grid z danymi pracownika */
  body.printing-mode #employee-clothing-card .table-container > div:first-child + div {
    display: grid !important;
    grid-template-columns: 1fr 1fr !important;
    gap: 15px 30px !important;
    margin-bottom: 30px !important;
  }
  
  /* Etykiety danych */
  body.printing-mode #employee-clothing-card .table-container > div:first-child + div p:first-child {
    color: #666 !important;
    font-size: 10pt !important;
    margin: 0 0 3px 0 !important;
  }
  
  /* WartoÅ›ci danych */
  body.printing-mode #employee-clothing-card .table-container > div:first-child + div p:last-child {
    color: black !important;
    font-size: 12pt !important;
    font-weight: 600 !important;
    margin: 0 !important;
  }
  
  /* Historia odzieÅ¼y */
  #clothing-history {
    background: rgba(0, 0, 0, 0.05) !important;
    border: 1px solid #ccc !important;
    border-radius: 5px !important;
    padding: 15px !important;
    margin: 0 0 auto 0 !important;
    min-height: 150px !important;
    max-height: 300px !important;
    overflow-y: auto !important;
    flex-grow: 1 !important;
  }
  
  #clothing-history h4 {
    color: black !important;
    font-size: 12pt !important;
    margin: 0 0 10px 0 !important;
  }
  
  #clothing-history > div {
    background: white !important;
    border: 1px solid #ddd !important;
    border-radius: 5px !important;
    margin-bottom: 10px !important;
    padding: 10px !important;
  }
  
  #clothing-history p {
    font-size: 10pt !important;
    margin: 0 0 5px 0 !important;
  }
  
  /* Ukrycie przycisku usuwania w historii */
  #clothing-history .btn-icon {
    display: none !important;
  }
  
  /* Sekcja podpisÃ³w - pokazanie OBIE */
  body.printing-mode #employee-clothing-card .table-container > div:last-child {
    display: block !important;
    visibility: visible !important;
    position: static !important;
    margin-top: auto !important;
    padding-top: 30px !important;
    border-top: 1px solid #000 !important;
  }
  
  body.printing-mode #employee-clothing-card .table-container > div:last-child > div {
    display: grid !important;
    grid-template-columns: 1fr 1fr !important;
    gap: 50px !important;
  }
  
  /* Pokazanie OBU podpisÃ³w */
  body.printing-mode #employee-clothing-card .table-container > div:last-child > div > div {
    display: block !important;
    visibility: visible !important;
    position: static !important;
    width: 100% !important;
  }
  
  body.printing-mode #employee-clothing-card .table-container > div:last-child > div > div p {
    color: black !important;
    font-size: 11pt !important;
    margin: 0 0 40px 0 !important;
    text-align: left !important;
  }
  
  body.printing-mode #employee-clothing-card .table-container > div:last-child > div > div > div {
    border-bottom: 2px dotted #333 !important;
    height: 1px !important;
    margin: 0 !important;
  }
  
  /* Dla trybu odzieÅ¼y na szkolenie */
  body.printing-training #training-clothes,
  body.printing-training #training-clothes * {
    visibility: visible !important;
    position: static !important;
  }
  
  body.printing-training #training-clothes-display {
    display: flex !important;
    flex-direction: column !important;
    visibility: visible !important;
    position: static !important;
    background: #f0f0f5 !important;
    color: black !important;
    border: 2px solid #333 !important;
    border-radius: 10px !important;
    padding: 30px 40px !important;
    margin: 1cm !important;
    height: calc(100vh - 2cm) !important;
    box-shadow: none !important;
    backdrop-filter: none !important;
  }
  
  body.printing-training #training-clothes-display > h3:first-child {
    color: black !important;
    font-size: 20pt !important;
    text-align: center !important;
    margin: 0 0 30px 0 !important;
    font-weight: bold !important;
    text-transform: uppercase !important;
  }
  
  body.printing-training .employee-info-section {
    display: grid !important;
    grid-template-columns: 2fr 1fr 1fr 1fr !important;
    gap: 20px !important;
    margin-bottom: 30px !important;
    padding-bottom: 20px !important;
    border-bottom: 1px solid #ccc !important;
  }
  
  body.printing-training .info-item {
    text-align: left !important;
  }
  
  body.printing-training .info-label {
    color: #666 !important;
    font-size: 10pt !important;
    margin: 0 0 3px 0 !important;
  }
  
  body.printing-training .info-value {
    color: black !important;
    font-size: 12pt !important;
    font-weight: 600 !important;
    margin: 0 !important;
  }
  
  body.printing-training .clothes-list-section {
    flex-grow: 1 !important;
  }
  
  body.printing-training .clothes-list-title {
    color: black !important;
    font-size: 14pt !important;
    font-weight: bold !important;
    margin: 0 0 15px 0 !important;
  }
  
  body.printing-training .training-clothes-list {
    background: rgba(0, 0, 0, 0.05) !important;
    border: 1px solid #ccc !important;
    border-radius: 5px !important;
    padding: 15px !important;
    min-height: 150px !important;
  }
  
  body.printing-training .clothes-item {
    background: white !important;
    border: 1px solid #ddd !important;
    border-left: 4px solid #333 !important;
    padding: 10px !important;
    margin-bottom: 8px !important;
    font-size: 11pt !important;
    color: black !important;
    border-radius: 3px !important;
  }
  
  /* Sekcja podpisÃ³w dla odzieÅ¼y na szkolenie */
  body.printing-training .signature-section {
    display: block !important;
    visibility: visible !important;
    position: static !important;
    margin-top: auto !important;
    padding-top: 30px !important;
    border-top: 1px solid #000 !important;
  }
  
  body.printing-training .signature-section > div {
    display: grid !important;
    grid-template-columns: 1fr 1fr !important;
    gap: 50px !important;
  }
  
  /* Pokazanie OBU podpisÃ³w */
  body.printing-training .signature-section > div > div {
    display: block !important;
    visibility: visible !important;
    position: static !important;
    width: 100% !important;
  }
  
  body.printing-training .signature-section p {
    color: black !important;
    font-size: 11pt !important;
    margin: 0 0 40px 0 !important;
    text-align: left !important;
  }
  
  body.printing-training .signature-section > div > div > div {
    border-bottom: 2px dotted #333 !important;
    height: 1px !important;
    margin: 0 !important;
  }
  
  /* Ukrycie niepotrzebnych elementÃ³w */
  .btn-icon,
  .navbar,
  .language-selector,
  .sync-status,
  .actions-panel,
  .stats-grid,
  .save-instruction,
  .department-stats,
  .filters-section,
  .date-sort-buttons,
  .mobile-fab,
  .pull-to-refresh,
  .offline-indicator,
  .empty-state,
  .close-btn {
    display: none !important;
  }
  
  @page {
    size: A4 portrait;
    margin: 0;
  }
}
</style>
</head>
<body>
<div class="bg-animation">
<span style="left: 10%; animation-delay: 0s;"></span>
<span style="left: 20%; animation-delay: 2s; width: 80px; height: 80px;"></span>
<span style="left: 30%; animation-delay: 4s;"></span>
<span style="left: 40%; animation-delay: 0s; width: 60px; height: 60px;"></span>
<span style="left: 50%; animation-delay: 6s;"></span>
<span style="left: 60%; animation-delay: 8s;"></span>
<span style="left: 70%; animation-delay: 4s; width: 120px; height: 120px;"></span>
<span style="left: 80%; animation-delay: 2s;"></span>
<span style="left: 90%; animation-delay: 1s;"></span>
</div>

<!-- Language Selector -->
<div class="language-selector" id="language-selector">
    <button class="lang-btn active" data-lang="pl" onclick="changeLanguage('pl')">PL</button>
    <button class="lang-btn" data-lang="ua" onclick="changeLanguage('ua')">UA</button>
    <button class="lang-btn" data-lang="en" onclick="changeLanguage('en')">EN</button>
    <button class="lang-btn" data-lang="es" onclick="changeLanguage('es')">ES</button>
</div>

<!-- Sync Status Indicator -->
<div class="sync-status" id="sync-status" onclick="forceDataRefresh()" data-tooltip="Kliknij aby odÅ›wieÅ¼yÄ‡">
    <svg class="sync-icon" id="sync-icon" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
        <polyline points="23 4 23 10 17 10"></polyline>
        <polyline points="1 20 1 14 7 14"></polyline>
        <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
    </svg>
    <span id="sync-text">Offline</span>
</div>

<!-- Login Panel -->
<div id="login-panel" class="login-panel">
    <h2 style="text-align: center; color: white; margin-bottom: 2rem;" data-i18n="login.title">
        System HR - Synchronizacja w czasie rzeczywistym
    </h2>
    <form class="login-form" onsubmit="loginWithEmail(event)">
        <div class="form-group">
            <label class="form-label" data-i18n="login.email">Email</label>
            <input type="email" class="form-input" id="login-email" required>
        </div>
        <div class="form-group">
            <label class="form-label" data-i18n="login.password">HasÅ‚o</label>
            <input type="password" class="form-input" id="login-password" required>
        </div>
        <div class="auth-buttons">
            <button type="submit" class="btn btn-primary" data-i18n="login.signIn">Zaloguj siÄ™</button>
            <button type="button" class="btn btn-google" onclick="loginWithGoogle()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="white">
                    <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                    <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                    <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                    <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                </svg>
                <span data-i18n="login.googleSignIn">Zaloguj przez Google</span>
            </button>
            <button type="button" class="btn" onclick="registerWithEmail()" style="background: rgba(255,255,255,0.1); color: white;">
                <span data-i18n="login.register">Zarejestruj siÄ™</span>
            </button>
        </div>
    </form>
    <div style="margin-top: 2rem; text-align: center; color: rgba(255, 255, 255, 0.6); font-size: 0.85rem;">
        <p data-i18n="login.feature1">âœ¨ Synchronizacja w czasie rzeczywistym</p>
        <p data-i18n="login.feature2">ğŸ“± DziaÅ‚a na wszystkich urzÄ…dzeniach</p>
        <p data-i18n="login.feature3">ğŸ”’ Bezpieczne przechowywanie danych</p>
    </div>
</div>

<!-- Main App -->
<div id="main-app" style="display: none;">
<nav class="navbar">
<div class="nav-container">
<div class="logo">System HR</div>
<div class="tabs">
<button class="tab active" data-tab="employees" data-i18n="nav.activeEmployees">Aktywni pracownicy</button>
<button class="tab" data-tab="deleted" data-i18n="nav.deletedEmployees">UsuniÄ™ci pracownicy</button>
<button class="tab" data-tab="clothing" data-i18n="nav.clothingIssue">Wydawanie odzieÅ¼y</button>
<button class="tab" data-tab="training-clothes" data-i18n="nav.trainingClothes">OdzieÅ¼ na szkolenie</button>
<button class="tab" data-tab="settings">âš™ï¸ <span data-i18n="nav.settings">Ustawienia</span></button>
<button class="tab" onclick="logout()" style="background: rgba(239, 68, 68, 0.1); color: #ef4444;">ğŸšª <span data-i18n="nav.logout">Wyloguj</span></button>
</div>
</div>
</nav>
<div class="container">
<!-- Karta aktywnych pracownikÃ³w -->
<div class="tab-content active" id="employees">
<div class="stats-grid">
<div class="stat-card">
<div class="stat-number" id="total-employees">0</div>
<div class="stat-label" data-i18n="stats.totalEmployees">ÅÄ…cznie pracownikÃ³w</div>
</div>
<div class="stat-card">
<div class="stat-number" id="departments-count">0</div>
<div class="stat-label" data-i18n="stats.departments">DziaÅ‚Ã³w</div>
</div>
<div class="stat-card">
<div class="stat-number" id="nationalities-count">0</div>
<div class="stat-label" data-i18n="stats.nationalities">NarodowoÅ›ci</div>
</div>
<div class="stat-card" id="filtered-count-card" style="display: none;">
<div class="stat-number" id="filtered-employees">0</div>
<div class="stat-label" data-i18n="stats.filteredEmployees">PracownikÃ³w po filtrowaniu</div>
</div>
<div class="stat-card" id="info-card" style="grid-column: 1 / -1; background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(236, 72, 153, 0.2));">
<p style="color: rgba(255, 255, 255, 0.9); font-size: 0.95rem; margin: 0;" data-i18n="info.uploadExcel">
                        ğŸ’¡ Kliknij przycisk "ZaÅ‚aduj Excel" powyÅ¼ej, aby zaimportowaÄ‡ dane z pliku
                    </p>
<p style="color: rgba(255, 255, 255, 0.7); font-size: 0.85rem; margin-top: 0.5rem;" data-i18n="info.supportedColumns">
                        ObsÅ‚ugiwane kolumny: Nazwisko,ImiÄ™ | Stanowisko | DziaÅ‚ | Zmiana | RCP | Obywatelstwo | Szafka | Data przyjÄ™cia
                    </p>
<!-- Ğ”Ğ¾Ğ´Ğ°Ğ¹ Ñ†ĞµĞ¹ Ğ±Ğ»Ğ¾Ğº Ğ´ĞµÑÑŒ Ñƒ Ñ€Ğ¾Ğ·Ğ´Ñ–Ğ»Ñ– Ustawienia Ğ°Ğ±Ğ¾ Ğ²Ğ½Ğ¸Ğ·Ñƒ ÑÑ‚Ğ¾Ñ€Ñ–Ğ½ĞºĞ¸ -->
<div class="settings-section" id="custom-section-container">
  <h3 class="settings-title">
    â• Create New Section
  </h3>
  <p style="color: var(--text-secondary); margin-bottom: 1rem;">
    Add custom categories like Buildings, Locations, Certifications, or any other data you need to track
  </p>
  <button class="btn btn-primary" onclick="showNewSectionPrompt()">
    â• Add New Section
  </button>
  <ul id="custom-sections-list" class="settings-list" style="margin-top: 1rem;"></ul>
</div>

<script>
let userId = null;

firebase.auth().onAuthStateChanged(user => {
  if (user) {
    userId = user.uid;
    listenForCustomSections();
  }
});

function showNewSectionPrompt() {
  const sectionName = prompt("Enter name of new section:");
  if (!sectionName) return;
  const newRef = firebase.database().ref(`sections/${userId}/customSections`).push();
  newRef.set({ name: sectionName, createdAt: Date.now() });
}

function listenForCustomSections() {
  firebase.database().ref(`sections/${userId}/customSections`).on('value', snapshot => {
    const data = snapshot.val() || {};
    renderCustomSections(data);
  });
}

function renderCustomSections(data) {
  const list = document.getElementById("custom-sections-list");
  list.innerHTML = "";
  Object.entries(data).forEach(([id, item]) => {
    const li = document.createElement("li");
    li.className = "settings-item";
    li.innerHTML = `
      <input type="text" value="${item.name}" onchange="updateCustomSection('${id}', this.value)" />
      <div class="settings-item-actions">
        <button class="btn-icon delete" onclick="deleteCustomSection('${id}')">ğŸ—‘ï¸</button>
      </div>
    `;
    list.appendChild(li);
  });
  refreshFiltersWithSections(data);
}

function updateCustomSection(id, newName) {
  if (!newName.trim()) return;
  firebase.database().ref(`sections/${userId}/customSections/${id}`).update({ name: newName });
}

function deleteCustomSection(id) {
  if (confirm("Are you sure you want to delete this section?")) {
    firebase.database().ref(`sections/${userId}/customSections/${id}`).remove();
  }
}

function refreshFiltersWithSections(data) {
  const filterSelect = document.getElementById("filter-department");
  if (!filterSelect) return;
  const current = filterSelect.value;
  filterSelect.innerHTML = '<option value="">Wszystkie dziaÅ‚y</option>';
  Object.values(data).forEach(sec => {
    const opt = document.createElement("option");
    opt.value = sec.name;
    opt.textContent = sec.name;
    filterSelect.appendChild(opt);
  });
  filterSelect.value = current;
  applyFilters();
}
</script>

</div>
</div>
<!-- Instrukcja zapisywania danych -->

<div class="save-instruction">
<h3>
<svg fill="none" height="24" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="24">
<path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
<polyline points="23 4 23 10 17 10"></polyline>
<polyline points="1 20 1 14 7 14"></polyline>
</svg>
<span data-i18n="sync.title">ğŸš€ Synchronizacja w czasie rzeczywistym!</span>
</h3>
<p><strong data-i18n="sync.auto">âœ… Automatyczna synchronizacja</strong><br/><span data-i18n="sync.autoDesc">Wszystkie zmiany sÄ… natychmiast synchronizowane miÄ™dzy urzÄ…dzeniami</span></p>
<p><strong data-i18n="sync.multi">ğŸ“± Multi-urzÄ…dzenie</strong><br/><span data-i18n="sync.multiDesc">Pracuj na komputerze, tablecie i telefonie jednoczeÅ›nie</span></p>
<p><strong data-i18n="sync.security">ğŸ”’ BezpieczeÅ„stwo</strong><br/><span data-i18n="sync.securityDesc">Dane sÄ… bezpiecznie przechowywane w chmurze Firebase</span></p>
<p><strong data-i18n="sync.offline">âš¡ Praca offline</strong><br/><span data-i18n="sync.offlineDesc">Aplikacja dziaÅ‚a bez internetu - dane zsynchronizujÄ… siÄ™ po poÅ‚Ä…czeniu</span></p>
<p><strong data-i18n="sync.collaboration">ğŸ‘¥ WspÃ³Å‚praca</strong><br/><span data-i18n="sync.collaborationDesc">Zaloguj siÄ™ tym samym kontem na rÃ³Å¼nych urzÄ…dzeniach</span></p>
<p><strong data-i18n="sync.firebaseRules">ğŸ” WaÅ¼ne! Ustaw reguÅ‚y bezpieczeÅ„stwa w Firebase Console:</strong><br/>
Database â†’ Rules â†’ <span data-i18n="sync.changeRules">ZmieÅ„ na:</span><br/>
<code>{
  "rules": {
    "users": {
      "$uid": {
        ".read": "$uid === auth.uid",
        ".write": "$uid === auth.uid"
      }
    }
  }
}</code></p>
<p><strong data-i18n="sync.howItWorks">Jak to dziaÅ‚a:</strong><br/>
<span data-i18n="sync.step1">1. WprowadÅº zmiany na dowolnym urzÄ…dzeniu</span><br/>
<span data-i18n="sync.step2">2. Dane automatycznie pojawiÄ… siÄ™ na innych urzÄ…dzeniach</span><br/>
<span data-i18n="sync.step3">3. Status synchronizacji widoczny w prawym gÃ³rnym rogu (kliknij aby odÅ›wieÅ¼yÄ‡)</span><br/>
<span data-i18n="sync.step4">4. Brak potrzeby rÄ™cznego zapisywania!</span></p>
</div>

<!-- Statystyki dziaÅ‚Ã³w -->
<div class="department-stats" id="department-stats" style="display: none;">
<h3 style="color: white; margin-bottom: 1.5rem; font-size: 1.5rem;" data-i18n="departments.statsTitle">ğŸ“Š Statystyki wedÅ‚ug dziaÅ‚Ã³w</h3>
<!-- OgÃ³lna wizualizacja -->
<div class="overall-dept-chart" style="background: var(--glass-bg); backdrop-filter: blur(10px); border: 1px solid var(--glass-border); border-radius: 20px; padding: 1.5rem; margin-bottom: 2rem;">
<h4 style="color: white; margin-bottom: 1rem;" data-i18n="departments.distribution">RozkÅ‚ad pracownikÃ³w wedÅ‚ug dziaÅ‚Ã³w</h4>
<div id="dept-distribution-chart"></div>
</div>
<div class="dept-cards-grid" id="dept-cards-grid">
<!-- Karty dziaÅ‚Ã³w bÄ™dÄ… tutaj -->
</div>
</div>
<div class="actions-panel">
<div class="filters-section" style="margin-bottom: 1rem;">
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
<div class="filter-group">
<label style="color: rgba(255, 255, 255, 0.7); font-size: 0.85rem; margin-bottom: 0.25rem; display: block;" data-i18n="filters.byDepartment">Filtruj po dziale:</label>
<select class="form-input filter-select" id="filter-department" onchange="applyFilters()" style="padding: 0.5rem; font-size: 0.9rem;">
<option value="" data-i18n="filters.allDepartments">Wszystkie dziaÅ‚y</option>
</select>
</div>
<div class="filter-group">
<label style="color: rgba(255, 255, 255, 0.7); font-size: 0.85rem; margin-bottom: 0.25rem; display: block;" data-i18n="filters.byPosition">Filtruj po stanowisku:</label>
<select class="form-input filter-select" id="filter-position" onchange="applyFilters()" style="padding: 0.5rem; font-size: 0.9rem;">
<option value="" data-i18n="filters.allPositions">Wszystkie stanowiska</option>
</select>
</div>
<div class="filter-group">
<label style="color: rgba(255, 255, 255, 0.7); font-size: 0.85rem; margin-bottom: 0.25rem; display: block;" data-i18n="filters.byShift">Filtruj po zmianie:</label>
<select class="form-input filter-select" id="filter-shift" onchange="applyFilters()" style="padding: 0.5rem; font-size: 0.9rem;">
<option value="" data-i18n="filters.allShifts">Wszystkie zmiany</option>
</select>
</div>
</div>
</div>
<div class="date-sort-buttons">
<span style="color: rgba(255, 255, 255, 0.7); margin-right: 1rem;" data-i18n="sort.byHireDate">Sortuj wedÅ‚ug daty przyjÄ™cia:</span>
<button class="sort-btn" onclick="sortByDateNewest()">
<svg fill="none" height="16" stroke="currentColor" stroke-width="2" style="display: inline-block; vertical-align: middle; margin-right: 0.25rem;" viewbox="0 0 24 24" width="16">
<line x1="12" x2="12" y1="19" y2="5"></line>
<polyline points="5 12 12 5 19 12"></polyline>
</svg>
                        <span data-i18n="sort.newest">Najnowsi</span>
                    </button>
<button class="sort-btn" onclick="sortByDateOldest()">
<svg fill="none" height="16" stroke="currentColor" stroke-width="2" style="display: inline-block; vertical-align: middle; margin-right: 0.25rem;" viewbox="0 0 24 24" width="16">
<line x1="12" x2="12" y1="5" y2="19"></line>
<polyline points="19 12 12 19 5 12"></polyline>
</svg>
                        <span data-i18n="sort.oldest">Najstarsi</span>
                    </button>
</div>
<div class="actions-grid" style="grid-template-columns: 2fr repeat(7, 1fr);">
<div class="search-box">
<svg class="search-icon" fill="none" height="20" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="20">
<circle cx="11" cy="11" r="8"></circle>
<path d="m21 21-4.35-4.35"></path>
</svg>
<input class="search-input" id="search" placeholder="Szukaj pracownikÃ³w..." type="search" autocomplete="off" data-i18n-placeholder="search.employees"/>
<button class="clear-search" onclick="clearSearch()" type="button">
<svg fill="none" height="16" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="16">
<line x1="18" y1="6" x2="6" y2="18"></line>
<line x1="6" y1="6" x2="18" y2="18"></line>
</svg>
</button>
</div>
<button class="btn btn-primary" onclick="openAddModal()">
<svg fill="none" height="20" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="20">
<line x1="12" x2="12" y1="5" y2="19"></line>
<line x1="5" x2="19" y1="12" y2="12"></line>
</svg>
                        <span data-i18n="buttons.addEmployee">Dodaj pracownika</span>
                    </button>
<label class="btn btn-success" onclick="console.log('Excel button clicked')">
<svg fill="none" height="20" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="20">
<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
<polyline points="7 10 12 15 17 10"></polyline>
<line x1="12" x2="12" y1="15" y2="3"></line>
</svg>
                        <span data-i18n="buttons.loadExcel">ZaÅ‚aduj Excel</span>
                        <input accept=".xlsx,.xls" id="file-input" style="display: none;" type="file" onchange="console.log('File input changed:', this.files)"/>
</label>
<button class="btn" onclick="exportToExcel()" style="background: linear-gradient(135deg, #f59e0b, #d97706); color: white;">
<svg fill="none" height="20" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="20">
<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
<polyline points="14 2 14 8 20 8"></polyline>
<line x1="16" x2="8" y1="13" y2="13"></line>
<line x1="16" x2="8" y1="17" y2="17"></line>
<polyline points="10 9 9 9 8 9"></polyline>
</svg>
                        <span data-i18n="buttons.exportExcel">Eksport Excel</span>
                    </button>
<button class="btn" onclick="exportToJSON()" style="background: linear-gradient(135deg, #ec4899, #db2777); color: white;">
<svg fill="none" height="20" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="20">
<path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
<polyline points="17 21 17 13 7 13 7 21"></polyline>
<polyline points="7 3 7 8 15 8"></polyline>
</svg>
                        <span data-i18n="buttons.backupJSON">Backup JSON</span>
                    </button>
<button class="btn" onclick="createSampleExcel()" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed); color: white;">
<svg fill="none" height="20" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="20">
<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
<polyline points="14 2 14 8 20 8"></polyline>
<line x1="12" x2="12" y1="18" y2="12"></line>
<line x1="9" x2="15" y1="15" y2="15"></line>
</svg>
                        <span data-i18n="buttons.sampleExcel">PrzykÅ‚ad Excel</span>
                    </button>
<label class="btn" style="background: linear-gradient(135deg, #3b82f6, #2563eb); color: white;">
<svg fill="none" height="20" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="20">
<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
<polyline points="7 10 12 15 17 10"></polyline>
<line x1="12" x2="12" y1="15" y2="3"></line>
</svg>
                        <span data-i18n="buttons.importJSON">Import JSON</span>
                        <input accept=".json" onchange="if(this.files.length > 0) importFromJSON(this.files[0])" style="display: none;" type="file"/>
</label>
<button class="btn" onclick="clearAllEmployees()" style="background: linear-gradient(135deg, #ef4444, #dc2626); color: white;" title="UsuÅ„ wszystkich pracownikÃ³w">
<svg fill="none" height="20" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="20">
<polyline points="3 6 5 6 21 6"></polyline>
<path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
<line x1="10" x2="10" y1="11" y2="17"></line>
<line x1="14" x2="14" y1="11" y2="17"></line>
</svg>
                        <span data-i18n="buttons.clearList">WyczyÅ›Ä‡ listÄ™</span>
                    </button>
</div>
</div>
<div class="table-container">
<div class="table-wrapper">
<table id="employees-table">
<thead>
<tr>
<th onclick="sortEmployees('name')" data-i18n="table.name">Nazwisko, ImiÄ™</th>
<th onclick="sortEmployees('position')" data-i18n="table.position">Stanowisko</th>
<th onclick="sortEmployees('department')" data-i18n="table.department">DziaÅ‚</th>
<th onclick="sortEmployees('shift')" data-i18n="table.shift">Zmiana</th>
<th onclick="sortEmployees('rcp')" data-i18n="table.rcp">RCP</th>
<th onclick="sortEmployees('citizenship')" data-i18n="table.citizenship">Obywatelstwo</th>
<th onclick="sortEmployees('locker')" data-i18n="table.locker">Szafka</th>
<th onclick="sortEmployees('hireDate')" data-i18n="table.hireDate">Data przyjÄ™cia</th>
<th data-i18n="table.actions">Akcje</th>
</tr>
</thead>
<tbody id="employees-tbody">
</tbody>
</table>
</div>
<div style="padding: 0.5rem 1rem; background: rgba(255, 255, 255, 0.05); border-radius: 0 0 20px 20px;">
<p style="color: rgba(255, 255, 255, 0.6); font-size: 0.85rem; margin: 0; text-align: center;" data-i18n="table.editHint">
                        ğŸ’¡ WskazÃ³wka: Kliknij na dowolnÄ… komÃ³rkÄ™ w tabeli, aby edytowaÄ‡ dane bezpoÅ›rednio
                    </p>
</div>
</div>
<!-- Mobilny widok kart -->
<div class="mobile-view">
<div class="mobile-cards" id="mobile-cards">
<!-- Karty pracownikÃ³w bÄ™dÄ… tutaj -->
</div>
</div>
</div>
<!-- Karta usuniÄ™tych pracownikÃ³w -->
<div class="tab-content" id="deleted">
<div class="actions-panel">
    <button class="btn btn-primary" onclick="openAddDeletedModal()" style="margin-bottom: 1rem;">
        <svg fill="none" height="20" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="20">
            <line x1="12" x2="12" y1="5" y2="19"></line>
            <line x1="5" x2="19" y1="12" y2="12"></line>
        </svg>
        <span data-i18n="buttons.addDeletedEmployee">Dodaj usuniÄ™tego pracownika</span>
    </button>
</div>
<div class="date-sort-buttons" style="margin: 1rem 0;">
<span style="color: rgba(255, 255, 255, 0.7); margin-right: 1rem;" data-i18n="sort.byDeleteDate">Sortuj wedÅ‚ug daty usuniÄ™cia:</span>
<button class="sort-btn" onclick="sortDeletedByDateNewest()">
<svg fill="none" height="16" stroke="currentColor" stroke-width="2" style="display: inline-block; vertical-align: middle; margin-right: 0.25rem;" viewbox="0 0 24 24" width="16">
<line x1="12" x2="12" y1="19" y2="5"></line>
<polyline points="5 12 12 5 19 12"></polyline>
</svg>
                    <span data-i18n="sort.newest">Najnowsi</span>
                </button>
<button class="sort-btn" onclick="sortDeletedByDateOldest()">
<svg fill="none" height="16" stroke="currentColor" stroke-width="2" style="display: inline-block; vertical-align: middle; margin-right: 0.25rem;" viewbox="0 0 24 24" width="16">
<line x1="12" x2="12" y1="5" y2="19"></line>
<polyline points="19 12 12 19 5 12"></polyline>
</svg>
                    <span data-i18n="sort.oldest">Najstarsi</span>
                </button>
</div>
<div class="table-container">
<div class="table-wrapper">
<table id="deleted-table">
<thead>
<tr>
<th data-i18n="table.name">Nazwisko, ImiÄ™</th>
<th data-i18n="table.position">Stanowisko</th>
<th data-i18n="table.department">DziaÅ‚</th>
<th data-i18n="table.shift">Zmiana</th>
<th data-i18n="table.rcp">RCP</th>
<th data-i18n="table.citizenship">Obywatelstwo</th>
<th data-i18n="table.deleteDate">Data usuniÄ™cia</th>
<th data-i18n="table.actions">Akcje</th>
</tr>
</thead>
<tbody id="deleted-tbody">
</tbody>
</table>
</div>
<div class="empty-state" id="deleted-empty" style="display: none;">
<svg fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24">
<path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
<polyline points="16 17 21 12 16 7"></polyline>
<line x1="21" x2="9" y1="12" y2="12"></line>
</svg>
<p data-i18n="empty.deletedEmployees">Brak usuniÄ™tych pracownikÃ³w</p>
</div>
</div>
<!-- Mobilny widok kart dla usuniÄ™tych -->
<div class="mobile-view">
<div class="mobile-cards" id="deleted-mobile-cards">
<!-- Karty usuniÄ™tych pracownikÃ³w bÄ™dÄ… tutaj -->
</div>
</div>
</div>
<!-- Karta wydawania odzieÅ¼y -->
<div class="tab-content" id="clothing">
<div class="stats-grid">
<div class="stat-card" style="grid-column: 1 / -1;">
<h3 style="color: white; margin-bottom: 1rem; font-size: 1.5rem;" data-i18n="clothing.title">ğŸ“¦ System wydawania odzieÅ¼y ochronnej</h3>
<p style="color: rgba(255, 255, 255, 0.7); margin: 0;" data-i18n="clothing.description">
                        Wybierz pracownika z listy aby wydaÄ‡ lub sprawdziÄ‡ historiÄ™ wydanej odzieÅ¼y
                    </p>
</div>
</div>
<div class="actions-panel">
<div class="actions-grid" style="grid-template-columns: 1fr auto auto;">
<div class="form-group" style="margin: 0;">
<select class="form-input" id="clothing-employee-select" onchange="loadEmployeeClothingData()" style="width: 100%;">
<option value="" data-i18n="select.employee">Wybierz pracownika...</option>
</select>
</div>
<button class="btn btn-primary" onclick="openClothingIssueModal()">
<svg fill="none" height="20" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="20">
<path d="M12 2L2 7l10 5 10-5-10-5z"></path>
<path d="M2 17l10 5 10-5"></path>
<path d="M2 12l10 5 10-5"></path>
</svg>
                        <span data-i18n="buttons.issueClothing">Wydaj odzieÅ¼</span>
                    </button>
<button class="btn" onclick="printClothingRecord()" style="background: linear-gradient(135deg, #f59e0b, #d97706); color: white;">
<svg fill="none" height="20" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="20">
<polyline points="6 9 6 2 18 2 18 9"></polyline>
<path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
<rect height="8" width="12" x="6" y="14"></rect>
</svg>
                        <span data-i18n="buttons.printCard">Drukuj kartÄ™</span>
                    </button>
</div>
</div>
<!-- Karta pracownika -->
<div id="employee-clothing-card" style="display: none;">
<div class="table-container" style="background: var(--glass-bg); backdrop-filter: blur(10px); border: 1px solid var(--glass-border); border-radius: 20px; padding: 2rem;">
<h3 style="color: white; margin-bottom: 1.5rem; text-align: center; font-size: 1.8rem;" data-i18n="clothing.cardTitle">Karta wydania odzieÅ¼y ochronnej</h3>
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 2rem;">
<div>
<p style="color: rgba(255, 255, 255, 0.7); margin-bottom: 0.5rem;" data-i18n="fields.nameLabel">Nazwisko, ImiÄ™:</p>
<p id="clothing-employee-name" style="color: white; font-size: 1.2rem; font-weight: 600;">-</p>
</div>
<div>
<p style="color: rgba(255, 255, 255, 0.7); margin-bottom: 0.5rem;" data-i18n="fields.positionLabel">Stanowisko:</p>
<p id="clothing-employee-position" style="color: white; font-size: 1.2rem;">-</p>
</div>
<div>
<p style="color: rgba(255, 255, 255, 0.7); margin-bottom: 0.5rem;" data-i18n="fields.departmentLabel">DziaÅ‚:</p>
<p id="clothing-employee-department" style="color: white; font-size: 1.2rem;">-</p>
</div>
<div>
<p style="color: rgba(255, 255, 255, 0.7); margin-bottom: 0.5rem;" data-i18n="clothing.lastIssueDate">Ostatnio pobrana odzieÅ¼ dnia:</p>
<p id="clothing-last-issue-date" style="color: white; font-size: 1.2rem;">-</p>
</div>
</div>
<div style="margin-bottom: 2rem;">
<h4 style="color: white; margin-bottom: 1rem;" data-i18n="clothing.history">Historia wydanej odzieÅ¼y:</h4>
<div id="clothing-history" style="background: rgba(255, 255, 255, 0.05); border-radius: 15px; padding: 1rem;">
<p style="color: rgba(255, 255, 255, 0.5); text-align: center;" data-i18n="clothing.noHistory">Brak historii wydawania</p>
</div>
</div>
<div style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid rgba(255, 255, 255, 0.2);">
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
<div>
<p style="color: rgba(255, 255, 255, 0.7); margin-bottom: 1rem;" data-i18n="signature.employee">Podpis pracownika:</p>
<div style="border-bottom: 2px dotted rgba(255, 255, 255, 0.3); height: 40px;"></div>
</div>
<div>
<p style="color: rgba(255, 255, 255, 0.7); margin-bottom: 1rem;" data-i18n="signature.issuer">Podpis wydajÄ…cego:</p>
<div style="border-bottom: 2px dotted rgba(255, 255, 255, 0.3); height: 40px;"></div>
</div>
</div>
</div>
</div>
</div>
<!-- Mobilny widok -->
<div class="mobile-view">
<div id="employee-clothing-card-mobile" style="display: none;">
<div class="employee-card">
<h4 style="color: white; text-align: center; margin-bottom: 1rem;" data-i18n="clothing.cardTitle">Karta wydania odzieÅ¼y</h4>
<div class="employee-details">
<div class="detail-row">
<span class="detail-label" data-i18n="fields.employee">Pracownik:</span>
<span id="clothing-employee-name-mobile">-</span>
</div>
<div class="detail-row">
<span class="detail-label" data-i18n="fields.positionLabel">Stanowisko:</span>
<span id="clothing-employee-position-mobile">-</span>
</div>
<div class="detail-row">
<span class="detail-label" data-i18n="fields.departmentLabel">DziaÅ‚:</span>
<span id="clothing-employee-department-mobile">-</span>
</div>
<div class="detail-row">
<span class="detail-label" data-i18n="clothing.lastIssue">Ostatnie wydanie:</span>
<span id="clothing-last-issue-date-mobile">-</span>
</div>
</div>
<div style="margin-top: 1rem; padding: 0.75rem; background: rgba(255, 255, 255, 0.05); border-radius: 10px;">
<p id="clothing-history-mobile" style="color: rgba(255, 255, 255, 0.7); font-size: 0.85rem; margin: 0;" data-i18n="clothing.noHistory">
                                Brak historii wydawania
                            </p>
</div>
</div>
</div>
</div>
</div>
<!-- Karta OdzieÅ¼ na szkolenie - NOWA FUNKCJONALNOÅšÄ† -->
<div class="tab-content" id="training-clothes">
<div class="stats-grid">
<div class="stat-card" style="grid-column: 1 / -1;">
<h3 style="color: white; margin-bottom: 1rem; font-size: 1.5rem;" data-i18n="training.title">ğŸ“ OdzieÅ¼ na szkolenie</h3>
<p style="color: rgba(255, 255, 255, 0.7); margin: 0;" data-i18n="training.description">
                        Wybierz pracownika z listy, aby zobaczyÄ‡ przypisanÄ… odzieÅ¼ na szkolenie dla jego stanowiska
                    </p>
</div>
</div>
<div class="actions-panel">
<div class="actions-grid" style="grid-template-columns: 1fr auto;">
<div class="form-group" style="margin: 0;">
<select class="form-input" id="training-employee-select" onchange="loadTrainingClothes()" style="width: 100%;">
<option value="" data-i18n="select.employee">Wybierz pracownika...</option>
</select>
</div>
<button class="btn" onclick="printTrainingClothes()" style="background: linear-gradient(135deg, #f59e0b, #d97706); color: white;">
<svg fill="none" height="20" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="20">
<polyline points="6 9 6 2 18 2 18 9"></polyline>
<path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
<rect height="8" width="12" x="6" y="14"></rect>
</svg>
                        <span data-i18n="buttons.printCard">Drukuj kartÄ™</span>
                    </button>
</div>
</div>
<!-- WyÅ›wietlanie danych pracownika i odzieÅ¼y -->
<div id="training-clothes-display" class="training-clothes-display" style="display: none;">
<h3 style="color: white; text-align: center; font-size: 1.8rem; margin-bottom: 2rem;" data-i18n="training.cardTitle">Karta odzieÅ¼y na szkolenie</h3>
<div class="employee-info-section">
<div class="info-item">
<p class="info-label" data-i18n="fields.nameLabel">Nazwisko, ImiÄ™:</p>
<p class="info-value" id="training-employee-name">-</p>
</div>
<div class="info-item">
<p class="info-label" data-i18n="fields.rcpLabel">RCP:</p>
<p class="info-value" id="training-employee-rcp">-</p>
</div>
<div class="info-item">
<p class="info-label" data-i18n="fields.positionLabel">Stanowisko:</p>
<p class="info-value" id="training-employee-position">-</p>
</div>
<div class="info-item">
<p class="info-label" data-i18n="fields.departmentLabel">DziaÅ‚:</p>
<p class="info-value" id="training-employee-department">-</p>
</div>
</div>
<div class="clothes-list-section">
<h3 class="clothes-list-title" data-i18n="training.issuedClothing">Wydana odzieÅ¼</h3>
<div class="training-clothes-list" id="training-clothes-list">
<!-- Lista odzieÅ¼y bÄ™dzie tutaj -->
</div>
</div>
<div class="signature-section" style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid rgba(255, 255, 255, 0.2); display: none;">
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
<div>
<p style="color: rgba(255, 255, 255, 0.7); margin-bottom: 1rem;" data-i18n="signature.employee">Podpis pracownika:</p>
<div style="border-bottom: 2px dotted rgba(255, 255, 255, 0.3); height: 40px;"></div>
</div>
<div>
<p style="color: rgba(255, 255, 255, 0.7); margin-bottom: 1rem;" data-i18n="signature.issuer">Podpis wydajÄ…cego:</p>
<div style="border-bottom: 2px dotted rgba(255, 255, 255, 0.3); height: 40px;"></div>
</div>
</div>
</div>
</div>
</div>
<!-- Karta ustawieÅ„ - POPRAWIONA -->
<div class="tab-content" id="settings">
<div class="stats-grid">
<div class="stat-card" style="grid-column: 1 / -1;">
<h3 style="color: white; margin-bottom: 1rem; font-size: 1.5rem;" data-i18n="settings.title">âš™ï¸ ZarzÄ…dzanie listami systemowymi</h3>
<p style="color: rgba(255, 255, 255, 0.7); margin: 0;" data-i18n="settings.description">
                        Tutaj moÅ¼esz dodawaÄ‡, edytowaÄ‡ i usuwaÄ‡ elementy list uÅ¼ywanych w systemie
                    </p>
</div>
</div>
<div class="settings-container">
<!-- DziaÅ‚y -->
<div class="settings-section">
<h3 class="settings-title" data-i18n="settings.departments">ğŸ“ DziaÅ‚y</h3>
<div class="settings-list" id="departments-list">
<!-- Lista dziaÅ‚Ã³w bÄ™dzie tutaj -->
</div>
<div class="settings-add-form">
<input class="form-input" id="new-department" placeholder="Nazwa nowego dziaÅ‚u..." type="text" data-i18n-placeholder="settings.newDepartment"/>
<button class="btn btn-primary" onclick="addDepartment()">
<svg fill="none" height="20" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="20">
<line x1="12" x2="12" y1="5" y2="19"></line>
<line x1="5" x2="19" y1="12" y2="12"></line>
</svg>
                            <span data-i18n="buttons.addDepartment">Dodaj dziaÅ‚</span>
                        </button>
</div>
</div>
<!-- Stanowiska -->
<div class="settings-section">
<h3 class="settings-title" data-i18n="settings.positions">ğŸ‘· Stanowiska</h3>
<div class="settings-list" id="positions-list">
<!-- Lista stanowisk bÄ™dzie tutaj -->
</div>
<div class="settings-add-form">
<input class="form-input" id="new-position" placeholder="Nazwa nowego stanowiska..." type="text" data-i18n-placeholder="settings.newPosition"/>
<button class="btn btn-primary" onclick="addPosition()">
<svg fill="none" height="20" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="20">
<line x1="12" x2="12" y1="5" y2="19"></line>
<line x1="5" x2="19" y1="12" y2="12"></line>
</svg>
                            <span data-i18n="buttons.addPosition">Dodaj stanowisko</span>
                        </button>
</div>
</div>
<!-- Zmiany/Kierownicy -->
<div class="settings-section">
<h3 class="settings-title" data-i18n="settings.shifts">ğŸ‘¥ Zmiany/Kierownicy</h3>
<div class="settings-list" id="shifts-list">
<!-- Lista zmian bÄ™dzie tutaj -->
</div>
<div class="settings-add-form">
<input class="form-input" id="new-shift" placeholder="Nazwa zmiany lub kierownika..." type="text" data-i18n-placeholder="settings.newShift"/>
<button class="btn btn-primary" onclick="addShift()">
<svg fill="none" height="20" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="20">
<line x1="12" x2="12" y1="5" y2="19"></line>
<line x1="5" x2="19" y1="12" y2="12"></line>
</svg>
                            <span data-i18n="buttons.addShift">Dodaj zmianÄ™</span>
                        </button>
</div>
</div>
<!-- Obywatelstwa -->
<div class="settings-section">
<h3 class="settings-title" data-i18n="settings.citizenships">ğŸŒ Obywatelstwa</h3>
<div class="settings-list" id="citizenships-list">
<!-- Lista obywatelstw bÄ™dzie tutaj -->
</div>
<div class="settings-add-form">
<input class="form-input" id="new-citizenship" placeholder="Nazwa obywatelstwa..." type="text" data-i18n-placeholder="settings.newCitizenship"/>
<button class="btn btn-primary" onclick="addCitizenship()">
<svg fill="none" height="20" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="20">
<line x1="12" x2="12" y1="5" y2="19"></line>
<line x1="5" x2="19" y1="12" y2="12"></line>
</svg>
                            <span data-i18n="buttons.addCitizenship">Dodaj obywatelstwo</span>
                        </button>
</div>
</div>
<!-- Elementy odzieÅ¼y -->
<div class="settings-section">
<h3 class="settings-title" data-i18n="settings.clothingItems">ğŸ‘” Elementy odzieÅ¼y ochronnej</h3>
<div class="settings-list" id="clothing-items-list">
<!-- Lista odzieÅ¼y bÄ™dzie tutaj -->
</div>
<div class="settings-add-form">
<input class="form-input" id="new-clothing-item" placeholder="Nazwa elementu odzieÅ¼y..." type="text" data-i18n-placeholder="settings.newClothingItem"/>
<button class="btn btn-primary" onclick="addClothingItem()">
<svg fill="none" height="20" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="20">
<line x1="12" x2="12" y1="5" y2="19"></line>
<line x1="5" x2="19" y1="12" y2="12"></line>
</svg>
                            <span data-i18n="buttons.addClothingItem">Dodaj element</span>
                        </button>
</div>
</div>
<!-- OdzieÅ¼ na szkolenie - przypisanie do stanowisk -->
<div class="settings-section" style="grid-column: 1 / -1;">
<h3 class="settings-title" data-i18n="settings.trainingClothesMapping">ğŸ“ Przypisanie odzieÅ¼y na szkolenie do stanowisk</h3>
<div class="position-clothes-mapping" id="position-clothes-mapping">
<!-- Mapowanie stanowisk do odzieÅ¼y bÄ™dzie tutaj -->
</div>
</div>
</div>
</div>
</div>
</div>

<!-- Okno modalne dodawania pracownika -->
<div class="modal" id="add-modal">
<div class="modal-content">
<div class="modal-header">
<h2 class="modal-title" data-i18n="modal.addEmployee">Dodaj nowego pracownika</h2>
<button class="close-btn" onclick="closeAddModal()">Ã—</button>
</div>
<form id="add-form" onsubmit="addEmployee(event)">
<div class="form-group">
<label class="form-label" data-i18n="fields.nameLabel">Nazwisko, ImiÄ™</label>
<input class="form-input" name="name" placeholder="KOWALSKI JAN" required="" type="text"/>
</div>
<div class="form-group">
<label class="form-label" data-i18n="fields.positionLabel">Stanowisko</label>
<input class="form-input" list="position-list" name="position" placeholder="Wybierz lub wpisz nowe stanowisko" required="" type="text" data-i18n-placeholder="fields.positionPlaceholder"/>
<datalist id="position-list">
<!-- Opcje bÄ™dÄ… generowane dynamicznie -->
</datalist>
</div>
<div class="form-group">
<label class="form-label" data-i18n="fields.departmentLabel">DziaÅ‚</label>
<select class="form-input" id="department-select" name="department" required="">
<!-- Opcje bÄ™dÄ… generowane dynamicznie -->
</select>
<input class="form-input" id="department-other" name="department-other" placeholder="Wpisz nazwÄ™ dziaÅ‚u" style="display: none; margin-top: 0.5rem;" type="text" data-i18n-placeholder="fields.departmentOther"/>
</div>
<div class="form-group">
<label class="form-label" data-i18n="fields.shiftLabel">Zmiana/Kierownik</label>
<input class="form-input" list="shift-list" name="shift" placeholder="Wybierz lub wpisz" type="text" data-i18n-placeholder="fields.shiftPlaceholder"/>
<datalist id="shift-list">
<!-- Opcje bÄ™dÄ… generowane dynamicznie -->
</datalist>
</div>
<div class="form-group">
<label class="form-label" data-i18n="fields.rcpLabel">RCP</label>
<input class="form-input" name="rcp" placeholder="5286" type="number"/>
</div>
<div class="form-group">
<label class="form-label" data-i18n="fields.citizenshipLabel">Obywatelstwo</label>
<select class="form-input" id="citizenship-select" name="citizenship" required="">
<!-- Opcje bÄ™dÄ… generowane dynamicznie -->
</select>
<input class="form-input" id="citizenship-other" name="citizenship-other" placeholder="Wpisz obywatelstwo" style="display: none; margin-top: 0.5rem;" type="text" data-i18n-placeholder="fields.citizenshipOther"/>
</div>
<div class="form-group">
<label class="form-label" data-i18n="fields.lockerLabel">Szafka</label>
<input class="form-input" list="locker-list" name="locker" placeholder="K92" type="text"/>
<datalist id="locker-list">
<option value="K">
<option value="M">
<option value="Q">
</option></option></option></datalist>
</div>
<div class="form-group">
<label class="form-label" data-i18n="fields.hireDateLabel">Data przyjÄ™cia</label>
<input class="form-input" name="hireDate" type="date" value=""/>
</div>
<div class="form-actions">
<button class="btn" onclick="closeAddModal()" style="background: rgba(255,255,255,0.1); color: white;" type="button" data-i18n="buttons.cancel">Anuluj</button>
<button class="btn btn-primary" type="submit" data-i18n="buttons.addEmployee">Dodaj pracownika</button>
</div>
</form>
</div>
</div>

<!-- Okno modalne dodawania usuniÄ™tego pracownika -->
<div class="modal" id="add-deleted-modal">
<div class="modal-content">
<div class="modal-header">
<h2 class="modal-title" data-i18n="modal.addDeletedEmployee">Dodaj usuniÄ™tego pracownika</h2>
<button class="close-btn" onclick="closeAddDeletedModal()">Ã—</button>
</div>
<form id="add-deleted-form" onsubmit="addDeletedEmployee(event)">
<div class="form-group">
<label class="form-label" data-i18n="fields.nameLabel">Nazwisko, ImiÄ™</label>
<input class="form-input" name="name" placeholder="KOWALSKI JAN" required="" type="text"/>
</div>
<div class="form-group">
<label class="form-label" data-i18n="fields.positionLabel">Stanowisko</label>
<input class="form-input" list="deleted-position-list" name="position" placeholder="Wybierz lub wpisz stanowisko" required="" type="text" data-i18n-placeholder="fields.positionPlaceholder"/>
<datalist id="deleted-position-list">
<!-- Opcje bÄ™dÄ… generowane dynamicznie -->
</datalist>
</div>
<div class="form-group">
<label class="form-label" data-i18n="fields.departmentLabel">DziaÅ‚</label>
<select class="form-input" id="deleted-department-select" name="department" required="">
<!-- Opcje bÄ™dÄ… generowane dynamicznie -->
</select>
</div>
<div class="form-group">
<label class="form-label" data-i18n="fields.shiftLabel">Zmiana/Kierownik</label>
<input class="form-input" list="deleted-shift-list" name="shift" placeholder="Wybierz lub wpisz" type="text" data-i18n-placeholder="fields.shiftPlaceholder"/>
<datalist id="deleted-shift-list">
<!-- Opcje bÄ™dÄ… generowane dynamicznie -->
</datalist>
</div>
<div class="form-group">
<label class="form-label" data-i18n="fields.rcpLabel">RCP</label>
<input class="form-input" name="rcp" placeholder="5286" type="number"/>
</div>
<div class="form-group">
<label class="form-label" data-i18n="fields.citizenshipLabel">Obywatelstwo</label>
<select class="form-input" id="deleted-citizenship-select" name="citizenship" required="">
<!-- Opcje bÄ™dÄ… generowane dynamicznie -->
</select>
</div>
<div class="form-group">
<label class="form-label" data-i18n="fields.deleteDateLabel">Data usuniÄ™cia</label>
<input class="form-input" name="deletedDate" type="date" value="" required/>
</div>
<div class="form-actions">
<button class="btn" onclick="closeAddDeletedModal()" style="background: rgba(255,255,255,0.1); color: white;" type="button" data-i18n="buttons.cancel">Anuluj</button>
<button class="btn btn-primary" type="submit" data-i18n="buttons.addDeletedEmployee">Dodaj usuniÄ™tego pracownika</button>
</div>
</form>
</div>
</div>
<!-- Okno modalne edycji pracownika -->
<div class="modal" id="edit-modal">
<div class="modal-content">
<div class="modal-header">
<h2 class="modal-title" data-i18n="modal.editEmployee">Edytuj pracownika</h2>
<button class="close-btn" onclick="closeEditModal()">Ã—</button>
</div>
<form id="edit-form" onsubmit="saveEmployee(event)">
<input id="edit-employee-id" type="hidden"/>
<div class="form-group">
<label class="form-label" data-i18n="fields.nameLabel">Nazwisko, ImiÄ™</label>
<input class="form-input" id="edit-name" required="" type="text"/>
</div>
<div class="form-group">
<label class="form-label" data-i18n="fields.positionLabel">Stanowisko</label>
<input class="form-input" id="edit-position" list="edit-position-list" required="" type="text"/>
<datalist id="edit-position-list">
<!-- Opcje bÄ™dÄ… generowane dynamicznie -->
</datalist>
</div>
<div class="form-group">
<label class="form-label" data-i18n="fields.departmentLabel">DziaÅ‚</label>
<select class="form-input" id="edit-department" required="">
<!-- Opcje bÄ™dÄ… generowane dynamicznie -->
</select>
<input class="form-input" id="edit-department-other" placeholder="Wpisz nazwÄ™ dziaÅ‚u" style="display: none; margin-top: 0.5rem;" type="text" data-i18n-placeholder="fields.departmentOther"/>
</div>
<div class="form-group">
<label class="form-label" data-i18n="fields.shiftLabel">Zmiana/Kierownik</label>
<input class="form-input" id="edit-shift" list="edit-shift-list" type="text"/>
<datalist id="edit-shift-list">
<!-- Opcje bÄ™dÄ… generowane dynamicznie -->
</datalist>
</div>
<div class="form-group">
<label class="form-label" data-i18n="fields.rcpLabel">RCP</label>
<input class="form-input" id="edit-rcp" type="number"/>
</div>
<div class="form-group">
<label class="form-label" data-i18n="fields.citizenshipLabel">Obywatelstwo</label>
<select class="form-input" id="edit-citizenship" required="">
<!-- Opcje bÄ™dÄ… generowane dynamicznie -->
</select>
<input class="form-input" id="edit-citizenship-other" placeholder="Wpisz obywatelstwo" style="display: none; margin-top: 0.5rem;" type="text" data-i18n-placeholder="fields.citizenshipOther"/>
</div>
<div class="form-group">
<label class="form-label" data-i18n="fields.lockerLabel">Szafka</label>
<input class="form-input" id="edit-locker" list="edit-locker-list" type="text"/>
<datalist id="edit-locker-list">
<option value="K">
<option value="M">
<option value="Q">
</option></option></option></datalist>
</div>
<div class="form-group">
<label class="form-label" data-i18n="fields.hireDateLabel">Data przyjÄ™cia</label>
<input class="form-input" id="edit-hireDate" type="date"/>
</div>
<div class="form-actions">
<button class="btn" onclick="closeEditModal()" style="background: rgba(255,255,255,0.1); color: white;" type="button" data-i18n="buttons.cancel">Anuluj</button>
<button class="btn btn-primary" type="submit" data-i18n="buttons.saveChanges">Zapisz zmiany</button>
</div>
</form>
</div>
</div>
<!-- Okno modalne szczegÃ³Å‚Ã³w dziaÅ‚u -->
<div class="modal" id="dept-modal">
<div class="modal-content">
<div class="modal-header">
<h2 class="modal-title" id="dept-modal-title">SzczegÃ³Å‚y dziaÅ‚u</h2>
<button class="close-btn" onclick="closeDeptModal()">Ã—</button>
</div>
<div id="dept-modal-content">
<!-- SzczegÃ³Å‚y dziaÅ‚u bÄ™dÄ… tutaj -->
</div>
</div>
</div>
<!-- Okno modalne wydawania odzieÅ¼y -->
<div class="modal" id="clothing-issue-modal">
<div class="modal-content">
<div class="modal-header">
<h2 class="modal-title" data-i18n="modal.issueClothing">Wydaj odzieÅ¼ ochronnÄ…</h2>
<button class="close-btn" onclick="closeClothingIssueModal()">Ã—</button>
</div>
<form id="clothing-issue-form" onsubmit="issueClothing(event)">
<div style="background: rgba(255, 255, 255, 0.05); border-radius: 15px; padding: 1rem; margin-bottom: 1.5rem;">
<p style="color: white; margin: 0;">
<strong data-i18n="fields.employee">Pracownik:</strong> <span id="modal-employee-name">-</span><br/>
<strong data-i18n="fields.departmentLabel">DziaÅ‚:</strong> <span id="modal-employee-department">-</span><br/>
<strong data-i18n="fields.positionLabel">Stanowisko:</strong> <span id="modal-employee-position">-</span>
</p>
</div>
<div class="form-group">
<label class="form-label" data-i18n="clothing.issueDate">Data wydania:</label>
<input class="form-input" name="issueDate" required="" type="date"/>
</div>
<div class="form-group">
<label class="form-label" data-i18n="clothing.selectItems">Wybierz wydawane elementy:</label>
<div id="clothing-checkboxes" style="display: grid; gap: 1rem;">
<!-- Checkboxy bÄ™dÄ… generowane dynamicznie -->
</div>
</div>
<div class="form-group">
<label class="form-label" data-i18n="fields.notes">Uwagi (opcjonalne):</label>
<textarea class="form-input" name="notes" placeholder="Dodatkowe informacje..." rows="3" data-i18n-placeholder="fields.notesPlaceholder"></textarea>
</div>
<div class="form-actions">
<button class="btn" onclick="closeClothingIssueModal()" style="background: rgba(255,255,255,0.1); color: white;" type="button" data-i18n="buttons.cancel">Anuluj</button>
<button class="btn btn-primary" type="submit" data-i18n="buttons.issueClothing">Wydaj odzieÅ¼</button>
</div>
</form>
</div>
</div>
<!-- Strefa upuszczania -->
<div class="drop-zone" id="drop-zone">
<div class="drop-zone-content">
<svg fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24">
<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
<polyline points="7 10 12 15 17 10"></polyline>
<line x1="12" x2="12" y1="15" y2="3"></line>
</svg>
<h2 data-i18n="dropzone.title">PrzeciÄ…gnij plik Excel tutaj</h2>
<p data-i18n="dropzone.formats">ObsÅ‚ugiwane formaty .xlsx i .xls</p>
</div>
</div>
<!-- WskaÅºnik auto-zapisu -->
<div class="auto-save-indicator" id="auto-save-indicator">
<svg fill="none" height="16" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="16">
<polyline points="20 6 9 17 4 12"></polyline>
</svg>
<span data-i18n="misc.dataSaved">Dane zapisane</span>
</div>
<!-- Przycisk FAB dla mobilnych -->
<button class="mobile-fab" onclick="showMobileMenu()">
<svg fill="none" height="24" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="24">
<line x1="12" x2="12" y1="5" y2="19"></line>
<line x1="5" x2="19" y1="12" y2="12"></line>
</svg>
</button>
<!-- Pull to refresh -->
<div class="pull-to-refresh" id="pull-to-refresh">
<svg fill="none" height="24" stroke="#6366f1" stroke-width="2" viewbox="0 0 24 24" width="24">
<polyline points="23 4 23 10 17 10"></polyline>
<polyline points="1 20 1 14 7 14"></polyline>
<path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
</svg>
</div>
<!-- WskaÅºnik offline -->
<div class="offline-indicator" id="offline-indicator">
<svg fill="none" height="16" stroke="currentColor" stroke-width="2" style="display: inline-block; vertical-align: middle; margin-right: 0.5rem;" viewbox="0 0 24 24" width="16">
<line x1="1" x2="23" y1="1" y2="23"></line>
<path d="M9 9v3a3 3 0 0 0 5.12 2.12M15 9.34V4a3 3 0 0 0-5.94-.6"></path>
<path d="M17 17.95A7 7 0 0 1 5 12v-2m14 0v2a7 7 0 0 1-.11 1.23"></path>
<line x1="12" x2="12" y1="19" y2="23"></line>
<line x1="8" x2="16" y1="23" y2="23"></line>
</svg>
        <span data-i18n="misc.offline">Brak poÅ‚Ä…czenia z internetem - pracujesz offline</span>
    </div>
<!-- PodpowiedÅº swipe -->
<div class="swipe-hint" id="swipe-hint" data-i18n="misc.swipeHint">
        PrzesuÅ„ w lewo lub prawo aby zmieniÄ‡ zakÅ‚adkÄ™
    </div>
<!-- XLSX Library -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
        // ==============================================
        // TRANSLATIONS
        // ==============================================
        const translations = {
            pl: {
                // Login
                'login.title': 'System HR - Synchronizacja w czasie rzeczywistym',
                'login.email': 'Email',
                'login.password': 'HasÅ‚o',
                'login.signIn': 'Zaloguj siÄ™',
                'login.googleSignIn': 'Zaloguj przez Google',
                'login.register': 'Zarejestruj siÄ™',
                'login.feature1': 'âœ¨ Synchronizacja w czasie rzeczywistym',
                'login.feature2': 'ğŸ“± DziaÅ‚a na wszystkich urzÄ…dzeniach',
                'login.feature3': 'ğŸ”’ Bezpieczne przechowywanie danych',
                
                // Navigation
                'nav.activeEmployees': 'Aktywni pracownicy',
                'nav.deletedEmployees': 'UsuniÄ™ci pracownicy',
                'nav.clothingIssue': 'Wydawanie odzieÅ¼y',
                'nav.trainingClothes': 'OdzieÅ¼ na szkolenie',
                'nav.settings': 'Ustawienia',
                'nav.logout': 'Wyloguj',
                
                // Stats
                'stats.totalEmployees': 'ÅÄ…cznie pracownikÃ³w',
                'stats.departments': 'DziaÅ‚Ã³w',
                'stats.nationalities': 'NarodowoÅ›ci',
                'stats.filteredEmployees': 'PracownikÃ³w po filtrowaniu',
                
                // Info
                'info.uploadExcel': 'ğŸ’¡ Kliknij przycisk "ZaÅ‚aduj Excel" powyÅ¼ej, aby zaimportowaÄ‡ dane z pliku',
                'info.supportedColumns': 'ObsÅ‚ugiwane kolumny: Nazwisko,ImiÄ™ | Stanowisko | DziaÅ‚ | Zmiana | RCP | Obywatelstwo | Szafka | Data przyjÄ™cia',
                
                // Sync
                'sync.title': 'ğŸš€ Synchronizacja w czasie rzeczywistym!',
                'sync.auto': 'âœ… Automatyczna synchronizacja',
                'sync.autoDesc': 'Wszystkie zmiany sÄ… natychmiast synchronizowane miÄ™dzy urzÄ…dzeniami',
                'sync.multi': 'ğŸ“± Multi-urzÄ…dzenie',
                'sync.multiDesc': 'Pracuj na komputerze, tablecie i telefonie jednoczeÅ›nie',
                'sync.security': 'ğŸ”’ BezpieczeÅ„stwo',
                'sync.securityDesc': 'Dane sÄ… bezpiecznie przechowywane w chmurze Firebase',
                'sync.offline': 'âš¡ Praca offline',
                'sync.offlineDesc': 'Aplikacja dziaÅ‚a bez internetu - dane zsynchronizujÄ… siÄ™ po poÅ‚Ä…czeniu',
                'sync.collaboration': 'ğŸ‘¥ WspÃ³Å‚praca',
                'sync.collaborationDesc': 'Zaloguj siÄ™ tym samym kontem na rÃ³Å¼nych urzÄ…dzeniach',
                'sync.firebaseRules': 'ğŸ” WaÅ¼ne! Ustaw reguÅ‚y bezpieczeÅ„stwa w Firebase Console:',
                'sync.changeRules': 'ZmieÅ„ na:',
                'sync.howItWorks': 'Jak to dziaÅ‚a:',
                'sync.step1': '1. WprowadÅº zmiany na dowolnym urzÄ…dzeniu',
                'sync.step2': '2. Dane automatycznie pojawiÄ… siÄ™ na innych urzÄ…dzeniach',
                'sync.step3': '3. Status synchronizacji widoczny w prawym gÃ³rnym rogu (kliknij aby odÅ›wieÅ¼yÄ‡)',
                'sync.step4': '4. Brak potrzeby rÄ™cznego zapisywania!',
                
                // Departments
                'departments.statsTitle': 'ğŸ“Š Statystyki wedÅ‚ug dziaÅ‚Ã³w',
                'departments.distribution': 'RozkÅ‚ad pracownikÃ³w wedÅ‚ug dziaÅ‚Ã³w',
                'departments.employeeCount': 'Liczba pracownikÃ³w:',
                'departments.positions': 'stanowisk',
                
                // Filters
                'filters.byDepartment': 'Filtruj po dziale:',
                'filters.allDepartments': 'Wszystkie dziaÅ‚y',
                'filters.byPosition': 'Filtruj po stanowisku:',
                'filters.allPositions': 'Wszystkie stanowiska',
                'filters.byShift': 'Filtruj po zmianie:',
                'filters.allShifts': 'Wszystkie zmiany',
                
                // Sort
                'sort.byHireDate': 'Sortuj wedÅ‚ug daty przyjÄ™cia:',
                'sort.byDeleteDate': 'Sortuj wedÅ‚ug daty usuniÄ™cia:',
                'sort.newest': 'Najnowsi',
                'sort.oldest': 'Najstarsi',
                
                // Search
                'search.employees': 'Szukaj pracownikÃ³w...',
                
                // Buttons
                'buttons.addEmployee': 'Dodaj pracownika',
                'buttons.loadExcel': 'ZaÅ‚aduj Excel',
                'buttons.exportExcel': 'Eksport Excel',
                'buttons.backupJSON': 'Backup JSON',
                'buttons.sampleExcel': 'PrzykÅ‚ad Excel',
                'buttons.importJSON': 'Import JSON',
                'buttons.clearList': 'WyczyÅ›Ä‡ listÄ™',
                'buttons.cancel': 'Anuluj',
                'buttons.saveChanges': 'Zapisz zmiany',
                'buttons.addDeletedEmployee': 'Dodaj usuniÄ™tego pracownika',
                'buttons.issueClothing': 'Wydaj odzieÅ¼',
                'buttons.printCard': 'Drukuj kartÄ™',
                'buttons.addDepartment': 'Dodaj dziaÅ‚',
                'buttons.addPosition': 'Dodaj stanowisko',
                'buttons.addShift': 'Dodaj zmianÄ™',
                'buttons.addCitizenship': 'Dodaj obywatelstwo',
                'buttons.addClothingItem': 'Dodaj element',
                'buttons.permanentlyDelete': 'UsuÅ„ trwale',
                
                // Table
                'table.name': 'Nazwisko, ImiÄ™',
                'table.position': 'Stanowisko',
                'table.department': 'DziaÅ‚',
                'table.shift': 'Zmiana',
                'table.rcp': 'RCP',
                'table.citizenship': 'Obywatelstwo',
                'table.locker': 'Szafka',
                'table.hireDate': 'Data przyjÄ™cia',
                'table.deleteDate': 'Data usuniÄ™cia',
                'table.actions': 'Akcje',
                'table.editHint': 'ğŸ’¡ WskazÃ³wka: Kliknij na dowolnÄ… komÃ³rkÄ™ w tabeli, aby edytowaÄ‡ dane bezpoÅ›rednio',
                
                // Empty states
                'empty.deletedEmployees': 'Brak usuniÄ™tych pracownikÃ³w',
                
                // Fields
                'fields.nameLabel': 'Nazwisko, ImiÄ™',
                'fields.positionLabel': 'Stanowisko',
                'fields.departmentLabel': 'DziaÅ‚',
                'fields.shiftLabel': 'Zmiana/Kierownik',
                'fields.rcpLabel': 'RCP',
                'fields.citizenshipLabel': 'Obywatelstwo',
                'fields.lockerLabel': 'Szafka',
                'fields.hireDateLabel': 'Data przyjÄ™cia',
                'fields.deleteDateLabel': 'Data usuniÄ™cia',
                'fields.employee': 'Pracownik:',
                'fields.notes': 'Uwagi (opcjonalne):',
                'fields.positionPlaceholder': 'Wybierz lub wpisz stanowisko',
                'fields.shiftPlaceholder': 'Wybierz lub wpisz',
                'fields.departmentOther': 'Wpisz nazwÄ™ dziaÅ‚u',
                'fields.citizenshipOther': 'Wpisz obywatelstwo',
                'fields.notesPlaceholder': 'Dodatkowe informacje...',
                
                // Modals
                'modal.addEmployee': 'Dodaj nowego pracownika',
                'modal.editEmployee': 'Edytuj pracownika',
                'modal.addDeletedEmployee': 'Dodaj usuniÄ™tego pracownika',
                'modal.issueClothing': 'Wydaj odzieÅ¼ ochronnÄ…',
                
                // Clothing
                'clothing.title': 'ğŸ“¦ System wydawania odzieÅ¼y ochronnej',
                'clothing.description': 'Wybierz pracownika z listy aby wydaÄ‡ lub sprawdziÄ‡ historiÄ™ wydanej odzieÅ¼y',
                'clothing.cardTitle': 'Karta wydania odzieÅ¼y ochronnej',
                'clothing.lastIssueDate': 'Ostatnio pobrana odzieÅ¼ dnia:',
                'clothing.lastIssue': 'Ostatnie wydanie:',
                'clothing.history': 'Historia wydanej odzieÅ¼y:',
                'clothing.noHistory': 'Brak historii wydawania',
                'clothing.issueDate': 'Data wydania:',
                'clothing.selectItems': 'Wybierz wydawane elementy:',
                'clothing.issueDateLabel': 'Data wydania:',
                'clothing.issuedItems': 'Wydane elementy:',
                'clothing.notes': 'Uwagi:',
                'clothing.deleteEntry': 'UsuÅ„ wpis',
                
                // Training
                'training.title': 'ğŸ“ OdzieÅ¼ na szkolenie',
                'training.description': 'Wybierz pracownika z listy, aby zobaczyÄ‡ przypisanÄ… odzieÅ¼ na szkolenie dla jego stanowiska',
                'training.cardTitle': 'Karta odzieÅ¼y na szkolenie',
                'training.issuedClothing': 'Wydana odzieÅ¼',
                'training.noClothingAssigned': 'Brak przypisanej odzieÅ¼y na szkolenie dla tego stanowiska.',
                'training.goToSettings': 'PrzejdÅº do ustawieÅ„, aby przypisaÄ‡ odzieÅ¼.',
                
                // Settings
                'settings.title': 'âš™ï¸ ZarzÄ…dzanie listami systemowymi',
                'settings.description': 'Tutaj moÅ¼esz dodawaÄ‡, edytowaÄ‡ i usuwaÄ‡ elementy list uÅ¼ywanych w systemie',
                'settings.departments': 'ğŸ“ DziaÅ‚y',
                'settings.positions': 'ğŸ‘· Stanowiska',
                'settings.shifts': 'ğŸ‘¥ Zmiany/Kierownicy',
                'settings.citizenships': 'ğŸŒ Obywatelstwa',
                'settings.clothingItems': 'ğŸ‘” Elementy odzieÅ¼y ochronnej',
                'settings.trainingClothesMapping': 'ğŸ“ Przypisanie odzieÅ¼y na szkolenie do stanowisk',
                'settings.newDepartment': 'Nazwa nowego dziaÅ‚u...',
                'settings.newPosition': 'Nazwa nowego stanowiska...',
                'settings.newShift': 'Nazwa zmiany lub kierownika...',
                'settings.newCitizenship': 'Nazwa obywatelstwa...',
                'settings.newClothingItem': 'Nazwa elementu odzieÅ¼y...',
                'settings.addClothingToPosition': '+ Dodaj odzieÅ¼',
                'settings.noClothingAssigned': 'Brak przypisanej odzieÅ¼y',
                'settings.clothingItemName': 'Nazwa elementu odzieÅ¼y...',
                
                // Select
                'select.employee': 'Wybierz pracownika...',
                'select.choose': 'Wybierz...',
                'select.other': 'Inne...',
                
                // Signature
                'signature.employee': 'Podpis pracownika:',
                'signature.issuer': 'Podpis wydajÄ…cego:',
                
                // Drop zone
                'dropzone.title': 'PrzeciÄ…gnij plik Excel tutaj',
                'dropzone.formats': 'ObsÅ‚ugiwane formaty .xlsx i .xls',
                
                // Misc
                'misc.dataSaved': 'Dane zapisane',
                'misc.offline': 'Brak poÅ‚Ä…czenia z internetem - pracujesz offline',
                'misc.swipeHint': 'PrzesuÅ„ w lewo lub prawo aby zmieniÄ‡ zakÅ‚adkÄ™',
                'misc.clickToRefresh': 'Kliknij aby odÅ›wieÅ¼yÄ‡',
                
                // Toasts
                'toast.welcome': 'Witaj',
                'toast.loggingIn': 'Logowanie...',
                'toast.loginError': 'BÅ‚Ä…d logowania:',
                'toast.registrationError': 'BÅ‚Ä…d rejestracji:',
                'toast.googleLoginError': 'BÅ‚Ä…d logowania przez Google:',
                'toast.accountCreated': 'Konto utworzone pomyÅ›lnie!',
                'toast.employeeAdded': 'Pracownik dodany pomyÅ›lnie!',
                'toast.employeeUpdated': 'Dane pracownika zaktualizowane!',
                'toast.employeeDeleted': 'Pracownik przeniesiony do usuniÄ™tych',
                'toast.employeeRestored': 'Pracownik przywrÃ³cony!',
                'toast.employeePermanentlyDeleted': 'Pracownik usuniÄ™ty trwale!',
                'toast.dataUpdated': 'Dane zaktualizowane',
                'toast.exported': 'Plik zostaÅ‚ pobrany!',
                'toast.imported': 'Dane zostaÅ‚y zaimportowane pomyÅ›lnie!',
                'toast.selectEmployee': 'Najpierw wybierz pracownika!',
                'toast.clothingIssued': 'OdzieÅ¼ wydana pomyÅ›lnie!',
                'toast.entryDeleted': 'Wpis usuniÄ™ty',
                'toast.added': 'Dodano',
                'toast.updated': 'Zaktualizowano',
                'toast.deleted': 'UsuniÄ™to',
                'toast.enterValue': 'WprowadÅº wartoÅ›Ä‡!',
                'toast.dataSynced': 'Dane zsynchronizowane',
                'toast.syncError': 'BÅ‚Ä…d synchronizacji:',
                'toast.refreshing': 'OdÅ›wieÅ¼anie danych...',
                'toast.dataRefreshed': 'Dane odÅ›wieÅ¼one pomyÅ›lnie!',
                'toast.refreshError': 'BÅ‚Ä…d odÅ›wieÅ¼ania:',
                'toast.loadingFile': 'Wczytywanie pliku Excel...',
                'toast.emptyFile': 'Plik Excel jest pusty lub nieprawidÅ‚owy',
                'toast.importError': 'BÅ‚Ä…d podczas importu pliku Excel:',
                'toast.fileReadError': 'BÅ‚Ä…d odczytu pliku',
                'toast.wrongFormat': 'PrzeciÄ…gnij plik Excel (.xlsx lub .xls)',
                'toast.noValidData': 'Nie znaleziono prawidÅ‚owych danych do importu. SprawdÅº format pliku.',
                'toast.foundEmployees': 'Znaleziono {count} pracownikÃ³w',
                'toast.confirmReplace': 'Znaleziono {count} pracownikÃ³w. Czy chcesz:\n\n1. DodaÄ‡ do istniejÄ…cych (OK)\n2. ZastÄ…piÄ‡ wszystkich (Anuluj i importuj ponownie po wyczyszczeniu)',
                'toast.importedCount': 'Zaimportowano {count} pracownikÃ³w!',
                'toast.listEmpty': 'Lista pracownikÃ³w jest juÅ¼ pusta',
                'toast.confirmDeleteAll': 'Czy na pewno chcesz usunÄ…Ä‡ WSZYSTKICH {count} pracownikÃ³w?\n\nTa operacja:\n- Przeniesie wszystkich pracownikÃ³w do listy usuniÄ™tych\n- WyczyÅ›ci historiÄ™ wydawania odzieÅ¼y\n- Zachowa ustawienia systemu\n\nCzy kontynuowaÄ‡?',
                'toast.finalWarning': 'To ostatnie ostrzeÅ¼enie! Czy NA PEWNO chcesz usunÄ…Ä‡ wszystkich pracownikÃ³w?',
                'toast.allDeleted': 'Wszyscy pracownicy zostali przeniesieni do usuniÄ™tych',
                'toast.loginRequired': 'Musisz byÄ‡ zalogowany',
                'toast.selectAtLeastOne': 'Wybierz przynajmniej jeden element odzieÅ¼y!',
                'toast.confirmDeleteEntry': 'Czy na pewno chcesz usunÄ…Ä‡ ten wpis?',
                'toast.confirmDelete': 'Czy na pewno chcesz usunÄ…Ä‡ tego pracownika?',
                'toast.confirmDeletePermanently': 'Czy na pewno chcesz TRWALE usunÄ…Ä‡ tego pracownika? Ta operacja nie moÅ¼e byÄ‡ cofniÄ™ta!',
                'toast.confirmLogout': 'Czy na pewno chcesz siÄ™ wylogowaÄ‡?',
                'toast.confirmReplaceData': 'Czy na pewno chcesz zastÄ…piÄ‡ wszystkie dane? Ta operacja nie moÅ¼e byÄ‡ cofniÄ™ta!',
                'toast.enterEmail': 'Podaj email:',
                'toast.enterPassword': 'Podaj hasÅ‚o (minimum 6 znakÃ³w):',
                'toast.departmentDetails': 'DziaÅ‚: {department}',
                'toast.confirmDeleteItem': 'Czy na pewno chcesz usunÄ…Ä‡ ten element?',
                'toast.confirmRemoveClothing': 'Czy na pewno chcesz usunÄ…Ä‡ ten element odzieÅ¼y?',
                'toast.addedToPosition': 'Dodano odzieÅ¼ do stanowiska',
                'toast.removedFromPosition': 'UsuniÄ™to odzieÅ¼ ze stanowiska',
                'toast.errorNoField': 'BÅ‚Ä…d: nie znaleziono pola wprowadzania',
            },
            ua: {
                // Login
                'login.title': 'Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° HR - Ğ¡Ğ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ñ–Ğ·Ğ°Ñ†Ñ–Ñ Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼Ñƒ Ñ‡Ğ°ÑÑ–',
                'login.email': 'Email',
                'login.password': 'ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ',
                'login.signIn': 'Ğ£Ğ²Ñ–Ğ¹Ñ‚Ğ¸',
                'login.googleSignIn': 'Ğ£Ğ²Ñ–Ğ¹Ñ‚Ğ¸ Ñ‡ĞµÑ€ĞµĞ· Google',
                'login.register': 'Ğ—Ğ°Ñ€ĞµÑ”ÑÑ‚Ñ€ÑƒĞ²Ğ°Ñ‚Ğ¸ÑÑ',
                'login.feature1': 'âœ¨ Ğ¡Ğ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ñ–Ğ·Ğ°Ñ†Ñ–Ñ Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼Ñƒ Ñ‡Ğ°ÑÑ–',
                'login.feature2': 'ğŸ“± ĞŸÑ€Ğ°Ñ†ÑÑ” Ğ½Ğ° Ğ²ÑÑ–Ñ… Ğ¿Ñ€Ğ¸ÑÑ‚Ñ€Ğ¾ÑÑ…',
                'login.feature3': 'ğŸ”’ Ğ‘ĞµĞ·Ğ¿ĞµÑ‡Ğ½Ğµ Ğ·Ğ±ĞµÑ€Ñ–Ğ³Ğ°Ğ½Ğ½Ñ Ğ´Ğ°Ğ½Ğ¸Ñ…',
                
                // Navigation
                'nav.activeEmployees': 'ĞĞºÑ‚Ğ¸Ğ²Ğ½Ñ– Ğ¿Ñ€Ğ°Ñ†Ñ–Ğ²Ğ½Ğ¸ĞºĞ¸',
                'nav.deletedEmployees': 'Ğ’Ğ¸Ğ´Ğ°Ğ»ĞµĞ½Ñ– Ğ¿Ñ€Ğ°Ñ†Ñ–Ğ²Ğ½Ğ¸ĞºĞ¸',
                'nav.clothingIssue': 'Ğ’Ğ¸Ğ´Ğ°Ñ‡Ğ° Ğ¾Ğ´ÑĞ³Ñƒ',
                'nav.trainingClothes': 'ĞĞ´ÑĞ³ Ğ½Ğ° Ğ½Ğ°Ğ²Ñ‡Ğ°Ğ½Ğ½Ñ',
                'nav.settings': 'ĞĞ°Ğ»Ğ°ÑˆÑ‚ÑƒĞ²Ğ°Ğ½Ğ½Ñ',
                'nav.logout': 'Ğ’Ğ¸Ğ¹Ñ‚Ğ¸',
                
                // Stats
                'stats.totalEmployees': 'Ğ’ÑÑŒĞ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ°Ñ†Ñ–Ğ²Ğ½Ğ¸ĞºÑ–Ğ²',
                'stats.departments': 'Ğ’Ñ–Ğ´Ğ´Ñ–Ğ»Ñ–Ğ²',
                'stats.nationalities': 'ĞĞ°Ñ†Ñ–Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ĞµĞ¹',
                'stats.filteredEmployees': 'ĞŸÑ€Ğ°Ñ†Ñ–Ğ²Ğ½Ğ¸ĞºÑ–Ğ² Ğ¿Ñ–ÑĞ»Ñ Ñ„Ñ–Ğ»ÑŒÑ‚Ñ€ÑƒĞ²Ğ°Ğ½Ğ½Ñ',
                
                // Info
                'info.uploadExcel': 'ğŸ’¡ ĞĞ°Ñ‚Ğ¸ÑĞ½Ñ–Ñ‚ÑŒ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ "Ğ—Ğ°Ğ²Ğ°Ğ½Ñ‚Ğ°Ğ¶Ğ¸Ñ‚Ğ¸ Excel" Ğ²Ğ¸Ñ‰Ğµ, Ñ‰Ğ¾Ğ± Ñ–Ğ¼Ğ¿Ğ¾Ñ€Ñ‚ÑƒĞ²Ğ°Ñ‚Ğ¸ Ğ´Ğ°Ğ½Ñ– Ğ· Ñ„Ğ°Ğ¹Ğ»Ñƒ',
                'info.supportedColumns': 'ĞŸÑ–Ğ´Ñ‚Ñ€Ğ¸Ğ¼ÑƒĞ²Ğ°Ğ½Ñ– ĞºĞ¾Ğ»Ğ¾Ğ½ĞºĞ¸: ĞŸÑ€Ñ–Ğ·Ğ²Ğ¸Ñ‰Ğµ,Ğ†Ğ¼\'Ñ | ĞŸĞ¾ÑĞ°Ğ´Ğ° | Ğ’Ñ–Ğ´Ğ´Ñ–Ğ» | Ğ—Ğ¼Ñ–Ğ½Ğ° | RCP | Ğ“Ñ€Ğ¾Ğ¼Ğ°Ğ´ÑĞ½ÑÑ‚Ğ²Ğ¾ | Ğ¨Ğ°Ñ„ĞºĞ° | Ğ”Ğ°Ñ‚Ğ° Ğ¿Ñ€Ğ¸Ğ¹Ğ½ÑÑ‚Ñ‚Ñ',
                
                // Sync
                'sync.title': 'ğŸš€ Ğ¡Ğ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ñ–Ğ·Ğ°Ñ†Ñ–Ñ Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼Ñƒ Ñ‡Ğ°ÑÑ–!',
                'sync.auto': 'âœ… ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡Ğ½Ğ° ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ñ–Ğ·Ğ°Ñ†Ñ–Ñ',
                'sync.autoDesc': 'Ğ’ÑÑ– Ğ·Ğ¼Ñ–Ğ½Ğ¸ Ğ½ĞµĞ³Ğ°Ğ¹Ğ½Ğ¾ ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ñ–Ğ·ÑƒÑÑ‚ÑŒÑÑ Ğ¼Ñ–Ğ¶ Ğ¿Ñ€Ğ¸ÑÑ‚Ñ€Ğ¾ÑĞ¼Ğ¸',
                'sync.multi': 'ğŸ“± ĞœÑƒĞ»ÑŒÑ‚Ğ¸-Ğ¿Ñ€Ğ¸ÑÑ‚Ñ€Ñ–Ğ¹',
                'sync.multiDesc': 'ĞŸÑ€Ğ°Ñ†ÑĞ¹Ñ‚Ğµ Ğ½Ğ° ĞºĞ¾Ğ¼Ğ¿\'ÑÑ‚ĞµÑ€Ñ–, Ğ¿Ğ»Ğ°Ğ½ÑˆĞµÑ‚Ñ– Ñ‚Ğ° Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½Ñ– Ğ¾Ğ´Ğ½Ğ¾Ñ‡Ğ°ÑĞ½Ğ¾',
                'sync.security': 'ğŸ”’ Ğ‘ĞµĞ·Ğ¿ĞµĞºĞ°',
                'sync.securityDesc': 'Ğ”Ğ°Ğ½Ñ– Ğ±ĞµĞ·Ğ¿ĞµÑ‡Ğ½Ğ¾ Ğ·Ğ±ĞµÑ€Ñ–Ğ³Ğ°ÑÑ‚ÑŒÑÑ Ğ² Ñ…Ğ¼Ğ°Ñ€Ñ– Firebase',
                'sync.offline': 'âš¡ Ğ Ğ¾Ğ±Ğ¾Ñ‚Ğ° Ğ¾Ñ„Ğ»Ğ°Ğ¹Ğ½',
                'sync.offlineDesc': 'Ğ”Ğ¾Ğ´Ğ°Ñ‚Ğ¾Ğº Ğ¿Ñ€Ğ°Ñ†ÑÑ” Ğ±ĞµĞ· Ñ–Ğ½Ñ‚ĞµÑ€Ğ½ĞµÑ‚Ñƒ - Ğ´Ğ°Ğ½Ñ– ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ñ–Ğ·ÑƒÑÑ‚ÑŒÑÑ Ğ¿Ñ–ÑĞ»Ñ Ğ¿Ñ–Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ½Ñ',
                'sync.collaboration': 'ğŸ‘¥ Ğ¡Ğ¿Ñ–Ğ²Ğ¿Ñ€Ğ°Ñ†Ñ',
                'sync.collaborationDesc': 'Ğ£Ğ²Ñ–Ğ¹Ğ´Ñ–Ñ‚ÑŒ Ğ· Ğ¾Ğ´Ğ½Ğ¸Ğ¼ Ğ¾Ğ±Ğ»Ñ–ĞºĞ¾Ğ²Ğ¸Ğ¼ Ğ·Ğ°Ğ¿Ğ¸ÑĞ¾Ğ¼ Ğ½Ğ° Ñ€Ñ–Ğ·Ğ½Ğ¸Ñ… Ğ¿Ñ€Ğ¸ÑÑ‚Ñ€Ğ¾ÑÑ…',
                'sync.firebaseRules': 'ğŸ” Ğ’Ğ°Ğ¶Ğ»Ğ¸Ğ²Ğ¾! Ğ’ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ñ–Ñ‚ÑŒ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ° Ğ±ĞµĞ·Ğ¿ĞµĞºĞ¸ Ğ² Firebase Console:',
                'sync.changeRules': 'Ğ—Ğ¼Ñ–Ğ½Ğ¸Ñ‚Ğ¸ Ğ½Ğ°:',
                'sync.howItWorks': 'Ğ¯Ğº Ñ†Ğµ Ğ¿Ñ€Ğ°Ñ†ÑÑ”:',
                'sync.step1': '1. Ğ’Ğ½ĞµÑÑ–Ñ‚ÑŒ Ğ·Ğ¼Ñ–Ğ½Ğ¸ Ğ½Ğ° Ğ±ÑƒĞ´ÑŒ-ÑĞºĞ¾Ğ¼Ñƒ Ğ¿Ñ€Ğ¸ÑÑ‚Ñ€Ğ¾Ñ—',
                'sync.step2': '2. Ğ”Ğ°Ğ½Ñ– Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡Ğ½Ğ¾ Ğ·\'ÑĞ²Ğ»ÑÑ‚ÑŒÑÑ Ğ½Ğ° Ñ–Ğ½ÑˆĞ¸Ñ… Ğ¿Ñ€Ğ¸ÑÑ‚Ñ€Ğ¾ÑÑ…',
                'sync.step3': '3. Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ñ–Ğ·Ğ°Ñ†Ñ–Ñ— Ğ²Ğ¸Ğ´Ğ½Ğ¾ Ğ² Ğ¿Ñ€Ğ°Ğ²Ğ¾Ğ¼Ñƒ Ğ²ĞµÑ€Ñ…Ğ½ÑŒĞ¾Ğ¼Ñƒ ĞºÑƒÑ‚Ñ– (Ğ½Ğ°Ñ‚Ğ¸ÑĞ½Ñ–Ñ‚ÑŒ Ğ´Ğ»Ñ Ğ¾Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ)',
                'sync.step4': '4. ĞĞµĞ¼Ğ°Ñ” Ğ¿Ğ¾Ñ‚Ñ€ĞµĞ±Ğ¸ Ğ² Ñ€ÑƒÑ‡Ğ½Ğ¾Ğ¼Ñƒ Ğ·Ğ±ĞµÑ€ĞµĞ¶ĞµĞ½Ğ½Ñ–!',
                
                // Departments
                'departments.statsTitle': 'ğŸ“Š Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ·Ğ° Ğ²Ñ–Ğ´Ğ´Ñ–Ğ»Ğ°Ğ¼Ğ¸',
                'departments.distribution': 'Ğ Ğ¾Ğ·Ğ¿Ğ¾Ğ´Ñ–Ğ» Ğ¿Ñ€Ğ°Ñ†Ñ–Ğ²Ğ½Ğ¸ĞºÑ–Ğ² Ğ·Ğ° Ğ²Ñ–Ğ´Ğ´Ñ–Ğ»Ğ°Ğ¼Ğ¸',
                'departments.employeeCount': 'ĞšÑ–Ğ»ÑŒĞºÑ–ÑÑ‚ÑŒ Ğ¿Ñ€Ğ°Ñ†Ñ–Ğ²Ğ½Ğ¸ĞºÑ–Ğ²:',
                'departments.positions': 'Ğ¿Ğ¾ÑĞ°Ğ´',
                
                // Filters
                'filters.byDepartment': 'Ğ¤Ñ–Ğ»ÑŒÑ‚Ñ€ÑƒĞ²Ğ°Ñ‚Ğ¸ Ğ·Ğ° Ğ²Ñ–Ğ´Ğ´Ñ–Ğ»Ğ¾Ğ¼:',
                'filters.allDepartments': 'Ğ’ÑÑ– Ğ²Ñ–Ğ´Ğ´Ñ–Ğ»Ğ¸',
                'filters.byPosition': 'Ğ¤Ñ–Ğ»ÑŒÑ‚Ñ€ÑƒĞ²Ğ°Ñ‚Ğ¸ Ğ·Ğ° Ğ¿Ğ¾ÑĞ°Ğ´Ğ¾Ñ:',
                'filters.allPositions': 'Ğ’ÑÑ– Ğ¿Ğ¾ÑĞ°Ğ´Ğ¸',
                'filters.byShift': 'Ğ¤Ñ–Ğ»ÑŒÑ‚Ñ€ÑƒĞ²Ğ°Ñ‚Ğ¸ Ğ·Ğ° Ğ·Ğ¼Ñ–Ğ½Ğ¾Ñ:',
                'filters.allShifts': 'Ğ’ÑÑ– Ğ·Ğ¼Ñ–Ğ½Ğ¸',
                
                // Sort
                'sort.byHireDate': 'Ğ¡Ğ¾Ñ€Ñ‚ÑƒĞ²Ğ°Ñ‚Ğ¸ Ğ·Ğ° Ğ´Ğ°Ñ‚Ğ¾Ñ Ğ¿Ñ€Ğ¸Ğ¹Ğ½ÑÑ‚Ñ‚Ñ:',
                'sort.byDeleteDate': 'Ğ¡Ğ¾Ñ€Ñ‚ÑƒĞ²Ğ°Ñ‚Ğ¸ Ğ·Ğ° Ğ´Ğ°Ñ‚Ğ¾Ñ Ğ²Ğ¸Ğ´Ğ°Ğ»ĞµĞ½Ğ½Ñ:',
                'sort.newest': 'ĞĞ°Ğ¹Ğ½Ğ¾Ğ²Ñ–ÑˆÑ–',
                'sort.oldest': 'ĞĞ°Ğ¹ÑÑ‚Ğ°Ñ€Ñ–ÑˆÑ–',
                
                // Search
                'search.employees': 'Ğ¨ÑƒĞºĞ°Ñ‚Ğ¸ Ğ¿Ñ€Ğ°Ñ†Ñ–Ğ²Ğ½Ğ¸ĞºÑ–Ğ²...',
                
                // Buttons
                'buttons.addEmployee': 'Ğ”Ğ¾Ğ´Ğ°Ñ‚Ğ¸ Ğ¿Ñ€Ğ°Ñ†Ñ–Ğ²Ğ½Ğ¸ĞºĞ°',
                'buttons.loadExcel': 'Ğ—Ğ°Ğ²Ğ°Ğ½Ñ‚Ğ°Ğ¶Ğ¸Ñ‚Ğ¸ Excel',
                'buttons.exportExcel': 'Ğ•ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Excel',
                'buttons.backupJSON': 'Ğ ĞµĞ·ĞµÑ€Ğ²Ğ½Ğµ ĞºĞ¾Ğ¿Ñ–ÑĞ²Ğ°Ğ½Ğ½Ñ JSON',
                'buttons.sampleExcel': 'ĞŸÑ€Ğ¸ĞºĞ»Ğ°Ğ´ Excel',
                'buttons.importJSON': 'Ğ†Ğ¼Ğ¿Ğ¾Ñ€Ñ‚ JSON',
                'buttons.clearList': 'ĞÑ‡Ğ¸ÑÑ‚Ğ¸Ñ‚Ğ¸ ÑĞ¿Ğ¸ÑĞ¾Ğº',
                'buttons.cancel': 'Ğ¡ĞºĞ°ÑÑƒĞ²Ğ°Ñ‚Ğ¸',
                'buttons.saveChanges': 'Ğ—Ğ±ĞµÑ€ĞµĞ³Ñ‚Ğ¸ Ğ·Ğ¼Ñ–Ğ½Ğ¸',
                'buttons.addDeletedEmployee': 'Ğ”Ğ¾Ğ´Ğ°Ñ‚Ğ¸ Ğ²Ğ¸Ğ´Ğ°Ğ»ĞµĞ½Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ°Ñ†Ñ–Ğ²Ğ½Ğ¸ĞºĞ°',
                'buttons.issueClothing': 'Ğ’Ğ¸Ğ´Ğ°Ñ‚Ğ¸ Ğ¾Ğ´ÑĞ³',
                'buttons.printCard': 'Ğ”Ñ€ÑƒĞºÑƒĞ²Ğ°Ñ‚Ğ¸ ĞºĞ°Ñ€Ñ‚ĞºÑƒ',
                'buttons.addDepartment': 'Ğ”Ğ¾Ğ´Ğ°Ñ‚Ğ¸ Ğ²Ñ–Ğ´Ğ´Ñ–Ğ»',
                'buttons.addPosition': 'Ğ”Ğ¾Ğ´Ğ°Ñ‚Ğ¸ Ğ¿Ğ¾ÑĞ°Ğ´Ñƒ',
                'buttons.addShift': 'Ğ”Ğ¾Ğ´Ğ°Ñ‚Ğ¸ Ğ·Ğ¼Ñ–Ğ½Ñƒ',
                'buttons.addCitizenship': 'Ğ”Ğ¾Ğ´Ğ°Ñ‚Ğ¸ Ğ³Ñ€Ğ¾Ğ¼Ğ°Ğ´ÑĞ½ÑÑ‚Ğ²Ğ¾',
                'buttons.addClothingItem': 'Ğ”Ğ¾Ğ´Ğ°Ñ‚Ğ¸ ĞµĞ»ĞµĞ¼ĞµĞ½Ñ‚',
                'buttons.permanentlyDelete': 'Ğ’Ğ¸Ğ´Ğ°Ğ»Ğ¸Ñ‚Ğ¸ Ğ½Ğ°Ğ·Ğ°Ğ²Ğ¶Ğ´Ğ¸',
                
                // Table
                'table.name': 'ĞŸÑ€Ñ–Ğ·Ğ²Ğ¸Ñ‰Ğµ, Ğ†Ğ¼\'Ñ',
                'table.position': 'ĞŸĞ¾ÑĞ°Ğ´Ğ°',
                'table.department': 'Ğ’Ñ–Ğ´Ğ´Ñ–Ğ»',
                'table.shift': 'Ğ—Ğ¼Ñ–Ğ½Ğ°',
                'table.rcp': 'RCP',
                'table.citizenship': 'Ğ“Ñ€Ğ¾Ğ¼Ğ°Ğ´ÑĞ½ÑÑ‚Ğ²Ğ¾',
                'table.locker': 'Ğ¨Ğ°Ñ„ĞºĞ°',
                'table.hireDate': 'Ğ”Ğ°Ñ‚Ğ° Ğ¿Ñ€Ğ¸Ğ¹Ğ½ÑÑ‚Ñ‚Ñ',
                'table.deleteDate': 'Ğ”Ğ°Ñ‚Ğ° Ğ²Ğ¸Ğ´Ğ°Ğ»ĞµĞ½Ğ½Ñ',
                'table.actions': 'Ğ”Ñ–Ñ—',
                'table.editHint': 'ğŸ’¡ ĞŸÑ–Ğ´ĞºĞ°Ğ·ĞºĞ°: ĞšĞ»Ğ°Ñ†Ğ½Ñ–Ñ‚ÑŒ Ğ½Ğ° Ğ±ÑƒĞ´ÑŒ-ÑĞºÑƒ ĞºĞ¾Ğ¼Ñ–Ñ€ĞºÑƒ Ğ² Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ–, Ñ‰Ğ¾Ğ± Ñ€ĞµĞ´Ğ°Ğ³ÑƒĞ²Ğ°Ñ‚Ğ¸ Ğ´Ğ°Ğ½Ñ– Ğ±ĞµĞ·Ğ¿Ğ¾ÑĞµÑ€ĞµĞ´Ğ½ÑŒĞ¾',
                
                // Empty states
                'empty.deletedEmployees': 'ĞĞµĞ¼Ğ°Ñ” Ğ²Ğ¸Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ñ… Ğ¿Ñ€Ğ°Ñ†Ñ–Ğ²Ğ½Ğ¸ĞºÑ–Ğ²',
                
                // Fields
                'fields.nameLabel': 'ĞŸÑ€Ñ–Ğ·Ğ²Ğ¸Ñ‰Ğµ, Ğ†Ğ¼\'Ñ',
                'fields.positionLabel': 'ĞŸĞ¾ÑĞ°Ğ´Ğ°',
                'fields.departmentLabel': 'Ğ’Ñ–Ğ´Ğ´Ñ–Ğ»',
                'fields.shiftLabel': 'Ğ—Ğ¼Ñ–Ğ½Ğ°/ĞšĞµÑ€Ñ–Ğ²Ğ½Ğ¸Ğº',
                'fields.rcpLabel': 'RCP',
                'fields.citizenshipLabel': 'Ğ“Ñ€Ğ¾Ğ¼Ğ°Ğ´ÑĞ½ÑÑ‚Ğ²Ğ¾',
                'fields.lockerLabel': 'Ğ¨Ğ°Ñ„ĞºĞ°',
                'fields.hireDateLabel': 'Ğ”Ğ°Ñ‚Ğ° Ğ¿Ñ€Ğ¸Ğ¹Ğ½ÑÑ‚Ñ‚Ñ',
                'fields.deleteDateLabel': 'Ğ”Ğ°Ñ‚Ğ° Ğ²Ğ¸Ğ´Ğ°Ğ»ĞµĞ½Ğ½Ñ',
                'fields.employee': 'ĞŸÑ€Ğ°Ñ†Ñ–Ğ²Ğ½Ğ¸Ğº:',
                'fields.notes': 'ĞŸÑ€Ğ¸Ğ¼Ñ–Ñ‚ĞºĞ¸ (Ğ½ĞµĞ¾Ğ±Ğ¾Ğ²\'ÑĞ·ĞºĞ¾Ğ²Ğ¾):',
                'fields.positionPlaceholder': 'Ğ’Ğ¸Ğ±ĞµÑ€Ñ–Ñ‚ÑŒ Ğ°Ğ±Ğ¾ Ğ²Ğ²ĞµĞ´Ñ–Ñ‚ÑŒ Ğ¿Ğ¾ÑĞ°Ğ´Ñƒ',
                'fields.shiftPlaceholder': 'Ğ’Ğ¸Ğ±ĞµÑ€Ñ–Ñ‚ÑŒ Ğ°Ğ±Ğ¾ Ğ²Ğ²ĞµĞ´Ñ–Ñ‚ÑŒ',
                'fields.departmentOther': 'Ğ’Ğ²ĞµĞ´Ñ–Ñ‚ÑŒ Ğ½Ğ°Ğ·Ğ²Ñƒ Ğ²Ñ–Ğ´Ğ´Ñ–Ğ»Ñƒ',
                'fields.citizenshipOther': 'Ğ’Ğ²ĞµĞ´Ñ–Ñ‚ÑŒ Ğ³Ñ€Ğ¾Ğ¼Ğ°Ğ´ÑĞ½ÑÑ‚Ğ²Ğ¾',
                'fields.notesPlaceholder': 'Ğ”Ğ¾Ğ´Ğ°Ñ‚ĞºĞ¾Ğ²Ğ° Ñ–Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ñ–Ñ...',
                
                // Select
                'select.employee': 'Ğ’Ğ¸Ğ±ĞµÑ€Ñ–Ñ‚ÑŒ Ğ¿Ñ€Ğ°Ñ†Ñ–Ğ²Ğ½Ğ¸ĞºĞ°...',
                'select.choose': 'Ğ’Ğ¸Ğ±ĞµÑ€Ñ–Ñ‚ÑŒ...',
                'select.other': 'Ğ†Ğ½ÑˆĞµ...',
                
                // Toasts
                'toast.welcome': 'Ğ›Ğ°ÑĞºĞ°Ğ²Ğ¾ Ğ¿Ñ€Ğ¾ÑĞ¸Ğ¼Ğ¾',
                'toast.employeeAdded': 'ĞŸÑ€Ğ°Ñ†Ñ–Ğ²Ğ½Ğ¸ĞºĞ° Ğ´Ğ¾Ğ´Ğ°Ğ½Ğ¾ ÑƒÑĞ¿Ñ–ÑˆĞ½Ğ¾!',
                'toast.employeeUpdated': 'Ğ”Ğ°Ğ½Ñ– Ğ¿Ñ€Ğ°Ñ†Ñ–Ğ²Ğ½Ğ¸ĞºĞ° Ğ¾Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¾!',
                'toast.employeeDeleted': 'ĞŸÑ€Ğ°Ñ†Ñ–Ğ²Ğ½Ğ¸ĞºĞ° Ğ¿ĞµÑ€ĞµĞ¼Ñ–Ñ‰ĞµĞ½Ğ¾ Ğ´Ğ¾ Ğ²Ğ¸Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ñ…',
                'toast.employeeRestored': 'ĞŸÑ€Ğ°Ñ†Ñ–Ğ²Ğ½Ğ¸ĞºĞ° Ğ²Ñ–Ğ´Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¾!',
                'toast.employeePermanentlyDeleted': 'ĞŸÑ€Ğ°Ñ†Ñ–Ğ²Ğ½Ğ¸ĞºĞ° Ğ²Ğ¸Ğ´Ğ°Ğ»ĞµĞ½Ğ¾ Ğ½Ğ°Ğ·Ğ°Ğ²Ğ¶Ğ´Ğ¸!',
                'toast.selectEmployee': 'Ğ¡Ğ¿Ğ¾Ñ‡Ğ°Ñ‚ĞºÑƒ Ğ²Ğ¸Ğ±ĞµÑ€Ñ–Ñ‚ÑŒ Ğ¿Ñ€Ğ°Ñ†Ñ–Ğ²Ğ½Ğ¸ĞºĞ°!',
                'toast.clothingIssued': 'ĞĞ´ÑĞ³ Ğ²Ğ¸Ğ´Ğ°Ğ½Ğ¾ ÑƒÑĞ¿Ñ–ÑˆĞ½Ğ¾!',
                'toast.confirmDeletePermanently': 'Ğ’Ğ¸ Ğ²Ğ¿ĞµĞ²Ğ½ĞµĞ½Ñ–, Ñ‰Ğ¾ Ñ…Ğ¾Ñ‡ĞµÑ‚Ğµ ĞĞĞ—ĞĞ’Ğ–Ğ”Ğ˜ Ğ²Ğ¸Ğ´Ğ°Ğ»Ğ¸Ñ‚Ğ¸ Ñ†ÑŒĞ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ°Ñ†Ñ–Ğ²Ğ½Ğ¸ĞºĞ°? Ğ¦Ñ Ğ´Ñ–Ñ Ğ½Ğµ Ğ¼Ğ¾Ğ¶Ğ½Ğ° ÑĞºĞ°ÑÑƒĞ²Ğ°Ñ‚Ğ¸!',
                'toast.allDeleted': 'Ğ£ÑÑ–Ñ… Ğ¿Ñ€Ğ°Ñ†Ñ–Ğ²Ğ½Ğ¸ĞºÑ–Ğ² Ğ¿ĞµÑ€ĞµĞ¼Ñ–Ñ‰ĞµĞ½Ğ¾ Ğ´Ğ¾ Ğ²Ğ¸Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ñ…',
            },
            en: {
                // Login
                'login.title': 'HR System - Real-time Synchronization',
                'login.email': 'Email',
                'login.password': 'Password',
                'login.signIn': 'Sign In',
                'login.googleSignIn': 'Sign in with Google',
                'login.register': 'Register',
                'login.feature1': 'âœ¨ Real-time synchronization',
                'login.feature2': 'ğŸ“± Works on all devices',
                'login.feature3': 'ğŸ”’ Secure data storage',
                
                // Navigation
                'nav.activeEmployees': 'Active Employees',
                'nav.deletedEmployees': 'Deleted Employees',
                'nav.clothingIssue': 'Clothing Issue',
                'nav.trainingClothes': 'Training Clothes',
                'nav.settings': 'Settings',
                'nav.logout': 'Logout',
                
                // Stats
                'stats.totalEmployees': 'Total Employees',
                'stats.departments': 'Departments',
                'stats.nationalities': 'Nationalities',
                'stats.filteredEmployees': 'Filtered Employees',
                
                // Info
                'info.uploadExcel': 'ğŸ’¡ Click the "Load Excel" button above to import data from a file',
                'info.supportedColumns': 'Supported columns: Last Name,First Name | Position | Department | Shift | RCP | Citizenship | Locker | Hire Date',
                
                // Sync
                'sync.title': 'ğŸš€ Real-time synchronization!',
                'sync.auto': 'âœ… Automatic synchronization',
                'sync.autoDesc': 'All changes are immediately synchronized between devices',
                'sync.multi': 'ğŸ“± Multi-device',
                'sync.multiDesc': 'Work on computer, tablet and phone simultaneously',
                'sync.security': 'ğŸ”’ Security',
                'sync.securityDesc': 'Data is securely stored in Firebase cloud',
                'sync.offline': 'âš¡ Offline work',
                'sync.offlineDesc': 'App works without internet - data will sync when connected',
                'sync.collaboration': 'ğŸ‘¥ Collaboration',
                'sync.collaborationDesc': 'Log in with the same account on different devices',
                'sync.firebaseRules': 'ğŸ” Important! Set security rules in Firebase Console:',
                'sync.changeRules': 'Change to:',
                'sync.howItWorks': 'How it works:',
                'sync.step1': '1. Make changes on any device',
                'sync.step2': '2. Data will automatically appear on other devices',
                'sync.step3': '3. Sync status visible in top right corner (click to refresh)',
                'sync.step4': '4. No need for manual saving!',
                
                // Departments
                'departments.statsTitle': 'ğŸ“Š Statistics by departments',
                'departments.distribution': 'Employee distribution by departments',
                'departments.employeeCount': 'Employee count:',
                'departments.positions': 'positions',
                
                // Filters
                'filters.byDepartment': 'Filter by department:',
                'filters.allDepartments': 'All departments',
                'filters.byPosition': 'Filter by position:',
                'filters.allPositions': 'All positions',
                'filters.byShift': 'Filter by shift:',
                'filters.allShifts': 'All shifts',
                
                // Sort
                'sort.byHireDate': 'Sort by hire date:',
                'sort.byDeleteDate': 'Sort by delete date:',
                'sort.newest': 'Newest',
                'sort.oldest': 'Oldest',
                
                // Search
                'search.employees': 'Search employees...',
                
                // Buttons
                'buttons.addEmployee': 'Add Employee',
                'buttons.loadExcel': 'Load Excel',
                'buttons.exportExcel': 'Export Excel',
                'buttons.backupJSON': 'Backup JSON',
                'buttons.sampleExcel': 'Sample Excel',
                'buttons.importJSON': 'Import JSON',
                'buttons.clearList': 'Clear List',
                'buttons.cancel': 'Cancel',
                'buttons.saveChanges': 'Save Changes',
                'buttons.addDeletedEmployee': 'Add Deleted Employee',
                'buttons.issueClothing': 'Issue Clothing',
                'buttons.printCard': 'Print Card',
                'buttons.addDepartment': 'Add Department',
                'buttons.addPosition': 'Add Position',
                'buttons.addShift': 'Add Shift',
                'buttons.addCitizenship': 'Add Citizenship',
                'buttons.addClothingItem': 'Add Item',
                'buttons.permanentlyDelete': 'Delete Permanently',
                
                // Table
                'table.name': 'Last Name, First Name',
                'table.position': 'Position',
                'table.department': 'Department',
                'table.shift': 'Shift',
                'table.rcp': 'RCP',
                'table.citizenship': 'Citizenship',
                'table.locker': 'Locker',
                'table.hireDate': 'Hire Date',
                'table.deleteDate': 'Delete Date',
                'table.actions': 'Actions',
                'table.editHint': 'ğŸ’¡ Tip: Click on any cell in the table to edit data directly',
                
                // Empty states
                'empty.deletedEmployees': 'No deleted employees',
                
                // Select
                'select.employee': 'Select employee...',
                'select.choose': 'Choose...',
                'select.other': 'Other...',
                
                // Toasts
                'toast.welcome': 'Welcome',
                'toast.employeeAdded': 'Employee added successfully!',
                'toast.employeeUpdated': 'Employee data updated!',
                'toast.employeeDeleted': 'Employee moved to deleted',
                'toast.employeeRestored': 'Employee restored!',
                'toast.employeePermanentlyDeleted': 'Employee permanently deleted!',
                'toast.selectEmployee': 'Please select an employee first!',
                'toast.clothingIssued': 'Clothing issued successfully!',
                'toast.confirmDeletePermanently': 'Are you sure you want to PERMANENTLY delete this employee? This action cannot be undone!',
                'toast.allDeleted': 'All employees have been moved to deleted',
            },
            es: {
                // Login
                'login.title': 'Sistema HR - SincronizaciÃ³n en tiempo real',
                'login.email': 'Correo electrÃ³nico',
                'login.password': 'ContraseÃ±a',
                'login.signIn': 'Iniciar sesiÃ³n',
                'login.googleSignIn': 'Iniciar sesiÃ³n con Google',
                'login.register': 'Registrarse',
                'login.feature1': 'âœ¨ SincronizaciÃ³n en tiempo real',
                'login.feature2': 'ğŸ“± Funciona en todos los dispositivos',
                'login.feature3': 'ğŸ”’ Almacenamiento seguro de datos',
                
                // Navigation
                'nav.activeEmployees': 'Empleados Activos',
                'nav.deletedEmployees': 'Empleados Eliminados',
                'nav.clothingIssue': 'Entrega de Ropa',
                'nav.trainingClothes': 'Ropa de Entrenamiento',
                'nav.settings': 'ConfiguraciÃ³n',
                'nav.logout': 'Cerrar sesiÃ³n',
                
                // Stats
                'stats.totalEmployees': 'Total de Empleados',
                'stats.departments': 'Departamentos',
                'stats.nationalities': 'Nacionalidades',
                'stats.filteredEmployees': 'Empleados Filtrados',
                
                // Buttons
                'buttons.addEmployee': 'Agregar Empleado',
                'buttons.loadExcel': 'Cargar Excel',
                'buttons.exportExcel': 'Exportar Excel',
                'buttons.backupJSON': 'Copia de seguridad JSON',
                'buttons.sampleExcel': 'Excel de muestra',
                'buttons.importJSON': 'Importar JSON',
                'buttons.clearList': 'Limpiar Lista',
                'buttons.cancel': 'Cancelar',
                'buttons.saveChanges': 'Guardar Cambios',
                'buttons.addDeletedEmployee': 'Agregar Empleado Eliminado',
                'buttons.issueClothing': 'Entregar Ropa',
                'buttons.printCard': 'Imprimir Tarjeta',
                'buttons.addDepartment': 'Agregar Departamento',
                'buttons.addPosition': 'Agregar PosiciÃ³n',
                'buttons.addShift': 'Agregar Turno',
                'buttons.addCitizenship': 'Agregar CiudadanÃ­a',
                'buttons.addClothingItem': 'Agregar Elemento',
                'buttons.permanentlyDelete': 'Eliminar Permanentemente',
                
                // Table
                'table.name': 'Apellido, Nombre',
                'table.position': 'PosiciÃ³n',
                'table.department': 'Departamento',
                'table.shift': 'Turno',
                'table.rcp': 'RCP',
                'table.citizenship': 'CiudadanÃ­a',
                'table.locker': 'Casillero',
                'table.hireDate': 'Fecha de ContrataciÃ³n',
                'table.deleteDate': 'Fecha de EliminaciÃ³n',
                'table.actions': 'Acciones',
                
                // Select
                'select.employee': 'Seleccionar empleado...',
                'select.choose': 'Elegir...',
                'select.other': 'Otro...',
                
                // Toasts
                'toast.welcome': 'Bienvenido',
                'toast.employeeAdded': 'Â¡Empleado agregado con Ã©xito!',
                'toast.employeeUpdated': 'Â¡Datos del empleado actualizados!',
                'toast.employeeDeleted': 'Empleado movido a eliminados',
                'toast.employeeRestored': 'Â¡Empleado restaurado!',
                'toast.employeePermanentlyDeleted': 'Â¡Empleado eliminado permanentemente!',
                'toast.selectEmployee': 'Â¡Primero seleccione un empleado!',
                'toast.clothingIssued': 'Â¡Ropa entregada con Ã©xito!',
                'toast.confirmDeletePermanently': 'Â¿EstÃ¡ seguro de que desea eliminar PERMANENTEMENTE este empleado? Â¡Esta acciÃ³n no se puede deshacer!',
                'toast.allDeleted': 'Todos los empleados han sido movidos a eliminados',
            }
        };
        
        let currentLanguage = localStorage.getItem('appLanguage') || 'pl';
        
        // Function to change language
        function changeLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('appLanguage', lang);
            
            // Update language buttons
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
            
            // Update all translations
            updateTranslations();
            
            // Update dynamic content
            renderEmployees();
            renderDeletedEmployees();
            updateDropdowns();
            updateStats();
            renderSettingsLists();
            
            // Update sync status tooltip
            const syncStatus = document.getElementById('sync-status');
            if (syncStatus) {
                syncStatus.setAttribute('data-tooltip', i18n('misc.clickToRefresh'));
            }
        }
        
        // Function to get translation
        function i18n(key) {
            return translations[currentLanguage][key] || translations['pl'][key] || key;
        }
        
        // Function to update all translations in DOM
        function updateTranslations() {
            // Update all elements with data-i18n attribute
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                element.textContent = i18n(key);
            });
            
            // Update all placeholders with data-i18n-placeholder attribute
            document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
                const key = element.getAttribute('data-i18n-placeholder');
                element.placeholder = i18n(key);
            });
        }

        // ==============================================
        // FIREBASE CONFIGURATION
        // ==============================================
        const firebaseConfig = {
            apiKey: "AIzaSyANGkq3nCLllDjYbIGsZW4N9BOtBDCJNbo",
            authDomain: "hr-system-sync-f4517.firebaseapp.com",
            databaseURL: "https://hr-system-sync-f4517-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "hr-system-sync-f4517",
            storageBucket: "hr-system-sync-f4517.firebasestorage.app",
            messagingSenderId: "396906615629",
            appId: "1:396906615629:web:90d1c6a1ed3971d58d5d04",
            measurementId: "G-DYHL19MCL9"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        
        // Get references to services
        const auth = firebase.auth();
        const database = firebase.database();

        // ==============================================
        // ZMIENNE GLOBALNE
        // ==============================================
        let currentUser = null;
        let employees = [];
        let deletedEmployees = [];
        let clothingRecords = {};
        let positionClothesMapping = {};
        let sortColumn = null;
        let sortDirection = 'asc';
        let nextEmployeeId = 1;
        let dbRef = null; // Reference do bazy danych uÅ¼ytkownika
        let isFirstLoad = true;
        let syncInProgress = false;

        // Zmienne dla filtrÃ³w
        let activeFilters = {
            department: '',
            position: '',
            shift: ''
        };

        // Listy konfiguracyjne
        let systemLists = {
            departments: ['DZIAÅ_SPAWALNIA_UA', 'DZIAÅ_SPAWALNIA_UA_ROBOT', 'DZIAÅ_SPAWALNIA_PL', 'DZIAÅ_MONTAÅ»', 'DZIAÅ_KONTROLA_JAKOÅšCI'],
            positions: ['Spawacz MIG/MAG', 'Spawacz TIG', 'Operator robota', 'Szlifierz', 'Monter', 'Kontroler jakoÅ›ci'],
            shifts: ['HRABKO VIACHESLAV', 'Katarzyna KrzyÅ¼anek', 'Gracjan Åomozik', 'Adam Nowak', 'Jan Kowalski'],
            citizenships: ['ukraiÅ„skie', 'polskie', 'indyjskie', 'kolumbijskie', 'hiszpaÅ„skie', 'meksykaÅ„skie', 'amerykaÅ„skie', 'chiÅ„skie'],
            clothingItems: ['Kask', 'Okulary', 'RÄ™kawice', 'Kurtka', 'Spodnie', 'Buty', 'Kamizelka', 'Stopery']
        };

        // DomyÅ›lne mapowanie stanowisk do odzieÅ¼y na szkolenie
        const defaultPositionClothesMapping = {
            'Spawacz MIG_MAG': ['buty', 'spodnie', 'bluza', 'rÄ™kawice spawalnicze', 'przyÅ‚bica spawalnicza'],
            'Spawacz TIG': ['buty', 'spodnie', 'bluza', 'rÄ™kawice spawalnicze', 'przyÅ‚bica spawalnicza'],
            'Operator robota': ['buty', 'spodnie', 'bluza', 'okulary ochronne'],
            'Szlifierz': ['buty', 'spodnie', 'bluza', 'okulary ochronne', 'maska przeciwpyÅ‚owa'],
            'Monter': ['buty', 'spodnie', 'bluza', 'rÄ™kawice montaÅ¼owe'],
            'Kontroler jakoÅ›ci': ['buty', 'spodnie', 'bluza']
        };
        
        // Funkcja do sanityzacji kluczy dla Firebase
        function sanitizeFirebaseKey(key) {
            if (!key) return '';
            // ZamieÅ„ niedozwolone znaki na podkreÅ›lenia
            return key.toString()
                .replace(/\//g, '_')
                .replace(/\./g, '_')
                .replace(/#/g, '_')
                .replace(/\$/g, '_')
                .replace(/\[/g, '_')
                .replace(/\]/g, '_');
        }
        
        // Funkcja do desanityzacji kluczy z Firebase
        function desanitizeFirebaseKey(key) {
            // Dla teraz zwracamy klucz bez zmian
            // W przyszÅ‚oÅ›ci moÅ¼na dodaÄ‡ mapowanie jeÅ›li potrzebne
            return key;
        }

        // ==============================================
        // AUTHENTICATION
        // ==============================================
        function loginWithEmail(event) {
            event.preventDefault();
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            showToast(i18n('toast.loggingIn'), 'info');
            
            auth.signInWithEmailAndPassword(email, password)
                .catch((error) => {
                    console.error('Login error:', error);
                    showToast(i18n('toast.loginError') + ' ' + error.message, 'error');
                });
        }

        function registerWithEmail() {
            const email = prompt(i18n('toast.enterEmail'));
            const password = prompt(i18n('toast.enterPassword'));
            
            if (email && password) {
                auth.createUserWithEmailAndPassword(email, password)
                    .then(() => {
                        showToast(i18n('toast.accountCreated'));
                    })
                    .catch((error) => {
                        console.error('Registration error:', error);
                        showToast(i18n('toast.registrationError') + ' ' + error.message, 'error');
                    });
            }
        }

        function loginWithGoogle() {
            const provider = new firebase.auth.GoogleAuthProvider();
            auth.signInWithPopup(provider)
                .catch((error) => {
                    console.error('Google login error:', error);
                    showToast(i18n('toast.googleLoginError') + ' ' + error.message, 'error');
                });
        }

        function logout() {
            if (confirm(i18n('toast.confirmLogout'))) {
                auth.signOut();
            }
        }

        // Auth state observer
        auth.onAuthStateChanged((user) => {
            console.log('Auth state changed:', user ? user.email : 'not logged in');
            currentUser = user;
            
            if (user) {
                // User is signed in
                document.getElementById('login-panel').style.display = 'none';
                document.getElementById('main-app').style.display = 'block';
                
                // Set up database reference for this user
                const userId = user.uid;
                console.log('User ID:', userId);
                
                // Clean up old reference
                if (dbRef) {
                    dbRef.off();
                }
                
                dbRef = database.ref('users/' + userId);
                console.log('Database reference created');
                
                // Initialize real-time sync
                initializeRealtimeSync();
                
                // Set up event listeners after login
                setupEventListeners();
                
                // Update translations
                updateTranslations();
                
                // Force initial data load
                dbRef.once('value').then((snapshot) => {
                    console.log('Initial data load complete');
                    const data = snapshot.val();
                    if (!data || Object.keys(data).length === 0) {
                        console.log('No data found for user, initializing empty state');
                        saveToFirebase(); // Initialize empty data structure
                    }
                }).catch((error) => {
                    console.error('Initial data load error:', error);
                });
                
                showToast(`${i18n('toast.welcome')} ${user.email}!`);
            } else {
                // User is signed out
                document.getElementById('login-panel').style.display = 'block';
                document.getElementById('main-app').style.display = 'none';
                
                // Clean up listeners
                if (dbRef) {
                    dbRef.off();
                    dbRef = null;
                }
            }
        });

        // ==============================================
        // REAL-TIME SYNC
        // ==============================================
        function initializeRealtimeSync() {
            updateSyncStatus('syncing');
            
            // Enable offline persistence
            database.goOffline();
            database.goOnline();
            
            // Force reconnection on mobile devices
            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                console.log('Mobile device detected - forcing reconnection');
                // Force a fresh connection
                database.ref('.info/connected').once('value', (snapshot) => {
                    if (!snapshot.val()) {
                        database.goOffline();
                        setTimeout(() => {
                            database.goOnline();
                        }, 1000);
                    }
                });
            }
            
            // Listen for connection state
            database.ref('.info/connected').on('value', (snapshot) => {
                const connected = snapshot.val();
                console.log('Connection state:', connected);
                if (connected) {
                    updateSyncStatus('synced');
                    document.getElementById('offline-indicator').classList.remove('show');
                    // Force data reload on reconnection
                    if (dbRef) {
                        dbRef.once('value').then((dataSnapshot) => {
                            console.log('Data reloaded after reconnection');
                        });
                    }
                } else {
                    updateSyncStatus('offline');
                    document.getElementById('offline-indicator').classList.add('show');
                }
            });
            
            // Listen for data changes with error handling
            if (dbRef) {
                dbRef.off(); // Remove existing listeners
                
                dbRef.on('value', (snapshot) => {
                    if (syncInProgress) return;
                    
                    console.log('Data received from Firebase');
                    const data = snapshot.val() || {};
                    console.log('Data structure:', Object.keys(data));
                    
                    // Update local data from Firebase
                    employees = data.employees || [];
                    deletedEmployees = data.deletedEmployees || [];
                    clothingRecords = data.clothingRecords || {};
                    
                    // Desanityzacja kluczy w positionClothesMapping
                    const loadedMapping = data.positionClothesMapping || {};
                    positionClothesMapping = {};
                    Object.keys(loadedMapping).forEach(sanitizedKey => {
                        let originalKey = sanitizedKey;
                        if (sanitizedKey === 'Spawacz MIG_MAG') {
                            originalKey = 'Spawacz MIG/MAG';
                        }
                        positionClothesMapping[originalKey] = loadedMapping[sanitizedKey];
                    });
                    
                    // JeÅ›li brak mapowania, uÅ¼yj domyÅ›lnego
                    if (Object.keys(positionClothesMapping).length === 0) {
                        positionClothesMapping = {
                            'Spawacz MIG/MAG': ['buty', 'spodnie', 'bluza', 'rÄ™kawice spawalnicze', 'przyÅ‚bica spawalnicza'],
                            'Spawacz TIG': ['buty', 'spodnie', 'bluza', 'rÄ™kawice spawalnicze', 'przyÅ‚bica spawalnicza'],
                            'Operator robota': ['buty', 'spodnie', 'bluza', 'okulary ochronne'],
                            'Szlifierz': ['buty', 'spodnie', 'bluza', 'okulary ochronne', 'maska przeciwpyÅ‚owa'],
                            'Monter': ['buty', 'spodnie', 'bluza', 'rÄ™kawice montaÅ¼owe'],
                            'Kontroler jakoÅ›ci': ['buty', 'spodnie', 'bluza']
                        };
                    }
                    
                    systemLists = data.systemLists || systemLists;
                    nextEmployeeId = data.nextEmployeeId || 1;
                    
                    // Update UI - zawsze odÅ›wieÅ¼ interfejs
                    renderEmployees();
                    updateStats();
                    renderDeletedEmployees();
                    updateClothingEmployeesList();
                    updateTrainingEmployeesList();
                    renderSettingsLists();
                    renderPositionClothesMapping();
                    updateDropdowns();
                    
                    if (!isFirstLoad) {
                        showToast(i18n('toast.dataSynced'), 'success');
                    }
                    
                    isFirstLoad = false;
                    updateSyncStatus('synced');
                    
                    // Hide info card if there are employees
                    const infoCard = document.getElementById('info-card');
                    if (infoCard) {
                        infoCard.style.display = employees.length > 0 ? 'none' : 'block';
                    }
                }, (error) => {
                    console.error('Firebase sync error:', error);
                    updateSyncStatus('error');
                    showToast(i18n('toast.syncError') + ' ' + error.message, 'error');
                    
                    // Retry connection
                    setTimeout(() => {
                        console.log('Retrying connection...');
                        database.goOffline();
                        database.goOnline();
                    }, 5000);
                });
            }
        }

        function saveToFirebase() {
            if (!dbRef || syncInProgress) return;
            
            syncInProgress = true;
            updateSyncStatus('syncing');
            
            // Sanityzacja kluczy w positionClothesMapping
            const sanitizedPositionClothesMapping = {};
            Object.keys(positionClothesMapping).forEach(position => {
                const sanitizedKey = sanitizeFirebaseKey(position);
                sanitizedPositionClothesMapping[sanitizedKey] = positionClothesMapping[position];
            });
            
            const data = {
                employees: employees,
                deletedEmployees: deletedEmployees,
                clothingRecords: clothingRecords,
                positionClothesMapping: sanitizedPositionClothesMapping,
                nextEmployeeId: nextEmployeeId,
                systemLists: systemLists,
                lastUpdated: firebase.database.ServerValue.TIMESTAMP
            };
            
            dbRef.set(data)
                .then(() => {
                    updateSyncStatus('synced');
                    showAutoSaveIndicator();
                })
                .catch((error) => {
                    console.error('Save error:', error);
                    updateSyncStatus('error');
                    showToast(i18n('toast.syncError') + ' ' + error.message, 'error');
                })
                .finally(() => {
                    syncInProgress = false;
                });
        }

        function updateSyncStatus(status) {
            const syncStatus = document.getElementById('sync-status');
            const syncIcon = document.getElementById('sync-icon');
            const syncText = document.getElementById('sync-text');
            
            // Remove all status classes
            syncStatus.classList.remove('syncing', 'synced', 'error', 'offline');
            syncIcon.classList.remove('rotating');
            
            const statusTexts = {
                syncing: { pl: 'Synchronizacja...', ua: 'Ğ¡Ğ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ñ–Ğ·Ğ°Ñ†Ñ–Ñ...', en: 'Synchronizing...', es: 'Sincronizando...' },
                synced: { pl: 'Zsynchronizowano', ua: 'Ğ¡Ğ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ñ–Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¾', en: 'Synchronized', es: 'Sincronizado' },
                error: { pl: 'BÅ‚Ä…d synchronizacji', ua: 'ĞŸĞ¾Ğ¼Ğ¸Ğ»ĞºĞ° ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ñ–Ğ·Ğ°Ñ†Ñ–Ñ—', en: 'Sync error', es: 'Error de sincronizaciÃ³n' },
                offline: { pl: 'Tryb offline', ua: 'ĞÑ„Ğ»Ğ°Ğ¹Ğ½ Ñ€ĞµĞ¶Ğ¸Ğ¼', en: 'Offline mode', es: 'Modo sin conexiÃ³n' }
            };
            
            switch(status) {
                case 'syncing':
                    syncStatus.classList.add('syncing');
                    syncIcon.classList.add('rotating');
                    syncText.textContent = statusTexts.syncing[currentLanguage] || statusTexts.syncing.pl;
                    break;
                case 'synced':
                    syncStatus.classList.add('synced');
                    syncText.textContent = statusTexts.synced[currentLanguage] || statusTexts.synced.pl;
                    break;
                case 'error':
                    syncStatus.classList.add('error');
                    syncText.textContent = statusTexts.error[currentLanguage] || statusTexts.error.pl;
                    break;
                case 'offline':
                    syncStatus.classList.add('offline');
                    syncText.textContent = statusTexts.offline[currentLanguage] || statusTexts.offline.pl;
                    break;
            }
        }

        // ==============================================
        // CORE FUNCTIONS (updated for Firebase)
        // ==============================================
        
        // Pokazanie wskaÅºnika auto-zapisu
        function showAutoSaveIndicator() {
            const indicator = document.getElementById('auto-save-indicator');
            indicator.classList.add('show');
            setTimeout(() => {
                indicator.classList.remove('show');
            }, 2000);
        }

        // Generowanie unikalnego ID
        function generateUniqueId() {
            return nextEmployeeId++;
        }

        // Aktualizacja listy pracownikÃ³w dla odzieÅ¼y na szkolenie
        function updateTrainingEmployeesList() {
            const select = document.getElementById('training-employee-select');
            if (!select) return;
            
            select.innerHTML = `<option value="">${i18n('select.employee')}</option>`;
            
            employees.forEach(emp => {
                const option = document.createElement('option');
                option.value = emp.id;
                option.textContent = `${emp.name} - ${emp.department} - ${emp.position}`;
                select.appendChild(option);
            });
        }

        // Åadowanie odzieÅ¼y na szkolenie dla wybranego pracownika
        function loadTrainingClothes() {
            const employeeId = document.getElementById('training-employee-select').value;
            
            if (!employeeId) {
                document.getElementById('training-clothes-display').style.display = 'none';
                return;
            }
            
            const employee = employees.find(emp => emp.id == employeeId);
            if (!employee) return;
            
            // PokaÅ¼ sekcjÄ™
            document.getElementById('training-clothes-display').style.display = 'block';
            
            // WypeÅ‚nij dane pracownika
            document.getElementById('training-employee-name').textContent = employee.name;
            document.getElementById('training-employee-rcp').textContent = employee.rcp || '-';
            document.getElementById('training-employee-position').textContent = employee.position || '-';
            document.getElementById('training-employee-department').textContent = employee.department || '-';
            
            // Pobierz listÄ™ odzieÅ¼y dla stanowiska
            const position = employee.position;
            const clothesList = positionClothesMapping[position] || [];
            
            // WyÅ›wietl listÄ™ odzieÅ¼y
            const listContainer = document.getElementById('training-clothes-list');
            if (clothesList.length > 0) {
                listContainer.innerHTML = clothesList.map(item => `
                    <div class="clothes-item">${item}</div>
                `).join('');
            } else {
                listContainer.innerHTML = `
                    <div style="text-align: center; color: rgba(255, 255, 255, 0.5); padding: 2rem;">
                        ${i18n('training.noClothingAssigned')}
                        <br><br>
                        ${i18n('training.goToSettings')}
                    </div>
                `;
            }
            
            // PokaÅ¼ sekcjÄ™ podpisÃ³w
            document.querySelector('#training-clothes-display .signature-section').style.display = 'block';
        }

        // Funkcja drukowania karty odzieÅ¼y na szkolenie - NAPRAWIONA
        function printTrainingClothes() {
            const employeeId = document.getElementById('training-employee-select').value;
            
            if (!employeeId) {
                showToast(i18n('toast.selectEmployee'), 'error');
                return;
            }
            
            // Dodaj klasÄ™ do body podczas drukowania
            document.body.classList.add('printing-training');
            
            // Drukuj
            window.print();
            
            // UsuÅ„ klasÄ™ po drukowaniu
            setTimeout(() => {
                document.body.classList.remove('printing-training');
            }, 100);
        }

        // Renderowanie mapowania stanowisk do odzieÅ¼y
        function renderPositionClothesMapping() {
            const container = document.getElementById('position-clothes-mapping');
            if (!container) return;
            
            container.innerHTML = systemLists.positions.map(position => {
                const clothes = positionClothesMapping[position] || [];
                const safeId = position.replace(/\s+/g, '-').replace(/\//g, '-').replace(/[^\w-]/g, '');
                return `
                    <div class="mapping-item">
                        <div class="mapping-position">
                            <span>${position}</span>
                            <button class="btn btn-primary btn-sm" onclick="showAddClothesForm('${position.replace(/'/g, "\\'")}')" style="padding: 0.25rem 0.75rem; font-size: 0.85rem;">
                                ${i18n('settings.addClothingToPosition')}
                            </button>
                        </div>
                        <div class="clothes-tags">
                            ${clothes.map((item, index) => `
                                <span class="clothes-tag">
                                    ${item}
                                    <span class="remove-tag" onclick="removeClothesFromPosition('${position.replace(/'/g, "\\'")}', ${index})">Ã—</span>
                                </span>
                            `).join('')}
                            ${clothes.length === 0 ? `<span style="color: rgba(255, 255, 255, 0.5); font-size: 0.85rem;">${i18n('settings.noClothingAssigned')}</span>` : ''}
                        </div>
                        <div id="add-clothes-form-${safeId}" style="display: none; margin-top: 0.75rem;">
                            <div class="add-clothes-form">
                                <input type="text" class="form-input" placeholder="${i18n('settings.clothingItemName')}" 
                                       id="new-clothes-${safeId}" 
                                       style="flex: 1;">
                                <button class="btn btn-success" onclick="addClothesToPosition('${position.replace(/'/g, "\\'")}')">
                                    ${i18n('buttons.addClothingItem')}
                                </button>
                                <button class="btn" onclick="hideAddClothesForm('${position.replace(/'/g, "\\'")}')" 
                                        style="background: rgba(255,255,255,0.1); color: white;">
                                    ${i18n('buttons.cancel')}
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Pokazanie formularza dodawania odzieÅ¼y
        function showAddClothesForm(position) {
            const safeId = position.replace(/\s+/g, '-').replace(/\//g, '-').replace(/[^\w-]/g, '');
            const formId = `add-clothes-form-${safeId}`;
            const form = document.getElementById(formId);
            if (form) {
                form.style.display = 'block';
            }
        }

        // Ukrycie formularza dodawania odzieÅ¼y
        function hideAddClothesForm(position) {
            const safeId = position.replace(/\s+/g, '-').replace(/\//g, '-').replace(/[^\w-]/g, '');
            const formId = `add-clothes-form-${safeId}`;
            const form = document.getElementById(formId);
            if (form) {
                form.style.display = 'none';
            }
            const inputId = `new-clothes-${safeId}`;
            const input = document.getElementById(inputId);
            if (input) {
                input.value = '';
            }
        }

        // Dodanie odzieÅ¼y do stanowiska
        function addClothesToPosition(position) {
            const safeId = position.replace(/\s+/g, '-').replace(/\//g, '-').replace(/[^\w-]/g, '');
            const inputId = `new-clothes-${safeId}`;
            const input = document.getElementById(inputId);
            if (!input) {
                showToast(i18n('toast.errorNoField'), 'error');
                return;
            }
            
            const clothesName = input.value.trim();
            
            if (!clothesName) {
                showToast(i18n('toast.enterValue'), 'error');
                return;
            }
            
            if (!positionClothesMapping[position]) {
                positionClothesMapping[position] = [];
            }
            
            positionClothesMapping[position].push(clothesName);
            
            hideAddClothesForm(position);
            renderPositionClothesMapping();
            saveToFirebase();
            showToast(i18n('toast.addedToPosition'));
        }

        // UsuniÄ™cie odzieÅ¼y ze stanowiska
        function removeClothesFromPosition(position, index) {
            if (confirm(i18n('toast.confirmRemoveClothing'))) {
                positionClothesMapping[position].splice(index, 1);
                renderPositionClothesMapping();
                saveToFirebase();
                showToast(i18n('toast.removedFromPosition'));
            }
        }

        // ==============================================
        // PODSTAWOWE FUNKCJE APLIKACJI
        // ==============================================

        // Renderowanie pracownikÃ³w
        function renderEmployees() {
            const tbody = document.getElementById('employees-tbody');
            const mobileCards = document.getElementById('mobile-cards');
            
            let filteredEmployees = applyFiltersToEmployees();
            
            if (sortColumn) {
                filteredEmployees.sort((a, b) => {
                    let aVal = a[sortColumn] || '';
                    let bVal = b[sortColumn] || '';
                    
                    if (sortColumn === 'rcp' || sortColumn === 'locker') {
                        aVal = parseInt(aVal) || 0;
                        bVal = parseInt(bVal) || 0;
                    } else if (sortColumn === 'hireDate') {
                        aVal = new Date(aVal || '1900-01-01');
                        bVal = new Date(bVal || '1900-01-01');
                    } else {
                        aVal = aVal.toString().toLowerCase();
                        bVal = bVal.toString().toLowerCase();
                    }
                    
                    if (sortDirection === 'asc') {
                        return aVal < bVal ? -1 : aVal > bVal ? 1 : 0;
                    } else {
                        return aVal > bVal ? -1 : aVal < bVal ? 1 : 0;
                    }
                });
            }
            
            // Desktop view
            tbody.innerHTML = filteredEmployees.map(emp => `
                <tr>
                    <td class="editable" onclick="makeEditable(this, ${emp.id}, 'name')">${emp.name}</td>
                    <td class="editable" onclick="makeEditable(this, ${emp.id}, 'position')">${emp.position}</td>
                    <td class="editable" onclick="makeEditable(this, ${emp.id}, 'department')">${emp.department}</td>
                    <td class="editable" onclick="makeEditable(this, ${emp.id}, 'shift')">${emp.shift || ''}</td>
                    <td class="editable" onclick="makeEditable(this, ${emp.id}, 'rcp')">${emp.rcp || ''}</td>
                    <td class="editable" onclick="makeEditable(this, ${emp.id}, 'citizenship')">${emp.citizenship}</td>
                    <td class="editable" onclick="makeEditable(this, ${emp.id}, 'locker')">${emp.locker || ''}</td>
                    <td class="editable" onclick="makeEditable(this, ${emp.id}, 'hireDate')">${formatDate(emp.hireDate)}</td>
                    <td>
                        <div class="action-btns">
                            <button class="btn-icon edit" onclick="editEmployee(${emp.id})" title="${i18n('buttons.edit')}">âœï¸</button>
                            <button class="btn-icon delete" onclick="deleteEmployee(${emp.id})" title="${i18n('buttons.delete')}">ğŸ—‘ï¸</button>
                        </div>
                    </td>
                </tr>
            `).join('');
            
            // Mobile view
            mobileCards.innerHTML = filteredEmployees.map(emp => `
                <div class="employee-card">
                    <div class="employee-card-header">
                        <div>
                            <div class="employee-name">${emp.name}</div>
                            <div class="employee-position">${emp.position}</div>
                        </div>
                        <div class="card-actions">
                            <button class="btn-icon edit" onclick="editEmployee(${emp.id})">âœï¸</button>
                            <button class="btn-icon delete" onclick="deleteEmployee(${emp.id})">ğŸ—‘ï¸</button>
                        </div>
                    </div>
                    <div class="employee-details">
                        <div class="detail-row">
                            <span class="detail-label">${i18n('table.department')}:</span>
                            <span>${emp.department}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">${i18n('table.shift')}:</span>
                            <span>${emp.shift || '-'}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">${i18n('table.rcp')}:</span>
                            <span>${emp.rcp || '-'}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">${i18n('table.citizenship')}:</span>
                            <span>${emp.citizenship}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">${i18n('table.locker')}:</span>
                            <span>${emp.locker || '-'}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">${i18n('table.hireDate')}:</span>
                            <span>${formatDate(emp.hireDate)}</span>
                        </div>
                    </div>
                </div>
            `).join('');
            
            updateHeaders();
            updateStats();
            updateDepartmentStats();
        }

        // Aplikowanie filtrÃ³w
        function applyFiltersToEmployees() {
            let filtered = [...employees];
            
            // Filtr po dziale
            if (activeFilters.department) {
                filtered = filtered.filter(emp => emp.department === activeFilters.department);
            }
            
            // Filtr po stanowisku
            if (activeFilters.position) {
                filtered = filtered.filter(emp => emp.position === activeFilters.position);
            }
            
            // Filtr po zmianie
            if (activeFilters.shift) {
                filtered = filtered.filter(emp => emp.shift === activeFilters.shift);
            }
            
            // Wyszukiwanie
            const searchTerm = document.getElementById('search').value.toLowerCase().trim();
            if (searchTerm) {
                filtered = filtered.filter(emp => {
                    // Szukaj we wszystkich polach
                    const searchableText = [
                        emp.name,
                        emp.position,
                        emp.department,
                        emp.shift || '',
                        emp.rcp ? emp.rcp.toString() : '',
                        emp.citizenship,
                        emp.locker || '',
                        formatDate(emp.hireDate)
                    ].join(' ').toLowerCase();
                    
                    return searchableText.includes(searchTerm);
                });
            }
            
            // Aktualizacja licznika filtrowanych pracownikÃ³w
            const filteredCard = document.getElementById('filtered-count-card');
            const filteredCount = document.getElementById('filtered-employees');
            
            if (activeFilters.department || activeFilters.position || activeFilters.shift || searchTerm) {
                filteredCard.style.display = 'block';
                filteredCount.textContent = filtered.length;
            } else {
                filteredCard.style.display = 'none';
            }
            
            return filtered;
        }

        // Aplikowanie filtrÃ³w (wywoÅ‚ywane z HTML)
        function applyFilters() {
            activeFilters.department = document.getElementById('filter-department').value;
            activeFilters.position = document.getElementById('filter-position').value;
            activeFilters.shift = document.getElementById('filter-shift').value;
            renderEmployees();
        }

        // Renderowanie usuniÄ™tych pracownikÃ³w - DODANA FUNKCJA TRWAÅEGO USUWANIA
        function renderDeletedEmployees() {
            const tbody = document.getElementById('deleted-tbody');
            const mobileCards = document.getElementById('deleted-mobile-cards');
            const emptyState = document.getElementById('deleted-empty');
            
            if (deletedEmployees.length === 0) {
                tbody.innerHTML = '';
                mobileCards.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            
            emptyState.style.display = 'none';
            
            // Desktop view
            tbody.innerHTML = deletedEmployees.map(emp => `
                <tr>
                    <td>${emp.name}</td>
                    <td>${emp.position}</td>
                    <td>${emp.department}</td>
                    <td>${emp.shift || ''}</td>
                    <td>${emp.rcp || ''}</td>
                    <td>${emp.citizenship}</td>
                    <td>${formatDate(emp.deletedDate)}</td>
                    <td>
                        <div class="action-btns">
                            <button class="btn-icon restore" onclick="restoreEmployee(${emp.id})" title="${i18n('buttons.restore')}">â†©ï¸</button>
                            <button class="btn-icon delete" onclick="permanentlyDeleteEmployee(${emp.id})" title="${i18n('buttons.permanentlyDelete')}">âŒ</button>
                        </div>
                    </td>
                </tr>
            `).join('');
            
            // Mobile view
            mobileCards.innerHTML = deletedEmployees.map(emp => `
                <div class="employee-card">
                    <div class="employee-card-header">
                        <div>
                            <div class="employee-name">${emp.name}</div>
                            <div class="employee-position" style="color: #ef4444;">${i18n('table.deleteDate')}: ${formatDate(emp.deletedDate)}</div>
                        </div>
                        <div class="card-actions">
                            <button class="btn-icon restore" onclick="restoreEmployee(${emp.id})">â†©ï¸</button>
                            <button class="btn-icon delete" onclick="permanentlyDeleteEmployee(${emp.id})">âŒ</button>
                        </div>
                    </div>
                    <div class="employee-details">
                        <div class="detail-row">
                            <span class="detail-label">${i18n('table.position')}:</span>
                            <span>${emp.position}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">${i18n('table.department')}:</span>
                            <span>${emp.department}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">${i18n('table.citizenship')}:</span>
                            <span>${emp.citizenship}</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // NOWA FUNKCJA - TrwaÅ‚e usuwanie pracownika
        function permanentlyDeleteEmployee(id) {
            if (!confirm(i18n('toast.confirmDeletePermanently'))) return;
            
            const index = deletedEmployees.findIndex(emp => emp.id === id);
            if (index === -1) return;
            
            // UsuÅ„ pracownika z listy usuniÄ™tych
            deletedEmployees.splice(index, 1);
            
            // UsuÅ„ wszystkie rekordy wydawania odzieÅ¼y dla tego pracownika
            delete clothingRecords[id];
            
            saveToFirebase();
            renderDeletedEmployees();
            showToast(i18n('toast.employeePermanentlyDeleted'));
        }

        // Aktualizacja statystyk
        function updateStats() {
            document.getElementById('total-employees').textContent = employees.length;
            
            const departments = [...new Set(employees.map(emp => emp.department))];
            document.getElementById('departments-count').textContent = departments.length;
            
            const nationalities = [...new Set(employees.map(emp => emp.citizenship))];
            document.getElementById('nationalities-count').textContent = nationalities.length;
        }

        // Aktualizacja statystyk dziaÅ‚Ã³w
        function updateDepartmentStats() {
            const container = document.getElementById('department-stats');
            const grid = document.getElementById('dept-cards-grid');
            
            if (employees.length === 0) {
                container.style.display = 'none';
                return;
            }
            
            container.style.display = 'block';
            
            // Grupowanie pracownikÃ³w po dziaÅ‚ach
            const deptGroups = {};
            employees.forEach(emp => {
                if (!deptGroups[emp.department]) {
                    deptGroups[emp.department] = {
                        count: 0,
                        positions: new Set(),
                        employees: []
                    };
                }
                deptGroups[emp.department].count++;
                deptGroups[emp.department].positions.add(emp.position);
                deptGroups[emp.department].employees.push(emp);
            });
            
            // Renderowanie kart dziaÅ‚Ã³w
            grid.innerHTML = Object.entries(deptGroups).map(([dept, data]) => `
                <div class="dept-card" onclick="showDepartmentDetails('${dept}')">
                    <div class="dept-name">${dept}</div>
                    <div class="dept-info">
                        <div class="dept-count">${data.count}</div>
                        <div class="dept-positions">${data.positions.size} ${i18n('departments.positions')}</div>
                    </div>
                    <div class="dept-positions-list">
                        ${Array.from(data.positions).slice(0, 3).map(pos => 
                            `<span class="position-badge">${pos}</span>`
                        ).join('')}
                        ${data.positions.size > 3 ? `<span class="position-badge">+${data.positions.size - 3}</span>` : ''}
                    </div>
                </div>
            `).join('');
        }

        // Pokazanie szczegÃ³Å‚Ã³w dziaÅ‚u - NOWA WERSJA
        function showDepartmentDetails(department) {
            const modal = document.getElementById('dept-modal');
            const title = document.getElementById('dept-modal-title');
            const content = document.getElementById('dept-modal-content');
            
            const deptEmployees = employees.filter(emp => emp.department === department);
            
            // Grupowanie pracownikÃ³w po stanowiskach
            const positionGroups = {};
            deptEmployees.forEach(emp => {
                if (!positionGroups[emp.position]) {
                    positionGroups[emp.position] = [];
                }
                positionGroups[emp.position].push(emp);
            });
            
            title.textContent = i18n('toast.departmentDetails').replace('{department}', department);
            
            content.innerHTML = `
                <div style="margin-bottom: 2rem;">
                    <p style="color: white; font-size: 1.2rem; margin-bottom: 1rem;">
                        ${i18n('departments.employeeCount')} <strong>${deptEmployees.length}</strong>
                    </p>
                </div>
                ${Object.entries(positionGroups).map(([position, employees]) => `
                    <div class="position-section">
                        <div class="position-header">
                            <div class="position-name">${position}</div>
                            <div class="position-count">${employees.length}</div>
                        </div>
                        <div class="employee-list">
                            ${employees.map(emp => `
                                <div class="employee-item" onclick="editEmployee(${emp.id})">
                                    <div class="employee-name">${emp.name}</div>
                                    <div class="employee-date">${formatDate(emp.hireDate)}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `).join('')}
            `;
            
            modal.style.display = 'block';
        }

        // ZamkniÄ™cie modala dziaÅ‚u
        function closeDeptModal() {
            document.getElementById('dept-modal').style.display = 'none';
        }

        // Sortowanie pracownikÃ³w
        function sortEmployees(column) {
            if (sortColumn === column) {
                sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                sortColumn = column;
                sortDirection = 'asc';
            }
            renderEmployees();
        }

        // Sortowanie po dacie - najnowsi
        function sortByDateNewest() {
            sortColumn = 'hireDate';
            sortDirection = 'desc';
            renderEmployees();
            
            // Aktualizacja przyciskÃ³w
            document.querySelectorAll('.sort-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        // Sortowanie po dacie - najstarsi
        function sortByDateOldest() {
            sortColumn = 'hireDate';
            sortDirection = 'asc';
            renderEmployees();
            
            // Aktualizacja przyciskÃ³w
            document.querySelectorAll('.sort-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        // Sortowanie usuniÄ™tych po dacie - najnowsi
        function sortDeletedByDateNewest() {
            deletedEmployees.sort((a, b) => new Date(b.deletedDate) - new Date(a.deletedDate));
            renderDeletedEmployees();
        }

        // Sortowanie usuniÄ™tych po dacie - najstarsi
        function sortDeletedByDateOldest() {
            deletedEmployees.sort((a, b) => new Date(a.deletedDate) - new Date(b.deletedDate));
            renderDeletedEmployees();
        }

        // Aktualizacja nagÅ‚Ã³wkÃ³w tabeli
        function updateHeaders() {
            const headers = document.querySelectorAll('#employees-table th');
            headers.forEach(header => {
                header.classList.remove('sorted-asc', 'sorted-desc');
            });
            
            if (sortColumn) {
                const columnMap = {
                    'name': 0,
                    'position': 1,
                    'department': 2,
                    'shift': 3,
                    'rcp': 4,
                    'citizenship': 5,
                    'locker': 6,
                    'hireDate': 7
                };
                
                const headerIndex = columnMap[sortColumn];
                if (headerIndex !== undefined) {
                    headers[headerIndex].classList.add(sortDirection === 'asc' ? 'sorted-asc' : 'sorted-desc');
                }
            }
        }

        // Formatowanie daty
        function formatDate(dateString) {
            if (!dateString) return '-';
            const date = new Date(dateString);
            return date.toLocaleDateString('pl-PL');
        }

        // Edycja inline
        function makeEditable(td, employeeId, field) {
            if (td.querySelector('input')) return;
            
            const currentValue = td.textContent;
            const employee = employees.find(emp => emp.id === employeeId);
            
            let input;
            if (field === 'hireDate') {
                input = document.createElement('input');
                input.type = 'date';
                input.value = employee[field] || '';
            } else if (field === 'department') {
                input = document.createElement('select');
                input.innerHTML = `<option value="">${i18n('select.choose')}</option>`;
                systemLists.departments.forEach(dept => {
                    const option = document.createElement('option');
                    option.value = dept;
                    option.textContent = dept;
                    if (dept === currentValue) option.selected = true;
                    input.appendChild(option);
                });
            } else if (field === 'citizenship') {
                input = document.createElement('select');
                input.innerHTML = `<option value="">${i18n('select.choose')}</option>`;
                systemLists.citizenships.forEach(cit => {
                    const option = document.createElement('option');
                    option.value = cit;
                    option.textContent = cit;
                    if (cit === currentValue) option.selected = true;
                    input.appendChild(option);
                });
            } else {
                input = document.createElement('input');
                input.type = field === 'rcp' ? 'number' : 'text';
                input.value = currentValue;
            }
            
            input.className = 'edit-input';
            
            input.onblur = function() {
                const newValue = input.value.trim();
                if (newValue !== currentValue) {
                    employee[field] = newValue;
                    saveToFirebase();
                    showToast(i18n('toast.dataUpdated'));
                }
                td.textContent = field === 'hireDate' ? formatDate(newValue) : (newValue || '-');
            };
            
            input.onkeydown = function(e) {
                if (e.key === 'Enter') {
                    input.blur();
                } else if (e.key === 'Escape') {
                    td.textContent = currentValue;
                }
            };
            
            td.textContent = '';
            td.appendChild(input);
            input.focus();
            if (input.select) input.select();
        }

        // ==============================================
        // CRUD OPERATIONS
        // ==============================================

        // Dodawanie pracownika
        function addEmployee(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const employee = {
                id: generateUniqueId(),
                name: formData.get('name').toUpperCase(),
                position: formData.get('position'),
                department: formData.get('department') === 'other' ? 
                    formData.get('department-other') : formData.get('department'),
                shift: formData.get('shift'),
                rcp: formData.get('rcp'),
                citizenship: formData.get('citizenship') === 'other' ? 
                    formData.get('citizenship-other') : formData.get('citizenship'),
                locker: formData.get('locker'),
                hireDate: formData.get('hireDate')
            };
            
            employees.push(employee);
            saveToFirebase();
            
            closeAddModal();
            renderEmployees();
            showToast(i18n('toast.employeeAdded'));
        }

        // Dodawanie usuniÄ™tego pracownika - NOWA FUNKCJA
        function addDeletedEmployee(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const employee = {
                id: generateUniqueId(),
                name: formData.get('name').toUpperCase(),
                position: formData.get('position'),
                department: formData.get('department'),
                shift: formData.get('shift'),
                rcp: formData.get('rcp'),
                citizenship: formData.get('citizenship'),
                deletedDate: formData.get('deletedDate')
            };
            
            deletedEmployees.push(employee);
            saveToFirebase();
            
            closeAddDeletedModal();
            renderDeletedEmployees();
            showToast(i18n('toast.employeeAdded'));
        }

        // Otwieranie modala dodawania usuniÄ™tego pracownika
        function openAddDeletedModal() {
            updateDeletedDropdowns();
            document.getElementById('add-deleted-form').reset();
            document.getElementById('add-deleted-form').elements.deletedDate.value = new Date().toISOString().split('T')[0];
            document.getElementById('add-deleted-modal').style.display = 'block';
        }

        // Zamykanie modala dodawania usuniÄ™tego pracownika
        function closeAddDeletedModal() {
            document.getElementById('add-deleted-modal').style.display = 'none';
        }

        // Aktualizacja dropdownÃ³w dla usuniÄ™tych
        function updateDeletedDropdowns() {
            // Datalisty
            updateDatalist('deleted-position-list', systemLists.positions);
            updateDatalist('deleted-shift-list', systemLists.shifts);
            
            // Selecty
            updateSelect('deleted-department-select', systemLists.departments, false);
            updateSelect('deleted-citizenship-select', systemLists.citizenships, false);
        }

        // Edytowanie pracownika - POPRAWIONE POZYCJONOWANIE
        function editEmployee(id) {
            const employee = employees.find(emp => emp.id === id);
            if (!employee) return;
            
            document.getElementById('edit-employee-id').value = id;
            document.getElementById('edit-name').value = employee.name;
            document.getElementById('edit-position').value = employee.position;
            document.getElementById('edit-department').value = employee.department;
            document.getElementById('edit-shift').value = employee.shift || '';
            document.getElementById('edit-rcp').value = employee.rcp || '';
            document.getElementById('edit-citizenship').value = employee.citizenship;
            document.getElementById('edit-locker').value = employee.locker || '';
            document.getElementById('edit-hireDate').value = employee.hireDate || '';
            
            updateDropdowns();
            
            // OtwÃ³rz modal
            const modal = document.getElementById('edit-modal');
            modal.style.display = 'block';
            
            // PrzewiÅ„ na gÃ³rÄ™ strony po maÅ‚ym opÃ³Åºnieniu
            setTimeout(() => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }, 50);
        }

        // Zapisywanie zmian pracownika
        function saveEmployee(event) {
            event.preventDefault();
            
            const id = parseInt(document.getElementById('edit-employee-id').value);
            const employee = employees.find(emp => emp.id === id);
            
            if (!employee) return;
            
            employee.name = document.getElementById('edit-name').value.toUpperCase();
            employee.position = document.getElementById('edit-position').value;
            employee.department = document.getElementById('edit-department').value === 'other' ? 
                document.getElementById('edit-department-other').value : 
                document.getElementById('edit-department').value;
            employee.shift = document.getElementById('edit-shift').value;
            employee.rcp = document.getElementById('edit-rcp').value;
            employee.citizenship = document.getElementById('edit-citizenship').value === 'other' ? 
                document.getElementById('edit-citizenship-other').value : 
                document.getElementById('edit-citizenship').value;
            employee.locker = document.getElementById('edit-locker').value;
            employee.hireDate = document.getElementById('edit-hireDate').value;
            
            saveToFirebase();
            closeEditModal();
            renderEmployees();
            showToast(i18n('toast.employeeUpdated'));
        }

        // Usuwanie pracownika
        function deleteEmployee(id) {
            if (!confirm(i18n('toast.confirmDelete'))) return;
            
            const index = employees.findIndex(emp => emp.id === id);
            if (index === -1) return;
            
            const employee = employees[index];
            employee.deletedDate = new Date().toISOString();
            
            deletedEmployees.push(employee);
            employees.splice(index, 1);
            
            saveToFirebase();
            renderEmployees();
            renderDeletedEmployees();
            showToast(i18n('toast.employeeDeleted'));
        }

        // Przywracanie pracownika
        function restoreEmployee(id) {
            const index = deletedEmployees.findIndex(emp => emp.id === id);
            if (index === -1) return;
            
            const employee = deletedEmployees[index];
            delete employee.deletedDate;
            
            employees.push(employee);
            deletedEmployees.splice(index, 1);
            
            saveToFirebase();
            renderEmployees();
            renderDeletedEmployees();
            showToast(i18n('toast.employeeRestored'));
        }
        
        // Usuwanie wszystkich pracownikÃ³w
        function clearAllEmployees() {
            if (employees.length === 0) {
                showToast(i18n('toast.listEmpty'), 'info');
                return;
            }
            
            const message = i18n('toast.confirmDeleteAll')
                .replace('{count}', employees.length);
            
            if (confirm(message)) {
                // Dodaj drugÄ… weryfikacjÄ™ dla bezpieczeÅ„stwa
                if (confirm(i18n('toast.finalWarning'))) {
                    // PrzenieÅ› wszystkich pracownikÃ³w do usuniÄ™tych
                    const currentDate = new Date().toISOString();
                    employees.forEach(emp => {
                        emp.deletedDate = currentDate;
                        deletedEmployees.push(emp);
                    });
                    
                    // WyczyÅ›Ä‡ listÄ™ aktywnych pracownikÃ³w
                    employees = [];
                    
                    // WyczyÅ›Ä‡ historiÄ™ wydawania odzieÅ¼y
                    clothingRecords = {};
                    
                    // Zapisz zmiany
                    saveToFirebase();
                    
                    // OdÅ›wieÅ¼ interfejs
                    renderEmployees();
                    renderDeletedEmployees();
                    updateClothingEmployeesList();
                    updateTrainingEmployeesList();
                    updateStats();
                    
                    // PokaÅ¼ kartÄ™ informacyjnÄ…
                    const infoCard = document.getElementById('info-card');
                    if (infoCard) {
                        infoCard.style.display = 'block';
                    }
                    
                    showToast(i18n('toast.allDeleted'));
                }
            }
        }

        // ==============================================
        // MODAL FUNCTIONS
        // ==============================================

        function openAddModal() {
            updateDropdowns();
            document.getElementById('add-form').reset();
            document.getElementById('add-form').elements.hireDate.value = new Date().toISOString().split('T')[0];
            document.getElementById('add-modal').style.display = 'block';
        }

        function closeAddModal() {
            document.getElementById('add-modal').style.display = 'none';
        }

        function closeEditModal() {
            document.getElementById('edit-modal').style.display = 'none';
        }

        // ==============================================
        // CLOTHING MANAGEMENT
        // ==============================================

        function updateClothingEmployeesList() {
            const select = document.getElementById('clothing-employee-select');
            select.innerHTML = `<option value="">${i18n('select.employee')}</option>`;
            
            employees.forEach(emp => {
                const option = document.createElement('option');
                option.value = emp.id;
                option.textContent = `${emp.name} - ${emp.department}`;
                select.appendChild(option);
            });
        }

        function loadEmployeeClothingData() {
            const employeeId = document.getElementById('clothing-employee-select').value;
            
            if (!employeeId) {
                document.getElementById('employee-clothing-card').style.display = 'none';
                document.getElementById('employee-clothing-card-mobile').style.display = 'none';
                return;
            }
            
            const employee = employees.find(emp => emp.id == employeeId);
            if (!employee) return;
            
            // Desktop view
            document.getElementById('employee-clothing-card').style.display = 'block';
            document.getElementById('clothing-employee-name').textContent = employee.name;
            document.getElementById('clothing-employee-position').textContent = employee.position;
            document.getElementById('clothing-employee-department').textContent = employee.department;
            
            // Mobile view
            document.getElementById('employee-clothing-card-mobile').style.display = 'block';
            document.getElementById('clothing-employee-name-mobile').textContent = employee.name;
            document.getElementById('clothing-employee-position-mobile').textContent = employee.position;
            document.getElementById('clothing-employee-department-mobile').textContent = employee.department;
            
            // Historia wydawania
            const history = clothingRecords[employeeId] || [];
            const lastIssue = history.length > 0 ? history[history.length - 1].date : null;
            
            document.getElementById('clothing-last-issue-date').textContent = lastIssue ? formatDate(lastIssue) : '-';
            document.getElementById('clothing-last-issue-date-mobile').textContent = lastIssue ? formatDate(lastIssue) : '-';
            
            const historyHtml = history.length > 0 ? 
                history.map((record, index) => `
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 10px; margin-bottom: 0.75rem;">
                        <p style="color: white; margin: 0 0 0.5rem 0;">
                            <strong>${i18n('clothing.issueDateLabel')}</strong> ${formatDate(record.date)}
                        </p>
                        <p style="color: rgba(255, 255, 255, 0.8); margin: 0 0 0.5rem 0;">
                            <strong>${i18n('clothing.issuedItems')}</strong> ${record.items.join(', ')}
                        </p>
                        ${record.notes ? `<p style="color: rgba(255, 255, 255, 0.7); margin: 0;"><strong>${i18n('clothing.notes')}</strong> ${record.notes}</p>` : ''}
                        <button class="btn-icon delete" onclick="removeClothingRecord(${employeeId}, ${index})" 
                                style="margin-top: 0.5rem; padding: 0.25rem 0.5rem; font-size: 0.8rem;">
                            ğŸ—‘ï¸ ${i18n('clothing.deleteEntry')}
                        </button>
                    </div>
                `).join('') : 
                `<p style="color: rgba(255, 255, 255, 0.5); text-align: center;">${i18n('clothing.noHistory')}</p>`;
            
            document.getElementById('clothing-history').innerHTML = historyHtml;
            document.getElementById('clothing-history-mobile').innerHTML = 
                history.length > 0 ? `${i18n('clothing.history')} ${history.length}` : i18n('clothing.noHistory');
        }

        function openClothingIssueModal() {
            const employeeId = document.getElementById('clothing-employee-select').value;
            
            if (!employeeId) {
                showToast(i18n('toast.selectEmployee'), 'error');
                return;
            }
            
            const employee = employees.find(emp => emp.id == employeeId);
            
            document.getElementById('modal-employee-name').textContent = employee.name;
            document.getElementById('modal-employee-department').textContent = employee.department;
            document.getElementById('modal-employee-position').textContent = employee.position;
            
            // Generowanie checkboxÃ³w
            const checkboxesContainer = document.getElementById('clothing-checkboxes');
            checkboxesContainer.innerHTML = systemLists.clothingItems.map(item => `
                <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                    <input type="checkbox" name="clothingItem" value="${item}" 
                           style="width: 20px; height: 20px; cursor: pointer;">
                    <span style="color: white;">${item}</span>
                </label>
            `).join('');
            
            document.getElementById('clothing-issue-form').reset();
            document.getElementById('clothing-issue-form').elements.issueDate.value = 
                new Date().toISOString().split('T')[0];
            
            document.getElementById('clothing-issue-modal').style.display = 'block';
        }

        function closeClothingIssueModal() {
            document.getElementById('clothing-issue-modal').style.display = 'none';
        }

        function issueClothing(event) {
            event.preventDefault();
            
            const employeeId = document.getElementById('clothing-employee-select').value;
            const formData = new FormData(event.target);
            
            const selectedItems = [];
            document.querySelectorAll('input[name="clothingItem"]:checked').forEach(checkbox => {
                selectedItems.push(checkbox.value);
            });
            
            if (selectedItems.length === 0) {
                showToast(i18n('toast.selectAtLeastOne'), 'error');
                return;
            }
            
            const record = {
                date: formData.get('issueDate'),
                items: selectedItems,
                notes: formData.get('notes')
            };
            
            if (!clothingRecords[employeeId]) {
                clothingRecords[employeeId] = [];
            }
            
            clothingRecords[employeeId].push(record);
            saveToFirebase();
            
            closeClothingIssueModal();
            loadEmployeeClothingData();
            showToast(i18n('toast.clothingIssued'));
        }

        function removeClothingRecord(employeeId, recordIndex) {
            if (!confirm(i18n('toast.confirmDeleteEntry'))) return;
            
            clothingRecords[employeeId].splice(recordIndex, 1);
            
            if (clothingRecords[employeeId].length === 0) {
                delete clothingRecords[employeeId];
            }
            
            saveToFirebase();
            loadEmployeeClothingData();
            showToast(i18n('toast.entryDeleted'));
        }

        // Funkcja drukowania karty odzieÅ¼y - NAPRAWIONA
        function printClothingRecord() {
            const employeeId = document.getElementById('clothing-employee-select').value;
            
            if (!employeeId) {
                showToast(i18n('toast.selectEmployee'), 'error');
                return;
            }
            
            // Dodaj klasÄ™ do body podczas drukowania
            document.body.classList.add('printing-mode');
            
            // Drukuj
            window.print();
            
            // UsuÅ„ klasÄ™ po drukowaniu
            setTimeout(() => {
                document.body.classList.remove('printing-mode');
            }, 100);
        }

        // ==============================================
        // SETTINGS MANAGEMENT
        // ==============================================

        function renderSettingsLists() {
            // DziaÅ‚y
            document.getElementById('departments-list').innerHTML = 
                systemLists.departments.map(dept => `
                    <div class="settings-item">
                        <input type="text" value="${dept}" 
                               onchange="updateListItem('departments', ${systemLists.departments.indexOf(dept)}, this.value)">
                        <div class="settings-item-actions">
                            <button class="btn-icon delete" onclick="removeListItem('departments', ${systemLists.departments.indexOf(dept)})">ğŸ—‘ï¸</button>
                        </div>
                    </div>
                `).join('');
            
            // Stanowiska
            document.getElementById('positions-list').innerHTML = 
                systemLists.positions.map(pos => `
                    <div class="settings-item">
                        <input type="text" value="${pos}" 
                               onchange="updateListItem('positions', ${systemLists.positions.indexOf(pos)}, this.value)">
                        <div class="settings-item-actions">
                            <button class="btn-icon delete" onclick="removeListItem('positions', ${systemLists.positions.indexOf(pos)})">ğŸ—‘ï¸</button>
                        </div>
                    </div>
                `).join('');
            
            // Zmiany
            document.getElementById('shifts-list').innerHTML = 
                systemLists.shifts.map(shift => `
                    <div class="settings-item">
                        <input type="text" value="${shift}" 
                               onchange="updateListItem('shifts', ${systemLists.shifts.indexOf(shift)}, this.value)">
                        <div class="settings-item-actions">
                            <button class="btn-icon delete" onclick="removeListItem('shifts', ${systemLists.shifts.indexOf(shift)})">ğŸ—‘ï¸</button>
                        </div>
                    </div>
                `).join('');
            
            // Obywatelstwa
            document.getElementById('citizenships-list').innerHTML = 
                systemLists.citizenships.map(cit => `
                    <div class="settings-item">
                        <input type="text" value="${cit}" 
                               onchange="updateListItem('citizenships', ${systemLists.citizenships.indexOf(cit)}, this.value)">
                        <div class="settings-item-actions">
                            <button class="btn-icon delete" onclick="removeListItem('citizenships', ${systemLists.citizenships.indexOf(cit)})">ğŸ—‘ï¸</button>
                        </div>
                    </div>
                `).join('');
            
            // Elementy odzieÅ¼y
            document.getElementById('clothing-items-list').innerHTML = 
                systemLists.clothingItems.map(item => `
                    <div class="settings-item">
                        <input type="text" value="${item}" 
                               onchange="updateListItem('clothingItems', ${systemLists.clothingItems.indexOf(item)}, this.value)">
                        <div class="settings-item-actions">
                            <button class="btn-icon delete" onclick="removeListItem('clothingItems', ${systemLists.clothingItems.indexOf(item)})">ğŸ—‘ï¸</button>
                        </div>
                    </div>
                `).join('');
        }

        function updateListItem(listName, index, newValue) {
            systemLists[listName][index] = newValue;
            saveToFirebase();
            updateDropdowns();
            showToast(i18n('toast.updated'));
        }

        function removeListItem(listName, index) {
            if (!confirm(i18n('toast.confirmDeleteItem'))) return;
            
            systemLists[listName].splice(index, 1);
            saveToFirebase();
            renderSettingsLists();
            updateDropdowns();
            showToast(i18n('toast.deleted'));
        }

        function addDepartment() {
            const input = document.getElementById('new-department');
            const value = input.value.trim();
            
            if (!value) {
                showToast(i18n('toast.enterValue'), 'error');
                return;
            }
            
            systemLists.departments.push(value);
            saveToFirebase();
            renderSettingsLists();
            updateDropdowns();
            input.value = '';
            showToast(i18n('toast.added'));
        }

        function addPosition() {
            const input = document.getElementById('new-position');
            const value = input.value.trim();
            
            if (!value) {
                showToast(i18n('toast.enterValue'), 'error');
                return;
            }
            
            systemLists.positions.push(value);
            saveToFirebase();
            renderSettingsLists();
            updateDropdowns();
            input.value = '';
            showToast(i18n('toast.added'));
        }

        function addShift() {
            const input = document.getElementById('new-shift');
            const value = input.value.trim();
            
            if (!value) {
                showToast(i18n('toast.enterValue'), 'error');
                return;
            }
            
            systemLists.shifts.push(value);
            saveToFirebase();
            renderSettingsLists();
            updateDropdowns();
            input.value = '';
            showToast(i18n('toast.added'));
        }

        function addCitizenship() {
            const input = document.getElementById('new-citizenship');
            const value = input.value.trim();
            
            if (!value) {
                showToast(i18n('toast.enterValue'), 'error');
                return;
            }
            
            systemLists.citizenships.push(value);
            saveToFirebase();
            renderSettingsLists();
            updateDropdowns();
            input.value = '';
            showToast(i18n('toast.added'));
        }

        function addClothingItem() {
            const input = document.getElementById('new-clothing-item');
            const value = input.value.trim();
            
            if (!value) {
                showToast(i18n('toast.enterValue'), 'error');
                return;
            }
            
            systemLists.clothingItems.push(value);
            saveToFirebase();
            renderSettingsLists();
            input.value = '';
            showToast(i18n('toast.added'));
        }

        // ==============================================
        // EXCEL IMPORT/EXPORT
        // ==============================================

        function exportToExcel() {
            const ws_data = [
                [i18n('table.name'), i18n('table.position'), i18n('table.department'), i18n('table.shift'), i18n('table.rcp'), i18n('table.citizenship'), i18n('table.locker'), i18n('table.hireDate')]
            ];
            
            employees.forEach(emp => {
                ws_data.push([
                    emp.name,
                    emp.position,
                    emp.department,
                    emp.shift || '',
                    emp.rcp || '',
                    emp.citizenship,
                    emp.locker || '',
                    emp.hireDate || ''
                ]);
            });
            
            const ws = XLSX.utils.aoa_to_sheet(ws_data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Pracownicy");
            
            XLSX.writeFile(wb, `pracownicy_${new Date().toISOString().split('T')[0]}.xlsx`);
            showToast(i18n('toast.exported'));
        }

        function createSampleExcel() {
            const sampleData = [
                ['Nazwisko,ImiÄ™', 'Stanowisko', 'DziaÅ‚', 'Zmiana', 'RCP', 'Obywatelstwo', 'Szafka', 'Data przyjÄ™cia'],
                ['KOWALSKI JAN', 'Spawacz MIG/MAG', 'DZIAÅ_SPAWALNIA_PL', 'Adam Nowak', '5286', 'polskie', 'K92', '2024-01-15'],
                ['SHEVCHENKO IVAN', 'Operator robota', 'DZIAÅ_SPAWALNIA_UA_ROBOT', 'HRABKO VIACHESLAV', '5287', 'ukraiÅ„skie', 'M45', '2024-02-20'],
                ['NOWAK ANNA', 'Kontroler jakoÅ›ci', 'DZIAÅ_KONTROLA_JAKOÅšCI', 'Katarzyna KrzyÅ¼anek', '5288', 'polskie', 'Q12', '2024-03-10']
            ];
            
            const ws = XLSX.utils.aoa_to_sheet(sampleData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "PrzykÅ‚ad");
            
            XLSX.writeFile(wb, "przyklad_import_pracownikow.xlsx");
            showToast(i18n('toast.exported'));
        }

        // ==============================================
        // JSON IMPORT/EXPORT
        // ==============================================

        function exportToJSON() {
            const data = {
                employees: employees,
                deletedEmployees: deletedEmployees,
                clothingRecords: clothingRecords,
                positionClothesMapping: positionClothesMapping,
                systemLists: systemLists,
                exportDate: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `backup_hr_system_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            showToast(i18n('toast.exported'));
        }

        function importFromJSON(file) {
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    if (!data.employees || !Array.isArray(data.employees)) {
                        throw new Error('NieprawidÅ‚owy format pliku');
                    }
                    
                    if (confirm(i18n('toast.confirmReplaceData'))) {
                        employees = data.employees || [];
                        deletedEmployees = data.deletedEmployees || [];
                        clothingRecords = data.clothingRecords || {};
                        positionClothesMapping = data.positionClothesMapping || {...defaultPositionClothesMapping};
                        systemLists = data.systemLists || systemLists;
                        
                        // ZnajdÅº najwyÅ¼sze ID
                        let maxId = 0;
                        [...employees, ...deletedEmployees].forEach(emp => {
                            if (emp.id > maxId) maxId = emp.id;
                        });
                        nextEmployeeId = maxId + 1;
                        
                        saveToFirebase();
                        renderEmployees();
                        renderDeletedEmployees();
                        updateClothingEmployeesList();
                        updateTrainingEmployeesList();
                        renderSettingsLists();
                        renderPositionClothesMapping();
                        updateStats();
                        updateDropdowns();
                        
                        showToast(i18n('toast.imported'));
                    }
                } catch (error) {
                    console.error('Import error:', error);
                    showToast(i18n('toast.importError') + ' ' + error.message, 'error');
                }
            };
            
            reader.readAsText(file);
        }

        // ==============================================
        // UI HELPERS
        // ==============================================

        function showToast(message, type = 'success') {
            const existingToast = document.querySelector('.toast');
            if (existingToast) {
                existingToast.remove();
            }
            
            const toast = document.createElement('div');
            toast.className = 'toast';
            
            if (type === 'error') {
                toast.style.background = 'linear-gradient(135deg, rgba(239, 68, 68, 0.9), rgba(220, 38, 38, 0.9))';
            } else if (type === 'info') {
                toast.style.background = 'linear-gradient(135deg, rgba(59, 130, 246, 0.9), rgba(37, 99, 235, 0.9))';
            }
            
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideOutRight 0.3s ease-out forwards';
                setTimeout(() => {
                    toast.remove();
                }, 300);
            }, 3000);
        }

        function updateDropdowns() {
            // Filtry
            const filterDept = document.getElementById('filter-department');
            const filterPos = document.getElementById('filter-position');
            const filterShift = document.getElementById('filter-shift');
            
            if (filterDept) {
                const currentDeptFilter = filterDept.value;
                filterDept.innerHTML = `<option value="">${i18n('filters.allDepartments')}</option>`;
                systemLists.departments.forEach(dept => {
                    const option = document.createElement('option');
                    option.value = dept;
                    option.textContent = dept;
                    if (dept === currentDeptFilter) option.selected = true;
                    filterDept.appendChild(option);
                });
            }
            
            if (filterPos) {
                const currentPosFilter = filterPos.value;
                filterPos.innerHTML = `<option value="">${i18n('filters.allPositions')}</option>`;
                systemLists.positions.forEach(pos => {
                    const option = document.createElement('option');
                    option.value = pos;
                    option.textContent = pos;
                    if (pos === currentPosFilter) option.selected = true;
                    filterPos.appendChild(option);
                });
            }
            
            if (filterShift) {
                const currentShiftFilter = filterShift.value;
                filterShift.innerHTML = `<option value="">${i18n('filters.allShifts')}</option>`;
                systemLists.shifts.forEach(shift => {
                    const option = document.createElement('option');
                    option.value = shift;
                    option.textContent = shift;
                    if (shift === currentShiftFilter) option.selected = true;
                    filterShift.appendChild(option);
                });
            }
            
            // Datalisty dla formularzy
            updateDatalist('position-list', systemLists.positions);
            updateDatalist('shift-list', systemLists.shifts);
            updateDatalist('edit-position-list', systemLists.positions);
            updateDatalist('edit-shift-list', systemLists.shifts);
            
            // Selecty w formularzach
            updateSelect('department-select', systemLists.departments, true);
            updateSelect('citizenship-select', systemLists.citizenships, true);
            updateSelect('edit-department', systemLists.departments, true);
            updateSelect('edit-citizenship', systemLists.citizenships, true);
        }

        function updateDatalist(id, items) {
            const datalist = document.getElementById(id);
            if (!datalist) return;
            
            datalist.innerHTML = items.map(item => 
                `<option value="${item}">`
            ).join('');
        }

        function updateSelect(id, items, addOther = false) {
            const select = document.getElementById(id);
            if (!select) return;
            
            const currentValue = select.value;
            select.innerHTML = `<option value="">${i18n('select.choose')}</option>`;
            
            items.forEach(item => {
                const option = document.createElement('option');
                option.value = item;
                option.textContent = item;
                if (item === currentValue) option.selected = true;
                select.appendChild(option);
            });
            
            if (addOther) {
                const option = document.createElement('option');
                option.value = 'other';
                option.textContent = i18n('select.other');
                if (currentValue === 'other') option.selected = true;
                select.appendChild(option);
            }
        }

        // ==============================================
        // EVENT LISTENERS
        // ==============================================
        
        function setupEventListeners() {
            console.log('Setting up event listeners...');
            
            // ObsÅ‚uga zmiany zakÅ‚adek
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    if (this.onclick) return; // Skip if has onclick
                    
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    this.classList.add('active');
                    const tabName = this.dataset.tab;
                    document.getElementById(tabName).classList.add('active');
                    
                    // Update lists when switching tabs
                    if (tabName === 'clothing') {
                        updateClothingEmployeesList();
                    } else if (tabName === 'training-clothes') {
                        updateTrainingEmployeesList();
                    } else if (tabName === 'settings') {
                        renderSettingsLists();
                        renderPositionClothesMapping();
                    }
                });
            });

            // Wyszukiwanie
            const searchInput = document.getElementById('search');
            if (searchInput) {
                searchInput.addEventListener('input', function() {
                    renderEmployees();
                });
                
                // Dodaj obsÅ‚ugÄ™ wyszukiwania na urzÄ…dzeniach mobilnych
                searchInput.addEventListener('search', function() {
                    renderEmployees();
                });
                
                // ObsÅ‚uga czyszczenia pola wyszukiwania
                searchInput.addEventListener('keyup', function(e) {
                    if (e.key === 'Escape') {
                        this.value = '';
                        renderEmployees();
                    }
                });
            }

            // Import Excel
            const fileInput = document.getElementById('file-input');
            if (fileInput) {
                console.log('Adding file input listener...');
                fileInput.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (!file) return;
                    
                    console.log('Import Excel - file selected:', file.name);
                    showToast(i18n('toast.loadingFile'), 'info');
                    
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const data = new Uint8Array(e.target.result);
                            const workbook = XLSX.read(data, { type: 'array' });
                            const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                            const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });
                            
                            console.log('Excel data loaded:', jsonData);
                            
                            if (jsonData.length < 2) {
                                showToast(i18n('toast.emptyFile'), 'error');
                                return;
                            }
                            
                            const headers = jsonData[0];
                            const rows = jsonData.slice(1);
                            
                            // Mapowanie kolumn - sprawdzamy rÃ³Å¼ne moÅ¼liwe nazwy kolumn
                            const columnMap = {
                                name: findColumnIndex(headers, ['Nazwisko,ImiÄ™', 'Nazwisko, ImiÄ™', 'Nazwisko i ImiÄ™', 'ImiÄ™ i Nazwisko', 'Name', 'Pracownik', 'Last Name,First Name', 'ĞŸÑ€Ñ–Ğ·Ğ²Ğ¸Ñ‰Ğµ,Ğ†Ğ¼\'Ñ', 'Apellido,Nombre']),
                                position: findColumnIndex(headers, ['Stanowisko', 'Position', 'Funkcja', 'Posada', 'PosiciÃ³n']),
                                department: findColumnIndex(headers, ['DziaÅ‚', 'Department', 'WydziaÅ‚', 'Ğ’Ñ–Ğ´Ğ´Ñ–Ğ»', 'Departamento']),
                                shift: findColumnIndex(headers, ['Zmiana', 'Shift', 'Kierownik', 'Zmiana/Kierownik', 'Ğ—Ğ¼Ñ–Ğ½Ğ°', 'Turno']),
                                rcp: findColumnIndex(headers, ['RCP', 'Rcp', 'Numer RCP']),
                                citizenship: findColumnIndex(headers, ['Obywatelstwo', 'Citizenship', 'NarodowoÅ›Ä‡', 'Ğ“Ñ€Ğ¾Ğ¼Ğ°Ğ´ÑĞ½ÑÑ‚Ğ²Ğ¾', 'CiudadanÃ­a']),
                                locker: findColumnIndex(headers, ['Szafka', 'Locker', 'Nr szafki', 'Ğ¨Ğ°Ñ„ĞºĞ°', 'Casillero']),
                                hireDate: findColumnIndex(headers, ['Data przyjÄ™cia', 'Data zatrudnienia', 'Hire Date', 'Data', 'Ğ”Ğ°Ñ‚Ğ° Ğ¿Ñ€Ğ¸Ğ¹Ğ½ÑÑ‚Ñ‚Ñ', 'Fecha de ContrataciÃ³n'])
                            };
                            
                            console.log('Column mapping:', columnMap);
                            
                            const newEmployees = [];
                            let skippedRows = 0;
                            
                            rows.forEach((row, index) => {
                                // Sprawdzamy czy wiersz ma jakiekolwiek dane
                                if (!row || row.length === 0 || !row[columnMap.name]) {
                                    skippedRows++;
                                    return;
                                }
                                
                                const emp = {
                                    id: generateUniqueId(),
                                    name: (row[columnMap.name] || '').toString().trim().toUpperCase(),
                                    position: (row[columnMap.position] || '').toString().trim(),
                                    department: (row[columnMap.department] || '').toString().trim(),
                                    shift: columnMap.shift !== -1 ? (row[columnMap.shift] || '').toString().trim() : '',
                                    rcp: columnMap.rcp !== -1 ? (row[columnMap.rcp] || '').toString().trim() : '',
                                    citizenship: (row[columnMap.citizenship] || '').toString().trim(),
                                    locker: columnMap.locker !== -1 ? (row[columnMap.locker] || '').toString().trim() : '',
                                    hireDate: columnMap.hireDate !== -1 && row[columnMap.hireDate] ? formatExcelDate(row[columnMap.hireDate]) : ''
                                };
                                
                                // Walidacja - wymagane pola
                                if (!emp.name || !emp.position || !emp.department || !emp.citizenship) {
                                    console.warn(`Skipping row ${index + 2} - missing required fields:`, emp);
                                    skippedRows++;
                                    return;
                                }
                                
                                newEmployees.push(emp);
                            });
                            
                            console.log(`Processed ${newEmployees.length} employees, skipped ${skippedRows} rows`);
                            
                            if (newEmployees.length === 0) {
                                showToast(i18n('toast.noValidData'), 'error');
                                return;
                            }
                            
                            // Opcja zastÄ…pienia lub dodania
                            const message = employees.length > 0 
                                ? i18n('toast.confirmReplace').replace('{count}', newEmployees.length)
                                : i18n('toast.foundEmployees').replace('{count}', newEmployees.length) + ' ' + i18n('toast.confirmImport');
                            
                            if (confirm(message)) {
                                employees = [...employees, ...newEmployees];
                                
                                // Aktualizacja list systemowych na podstawie importowanych danych
                                updateSystemListsFromImport(newEmployees);
                                
                                saveToFirebase();
                                renderEmployees();
                                updateClothingEmployeesList();
                                updateTrainingEmployeesList();
                                updateDropdowns();
                                
                                // Ukryj kartÄ™ informacyjnÄ…
                                const infoCard = document.getElementById('info-card');
                                if (infoCard) {
                                    infoCard.style.display = 'none';
                                }
                                
                                showToast(i18n('toast.importedCount').replace('{count}', newEmployees.length));
                            }
                        } catch (error) {
                            console.error('Import error:', error);
                            showToast(i18n('toast.importError') + ' ' + error.message, 'error');
                        }
                    };
                    
                    reader.onerror = function(error) {
                        console.error('File read error:', error);
                        showToast(i18n('toast.fileReadError'), 'error');
                    };
                    
                    reader.readAsArrayBuffer(file);
                    e.target.value = ''; // Reset input
                });
            } else {
                console.error('File input not found!');
            }

            // ObsÅ‚uga selectÃ³w w formularzach
            const deptSelect = document.getElementById('department-select');
            if (deptSelect) {
                deptSelect.addEventListener('change', function() {
                    const otherInput = document.getElementById('department-other');
                    otherInput.style.display = this.value === 'other' ? 'block' : 'none';
                    if (this.value !== 'other') otherInput.value = '';
                });
            }

            const citizenSelect = document.getElementById('citizenship-select');
            if (citizenSelect) {
                citizenSelect.addEventListener('change', function() {
                    const otherInput = document.getElementById('citizenship-other');
                    otherInput.style.display = this.value === 'other' ? 'block' : 'none';
                    if (this.value !== 'other') otherInput.value = '';
                });
            }

            const editDept = document.getElementById('edit-department');
            if (editDept) {
                editDept.addEventListener('change', function() {
                    const otherInput = document.getElementById('edit-department-other');
                    otherInput.style.display = this.value === 'other' ? 'block' : 'none';
                    if (this.value !== 'other') otherInput.value = '';
                });
            }

            const editCitizen = document.getElementById('edit-citizenship');
            if (editCitizen) {
                editCitizen.addEventListener('change', function() {
                    const otherInput = document.getElementById('edit-citizenship-other');
                    otherInput.style.display = this.value === 'other' ? 'block' : 'none';
                    if (this.value !== 'other') otherInput.value = '';
                });
            }

            // Drag & Drop
            let dragCounter = 0;

            document.addEventListener('dragenter', function(e) {
                e.preventDefault();
                dragCounter++;
                document.getElementById('drop-zone').classList.add('active');
            });

            document.addEventListener('dragleave', function(e) {
                dragCounter--;
                if (dragCounter === 0) {
                    document.getElementById('drop-zone').classList.remove('active');
                }
            });

            document.addEventListener('dragover', function(e) {
                e.preventDefault();
            });

            document.addEventListener('drop', function(e) {
                e.preventDefault();
                dragCounter = 0;
                document.getElementById('drop-zone').classList.remove('active');
                
                const files = e.dataTransfer.files;
                if (files.length > 0 && (files[0].name.endsWith('.xlsx') || files[0].name.endsWith('.xls'))) {
                    document.getElementById('file-input').files = files;
                    const event = new Event('change', { bubbles: true });
                    document.getElementById('file-input').dispatchEvent(event);
                } else {
                    showToast(i18n('toast.wrongFormat'), 'error');
                }
            });

            // Zamykanie modali po klikniÄ™ciu poza nimi
            window.onclick = function(event) {
                if (event.target.classList.contains('modal')) {
                    event.target.style.display = 'none';
                }
            };
            
            console.log('Event listeners setup complete');
        }
        
        // Funkcja pomocnicza do znajdowania indeksu kolumny
        function findColumnIndex(headers, possibleNames) {
            for (let i = 0; i < headers.length; i++) {
                const header = (headers[i] || '').toString().trim();
                for (const name of possibleNames) {
                    if (header.toLowerCase() === name.toLowerCase()) {
                        return i;
                    }
                }
            }
            return -1;
        }
        
        // Funkcja do aktualizacji list systemowych na podstawie importu
        function updateSystemListsFromImport(importedEmployees) {
            importedEmployees.forEach(emp => {
                // Dodaj nowe dziaÅ‚y
                if (emp.department && !systemLists.departments.includes(emp.department)) {
                    systemLists.departments.push(emp.department);
                }
                
                // Dodaj nowe stanowiska
                if (emp.position && !systemLists.positions.includes(emp.position)) {
                    systemLists.positions.push(emp.position);
                }
                
                // Dodaj nowe zmiany/kierownikÃ³w
                if (emp.shift && !systemLists.shifts.includes(emp.shift)) {
                    systemLists.shifts.push(emp.shift);
                }
                
                // Dodaj nowe obywatelstwa
                if (emp.citizenship && !systemLists.citizenships.includes(emp.citizenship)) {
                    systemLists.citizenships.push(emp.citizenship);
                }
            });
        }

        // Mobile menu
        function showMobileMenu() {
            // Implementacja menu mobilnego
            showToast('Menu mobilne w przygotowaniu');
        }
        
        // Clear search
        function clearSearch() {
            const searchInput = document.getElementById('search');
            if (searchInput) {
                searchInput.value = '';
                renderEmployees();
                searchInput.focus();
            }
        }
        
        // Force data refresh (for mobile)
        function forceDataRefresh() {
            if (!currentUser || !dbRef) {
                showToast(i18n('toast.loginRequired'), 'error');
                return;
            }
            
            console.log('Forcing data refresh...');
            updateSyncStatus('syncing');
            showToast(i18n('toast.refreshing'), 'info');
            
            // Force offline/online cycle
            database.goOffline();
            setTimeout(() => {
                database.goOnline();
                
                // Force reload data
                dbRef.once('value').then((snapshot) => {
                    const data = snapshot.val() || {};
                    console.log('Force refresh - data received:', Object.keys(data));
                    
                    // Manually trigger data update
                    employees = data.employees || [];
                    deletedEmployees = data.deletedEmployees || [];
                    clothingRecords = data.clothingRecords || {};
                    
                    // Desanityzacja kluczy w positionClothesMapping
                    const loadedMapping = data.positionClothesMapping || {};
                    positionClothesMapping = {};
                    Object.keys(loadedMapping).forEach(sanitizedKey => {
                        let originalKey = sanitizedKey;
                        if (sanitizedKey === 'Spawacz MIG_MAG') {
                            originalKey = 'Spawacz MIG/MAG';
                        }
                        positionClothesMapping[originalKey] = loadedMapping[sanitizedKey];
                    });
                    
                    if (Object.keys(positionClothesMapping).length === 0) {
                        positionClothesMapping = {
                            'Spawacz MIG/MAG': ['buty', 'spodnie', 'bluza', 'rÄ™kawice spawalnicze', 'przyÅ‚bica spawalnicza'],
                            'Spawacz TIG': ['buty', 'spodnie', 'bluza', 'rÄ™kawice spawalnicze', 'przyÅ‚bica spawalnicza'],
                            'Operator robota': ['buty', 'spodnie', 'bluza', 'okulary ochronne'],
                            'Szlifierz': ['buty', 'spodnie', 'bluza', 'okulary ochronne', 'maska przeciwpyÅ‚owa'],
                            'Monter': ['buty', 'spodnie', 'bluza', 'rÄ™kawice montaÅ¼owe'],
                            'Kontroler jakoÅ›ci': ['buty', 'spodnie', 'bluza']
                        };
                    }
                    
                    systemLists = data.systemLists || systemLists;
                    nextEmployeeId = data.nextEmployeeId || 1;
                    
                    // Force UI update
                    renderEmployees();
                    updateStats();
                    renderDeletedEmployees();
                    updateClothingEmployeesList();
                    updateTrainingEmployeesList();
                    renderSettingsLists();
                    renderPositionClothesMapping();
                    updateDropdowns();
                    
                    const infoCard = document.getElementById('info-card');
                    if (infoCard) {
                        infoCard.style.display = employees.length > 0 ? 'none' : 'block';
                    }
                    
                    updateSyncStatus('synced');
                    showToast(i18n('toast.dataRefreshed'), 'success');
                }).catch((error) => {
                    console.error('Force refresh error:', error);
                    updateSyncStatus('error');
                    showToast(i18n('toast.refreshError') + ' ' + error.message, 'error');
                });
            }, 500);
        }

        // Pomocnicza funkcja do formatowania daty z Excel
        function formatExcelDate(excelDate) {
            // JeÅ›li to juÅ¼ jest string w formacie daty, zwrÃ³Ä‡ bez zmian
            if (typeof excelDate === 'string') {
                // SprawdÅº czy to jest data w formacie YYYY-MM-DD
                if (/^\d{4}-\d{2}-\d{2}$/.test(excelDate)) {
                    return excelDate;
                }
                // SprawdÅº czy to jest data w formacie DD.MM.YYYY lub DD/MM/YYYY
                if (/^\d{1,2}[.\/]\d{1,2}[.\/]\d{4}$/.test(excelDate)) {
                    const parts = excelDate.split(/[.\/]/);
                    const day = parts[0].padStart(2, '0');
                    const month = parts[1].padStart(2, '0');
                    const year = parts[2];
                    return `${year}-${month}-${day}`;
                }
                // PrÃ³buj sparsowaÄ‡ jako datÄ™
                const date = new Date(excelDate);
                if (!isNaN(date)) {
                    return date.toISOString().split('T')[0];
                }
                return '';
            }
            
            // JeÅ›li to liczba (Excel serial date)
            if (typeof excelDate === 'number') {
                // Excel przechowuje daty jako liczby dni od 1900-01-01
                // ale z bÅ‚Ä™dem dla lat przestÄ™pnych przed 1900-03-01
                let date;
                if (excelDate > 59) {
                    // Po 28 lutego 1900 (Excel bÅ‚Ä™dnie traktuje 1900 jako rok przestÄ™pny)
                    date = new Date((excelDate - 25569) * 86400 * 1000);
                } else {
                    // Przed 1 marca 1900
                    date = new Date((excelDate - 25568) * 86400 * 1000);
                }
                
                // SprawdÅº czy data jest prawidÅ‚owa
                if (!isNaN(date)) {
                    // Korekcja strefy czasowej
                    const offset = date.getTimezoneOffset();
                    date = new Date(date.getTime() + offset * 60 * 1000);
                    return date.toISOString().split('T')[0];
                }
            }
            
            return '';
        }

        // ==============================================
        // INITIALIZATION
        // ==============================================
        
        // Debug info
        console.log('HR System starting...');
        console.log('Firebase config loaded');
        
        // Mobile-specific event handlers
        function setupMobileHandlers() {
            // Handle app resume/focus
            document.addEventListener('visibilitychange', function() {
                if (!document.hidden && currentUser) {
                    console.log('App resumed/focused - refreshing data');
                    // Force reconnection
                    database.goOffline();
                    setTimeout(() => {
                        database.goOnline();
                        if (dbRef) {
                            dbRef.once('value').then((snapshot) => {
                                console.log('Data refreshed after resume');
                            });
                        }
                    }, 500);
                }
            });
            
            // Handle online/offline events
            window.addEventListener('online', function() {
                console.log('Device is online');
                updateSyncStatus('syncing');
                if (currentUser && dbRef) {
                    database.goOnline();
                    dbRef.once('value').then(() => {
                        console.log('Data synced after coming online');
                    });
                }
            });
            
            window.addEventListener('offline', function() {
                console.log('Device is offline');
                updateSyncStatus('offline');
            });
            
            // iOS specific - handle app becoming active
            window.addEventListener('focus', function() {
                if (currentUser && dbRef) {
                    console.log('Window focused - checking connection');
                    database.ref('.info/connected').once('value');
                }
            });
            
            // Prevent iOS bounce effect
            document.addEventListener('touchmove', function(e) {
                if (e.target.closest('.modal') || e.target.closest('.table-wrapper')) {
                    return; // Allow scrolling in modals and tables
                }
                if (document.body.scrollHeight <= window.innerHeight) {
                    e.preventDefault();
                }
            }, { passive: false });
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, initializing app...');
            
            // Test XLSX library
            if (typeof XLSX !== 'undefined') {
                console.log('XLSX library loaded successfully');
            } else {
                console.error('XLSX library not loaded!');
            }
            
            // Set language from localStorage
            const savedLang = localStorage.getItem('appLanguage') || 'pl';
            changeLanguage(savedLang);
            
            // Setup mobile handlers
            setupMobileHandlers();
            
            // Add viewport meta tag for better mobile support
            const viewport = document.querySelector('meta[name="viewport"]');
            if (viewport) {
                viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover');
            }
            
            // Force initial auth check
            setTimeout(() => {
                if (!currentUser) {
                    console.log('No user after 3 seconds, forcing auth check');
                    const user = auth.currentUser;
                    if (user) {
                        console.log('Found current user:', user.email);
                    }
                }
            }, 3000);
        });
    </script>

<script>
// Ğ—Ğ±ĞµÑ€ĞµĞ¶ĞµĞ½Ğ½Ñ Ğ´Ğ°Ğ½Ğ¸Ñ… Ñƒ Firebase Ğ¿Ñ–ÑĞ»Ñ Ñ–Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ñƒ
function saveExportedDataToFirebase(dataArray) {
    const user = firebase.auth().currentUser;
    if (!user) {
        console.warn("Nie jesteÅ› zalogowany â€“ brak moÅ¼liwoÅ›ci zapisu");
        return;
    }

    const uid = user.uid;
    const timestamp = new Date().toISOString();
    const ref = firebase.database().ref(`users/${uid}/lastExportedData`);

    ref.set({
        savedAt: timestamp,
        data: dataArray
    })
    .then(() => {
        console.log("Dane zostaÅ‚y zapisane w Firebase");
    })
    .catch((error) => {
        console.error("BÅ‚Ä…d zapisu do Firebase:", error);
    });
}

// Ğ’Ñ–Ğ´Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ Ğ´Ğ°Ğ½Ğ¸Ñ… Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ²Ğ°Ğ½Ñ‚Ğ°Ğ¶ĞµĞ½Ğ½Ñ– ÑÑ‚Ğ¾Ñ€Ñ–Ğ½ĞºĞ¸, ÑĞºÑ‰Ğ¾ Ğ¾Ñ€Ğ¸Ğ³Ñ–Ğ½Ğ°Ğ»ÑŒĞ½Ğ¸Ğ¹ Ñ„Ğ°Ğ¹Ğ» Ğ·Ğ½Ğ¸Ğº
function loadExportedDataFromFirebase() {
    firebase.auth().onAuthStateChanged((user) => {
        if (user) {
            const uid = user.uid;
            const ref = firebase.database().ref(`users/${uid}/lastExportedData`);

            ref.once("value")
                .then((snapshot) => {
                    const saved = snapshot.val();
                    if (saved && saved.data) {
                        console.log("ZaÅ‚adowano dane z Firebase:", saved);
                        renderImportedData(saved.data); // ğŸ” Ğ¢Ğ²Ğ¾Ñ Ñ„ÑƒĞ½ĞºÑ†Ñ–Ñ Ğ´Ğ»Ñ Ğ²Ğ¸Ğ²Ğ¾Ğ´Ñƒ
                    } else {
                        console.log("Brak zapisanych danych w Firebase.");
                    }
                })
                .catch((error) => {
                    console.error("BÅ‚Ä…d przy pobieraniu danych z Firebase:", error);
                });
        } else {
            console.log("UÅ¼ytkownik niezalogowany.");
        }
    });
}

// Ğ’Ğ¸ĞºĞ»Ğ¸Ğº Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ²Ğ°Ğ½Ñ‚Ğ°Ğ¶ĞµĞ½Ğ½Ñ–
window.addEventListener('DOMContentLoaded', loadExportedDataFromFirebase);
</script>


<script>
// Ğ ĞµÑ”ÑÑ‚Ñ€Ğ°Ñ†Ñ–Ñ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ğ° Ğ¿Ñ€Ğ¸ Ğ¿ĞµÑ€ÑˆĞ¾Ğ¼Ñƒ Ğ²Ñ…Ğ¾Ğ´Ñ–
function registerNewUserWithEmail(email, password) {
    firebase.auth().createUserWithEmailAndPassword(email, password)
        .then((userCredential) => {
            console.log("Zarejestrowano nowego uÅ¼ytkownika:", userCredential.user);
            showMainApp();
        })
        .catch((error) => {
            if (error.code === 'auth/email-already-in-use') {
                loginExistingUser(email, password);
            } else {
                console.error("BÅ‚Ä…d rejestracji:", error);
                alert("BÅ‚Ä…d: " + error.message);
            }
        });
}

// Ğ›Ğ¾Ğ³Ñ–Ğ½ ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ğ°, ÑĞºÑ‰Ğ¾ Ğ²Ğ¶Ğµ Ğ·Ğ°Ñ€ĞµÑ”ÑÑ‚Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹
function loginExistingUser(email, password) {
    firebase.auth().signInWithEmailAndPassword(email, password)
        .then((userCredential) => {
            console.log("Zalogowano uÅ¼ytkownika:", userCredential.user);
            showMainApp();
        })
        .catch((error) => {
            console.error("BÅ‚Ä…d logowania:", error);
            alert("BÅ‚Ä…d: " + error.message);
        });
}

// Ğ’Ğ¸Ñ…Ñ–Ğ´ Ğ· Ğ°ĞºĞ°ÑƒĞ½Ñ‚Ñƒ
function logout() {
    firebase.auth().signOut()
        .then(() => {
            console.log("Wylogowano pomyÅ›lnie");
            window.location.reload();
        })
        .catch((error) => {
            console.error("BÅ‚Ä…d podczas wylogowania:", error);
        });
}

// ĞĞ±Ñ€Ğ¾Ğ±ĞºĞ° Ğ¿ĞµÑ€ÑˆĞ¾Ğ³Ğ¾ Ğ²Ñ…Ğ¾Ğ´Ñƒ
function handleFirstLogin(event) {
    event.preventDefault();
    const email = document.getElementById("first-login-email").value;
    const password = document.getElementById("first-login-password").value;

    if (!email || !password) {
        alert("Wpisz email i hasÅ‚o");
        return;
    }

    registerNewUserWithEmail(email, password);
}

// Ğ’Ñ–Ğ´Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ½Ñ Ñ„Ğ¾Ñ€Ğ¼Ğ¸ Ğ»Ğ¾Ğ³Ñ–Ğ½Ñƒ
function showLoginForm() {
    const loginPanel = document.getElementById("login-panel");
    const mainApp = document.getElementById("main-app");
    if (loginPanel && mainApp) {
        loginPanel.style.display = "block";
        mainApp.style.display = "none";
        loginPanel.innerHTML = `
            <h2 style="text-align: center; color: white; margin-bottom: 2rem;">Zaloguj siÄ™ lub Zarejestruj</h2>
            <form class="login-form" onsubmit="handleFirstLogin(event)">
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" id="first-login-email" class="form-input" required />
                </div>
                <div class="form-group">
                    <label class="form-label">HasÅ‚o</label>
                    <input type="password" id="first-login-password" class="form-input" required />
                </div>
                <button type="submit" class="btn btn-primary">Zaloguj / Zarejestruj</button>
            </form>
        `;
    }
}

// Ğ’Ñ–Ğ´Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ½Ñ Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ½Ğ¾Ğ³Ğ¾ Ñ–Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑÑƒ Ğ¿Ñ–ÑĞ»Ñ Ğ»Ğ¾Ğ³Ñ–Ğ½Ñƒ
function showMainApp() {
    const loginPanel = document.getElementById("login-panel");
    const mainApp = document.getElementById("main-app");
    if (loginPanel && mainApp) {
        loginPanel.style.display = "none";
        mainApp.style.display = "block";
    }
}

// ĞĞ²Ñ‚Ğ¾-Ğ²Ñ…Ñ–Ğ´ Ğ°Ğ±Ğ¾ Ğ¿Ğ¾ĞºĞ°Ğ· Ğ»Ğ¾Ğ³Ñ–Ğ½Ñƒ Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ²Ğ°Ğ½Ñ‚Ğ°Ğ¶ĞµĞ½Ğ½Ñ– ÑÑ‚Ğ¾Ñ€Ñ–Ğ½ĞºĞ¸
firebase.auth().onAuthStateChanged((user) => {
    if (user) {
        console.log("Zalogowany jako:", user.email);
        showMainApp();
        loadExportedDataFromFirebase();
    } else {
        showLoginForm();
    }
});

// Ğ—Ğ±ĞµÑ€ĞµĞ¶ĞµĞ½Ğ½Ñ Ğ´Ğ°Ğ½Ğ¸Ñ… Ñƒ Firebase Ğ¿Ñ–ÑĞ»Ñ Ñ–Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ñƒ
function saveExportedDataToFirebase(dataArray) {
    const user = firebase.auth().currentUser;
    if (!user) {
        console.warn("Nie jesteÅ› zalogowany â€“ brak moÅ¼liwoÅ›ci zapisu");
        return;
    }

    const uid = user.uid;
    const timestamp = new Date().toISOString();
    const ref = firebase.database().ref(`users/${uid}/lastExportedData`);

    ref.set({
        savedAt: timestamp,
        data: dataArray
    })
    .then(() => {
        console.log("Dane zostaÅ‚y zapisane w Firebase");
    })
    .catch((error) => {
        console.error("BÅ‚Ä…d zapisu do Firebase:", error);
    });
}

// Ğ—Ğ°Ğ²Ğ°Ğ½Ñ‚Ğ°Ğ¶ĞµĞ½Ğ½Ñ Ğ´Ğ°Ğ½Ğ¸Ñ… Ğ¿Ñ–ÑĞ»Ñ Ğ²Ñ…Ğ¾Ğ´Ñƒ
function loadExportedDataFromFirebase() {
    const user = firebase.auth().currentUser;
    if (user) {
        const uid = user.uid;
        const ref = firebase.database().ref(`users/${uid}/lastExportedData`);

        ref.once("value")
            .then((snapshot) => {
                const saved = snapshot.val();
                if (saved && saved.data) {
                    console.log("ZaÅ‚adowano dane z Firebase:", saved);
                    renderImportedData(saved.data);
                } else {
                    console.log("Brak zapisanych danych w Firebase.");
                }
            })
            .catch((error) => {
                console.error("BÅ‚Ä…d przy pobieraniu danych z Firebase:", error);
            });
    }
}
</script>


<script>
let editableSections = [];

function renderSectionEditor() {
    const container = document.createElement('div');
    container.style.margin = '20px';
    container.innerHTML = '<h3 style="color: white;">âš™ï¸ ZarzÄ…dzaj sekcjami:</h3>';

    editableSections.forEach((section, index) => {
        const input = document.createElement('input');
        input.type = 'text';
        input.value = section.title;
        input.style.marginRight = '10px';
        input.oninput = (e) => {
            section.title = e.target.value;
            document.getElementById(section.id + '-label').innerText = e.target.value;
            saveSectionsToFirebase();
        };
        container.appendChild(input);
    });

    const addBtn = document.createElement('button');
    addBtn.textContent = 'â• Dodaj nowÄ… sekcjÄ™';
    addBtn.onclick = () => {
        const newId = prompt('Podaj ID nowej sekcji (np. szkolenia):');
        const newTitle = prompt('Podaj nazwÄ™ sekcji (np. ğŸ“˜ Szkolenia):');
        if (newId && newTitle) {
            editableSections.push({ id: newId, title: newTitle });
            createNewSection(newId, newTitle);
            saveSectionsToFirebase();
        }
    };
    container.appendChild(addBtn);

    document.body.appendChild(container);
}

function createNewSection(id, title) {
    const panel = document.createElement('div');
    panel.className = 'section';
    panel.style.border = '1px solid white';
    panel.style.padding = '10px';
    panel.style.margin = '10px';
    panel.style.color = 'white';
    panel.innerHTML = `
        <h3 id="${id}-label">${title}</h3>
        <div id="${id}-list"></div>
        <input type="text" id="${id}-input" placeholder="Nazwa..." />
        <button onclick="addToList('${id}')">â• Dodaj</button>
    `;
    document.getElementById("main-app")?.appendChild(panel);
}

function addToList(id) {
    const input = document.getElementById(id + "-input");
    const list = document.getElementById(id + "-list");
    if (input && input.value) {
        const item = document.createElement("div");
        item.textContent = input.value;
        item.style.padding = "3px";
        list.appendChild(item);
        input.value = "";
    }
}

function saveSectionsToFirebase() {
    const user = firebase.auth().currentUser;
    if (!user) return;
    const ref = firebase.database().ref(\`users/\${user.uid}/customSections\`);
    ref.set(editableSections).then(() => {
        console.log("Sekcje zapisane w Firebase");
    });
}

function loadSectionsFromFirebase(callback) {
    const user = firebase.auth().currentUser;
    if (!user) return;
    const ref = firebase.database().ref(\`users/\${user.uid}/customSections\`);
    ref.once("value").then((snapshot) => {
        const data = snapshot.val();
        if (data && Array.isArray(data)) {
            editableSections = data;
        } else {
            editableSections = [
                { id: 'dzialy', title: 'ğŸ“ DziaÅ‚y' },
                { id: 'stanowiska', title: 'ğŸ‘· Stanowiska' },
                { id: 'zmiany', title: 'ğŸ‘¥ Zmiany/Kierownicy' }
            ];
        }
        callback();
    });
}

firebase.auth().onAuthStateChanged((user) => {
    if (user) {
        loadSectionsFromFirebase(() => {
            renderSectionEditor();
            editableSections.forEach(section => {
                createNewSection(section.id, section.title);
            });
        });
    }
});
</script>

</body>
</html> 
<!-- Ğ”Ğ¾Ğ´Ğ°Ğ¹ Ñ†ĞµĞ¹ Ğ±Ğ»Ğ¾Ğº Ğ´ĞµÑÑŒ Ñƒ Ñ€Ğ¾Ğ·Ğ´Ñ–Ğ»Ñ– Ustawienia Ğ°Ğ±Ğ¾ Ğ²Ğ½Ğ¸Ğ·Ñƒ ÑÑ‚Ğ¾Ñ€Ñ–Ğ½ĞºĞ¸ -->
<div class="settings-section" id="custom-section-container">
  <h3 class="settings-title">
    â• Create New Section
  </h3>
  <p style="color: var(--text-secondary); margin-bottom: 1rem;">
    Add custom categories like Buildings, Locations, Certifications, or any other data you need to track
  </p>
  <button class="btn btn-primary" onclick="showNewSectionPrompt()">
    â• Add New Section
  </button>
  <ul id="custom-sections-list" class="settings-list" style="margin-top: 1rem;"></ul>
</div>

<script>
let userId = null;

firebase.auth().onAuthStateChanged(user => {
  if (user) {
    userId = user.uid;
    listenForCustomSections();
  }
});

function showNewSectionPrompt() {
  const sectionName = prompt("Enter name of new section:");
  if (!sectionName) return;
  const newRef = firebase.database().ref(`sections/${userId}/customSections`).push();
  newRef.set({ name: sectionName, createdAt: Date.now() });
}

function listenForCustomSections() {
  firebase.database().ref(`sections/${userId}/customSections`).on('value', snapshot => {
    const data = snapshot.val() || {};
    renderCustomSections(data);
  });
}

function renderCustomSections(data) {
  const list = document.getElementById("custom-sections-list");
  list.innerHTML = "";
  Object.entries(data).forEach(([id, item]) => {
    const li = document.createElement("li");
    li.className = "settings-item";
    li.innerHTML = `
      <input type="text" value="${item.name}" onchange="updateCustomSection('${id}', this.value)" />
      <div class="settings-item-actions">
        <button class="btn-icon delete" onclick="deleteCustomSection('${id}')">ğŸ—‘ï¸</button>
      </div>
    `;
    list.appendChild(li);
  });
  refreshFiltersWithSections(data);
}

function updateCustomSection(id, newName) {
  if (!newName.trim()) return;
  firebase.database().ref(`sections/${userId}/customSections/${id}`).update({ name: newName });
}

function deleteCustomSection(id) {
  if (confirm("Are you sure you want to delete this section?")) {
    firebase.database().ref(`sections/${userId}/customSections/${id}`).remove();
  }
}

function refreshFiltersWithSections(data) {
  const filterSelect = document.getElementById("filter-department");
  if (!filterSelect) return;
  const current = filterSelect.value;
  filterSelect.innerHTML = '<option value="">Wszystkie dziaÅ‚y</option>';
  Object.values(data).forEach(sec => {
    const opt = document.createElement("option");
    opt.value = sec.name;
    opt.textContent = sec.name;
    filterSelect.appendChild(opt);
  });
  filterSelect.value = current;
  applyFilters();
}
</script>
